# Inventory Source Snapshot

Generated: Tue Sep 16 14:12:07 UTC 2025

Excludes: node_modules, build, caches, VCS, venvs.



## backend/__init__.py

\`\`\`

\`\`\`


## backend/asgi.py

\`\`\`
"""
ASGI config for backend project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'backend.settings')

application = get_asgi_application()

\`\`\`


## backend/settings.py

\`\`\`
"""
Django settings for backend project.

Generated by 'django-admin startproject' using Django 5.2.5.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/5.2/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/5.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-r*%u#6p2umcfh3=vthdg@wpq!d6n7x+l49dkdil)myykrs_qig'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition
# backend/settings.py
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'rest_framework',
    'corsheaders',
    'inventory',
    'django_filters',
    'django_rest_passwordreset',

]

# ... (rest of the file) ...

# Add this line at the very bottom
AUTH_USER_MODEL = 'inventory.User'

MIDDLEWARE = [
    'corsheaders.middleware.CorsMiddleware', 
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",
]


REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ),
    # Add this block for filtering
    'DEFAULT_FILTER_BACKENDS': (
        'django_filters.rest_framework.DjangoFilterBackend',
    ),
}

ROOT_URLCONF = 'backend.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'backend.wsgi.application'


# Database
# https://docs.djangoproject.com/en/5.2/ref/settings/#databases

# backend/settings.py

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'inventory_db',
        'USER': 'root',
        'PASSWORD': 'root', # Use the password you created
        'HOST': 'localhost',
        'PORT': '3306',
    }
}


# Password validation
# https://docs.djangoproject.com/en/5.2/ref/settings/#auth-password-validators

# AUTH_PASSWORD_VALIDATORS = [
#     {
#         'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
#     },
#     {
#         'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
#     },
#     {
#         'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
#     },
#     {
#         'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
#     },
# ]


# Internationalization
# https://docs.djangoproject.com/en/5.2/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/5.2/howto/static-files/

STATIC_URL = 'static/'

# Default primary key field type
# https://docs.djangoproject.com/en/5.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'

# backend/settings.py

EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = 'smtp.gmail.com'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
EMAIL_HOST_USER = 'amoghbrahma@gmail.com'  # Your Gmail address
EMAIL_HOST_PASSWORD = 'allfor1-me3$$' # Your Gmail "App Password", not your regular password
\`\`\`


## backend/urls.py

\`\`\`

from django.contrib import admin
from django.urls import path, include
from rest_framework_simplejwt.views import TokenRefreshView

from inventory.views import RegisterView, MyTokenObtainPairView

urlpatterns = [
    # 1. Django Admin Panel
    path('admin/', admin.site.urls),

    # 2. User Authentication Endpoints
    path('api/register/', RegisterView.as_view(), name='auth_register'),
    path('api/token/', MyTokenObtainPairView.as_view(), name='token_obtain_pair'),
    path('api/token/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
    path('api/password_reset/', include('django_rest_passwordreset.urls', namespace='password_reset')),


    # 3. Core Application API Endpoints
    # Includes all URLs from the 'inventory' app (Products, Orders, etc.)
    path('api/', include('inventory.urls')),
]
\`\`\`


## backend/wsgi.py

\`\`\`
"""
WSGI config for backend project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'backend.settings')

application = get_wsgi_application()

\`\`\`


## frontend_v2/package.json

\`\`\`
{
  "name": "frontend-v2",
  "version": "0.1.0",
  "private": true,
  "dependencies": {
    "@testing-library/dom": "^10.4.1",
    "@testing-library/jest-dom": "^6.7.0",
    "@testing-library/react": "^16.3.0",
    "@testing-library/user-event": "^13.5.0",
    "axios": "^1.11.0",
    "bootstrap": "^5.3.7",
    "jwt-decode": "^4.0.0",
    "react": "^19.1.1",
    "react-bootstrap": "^2.10.10",
    "react-csv": "^2.2.2",
    "react-dom": "^19.1.1",
    "react-router-dom": "^7.8.0",
    "react-scripts": "5.0.1",
    "react-to-print": "^3.1.1",
    "web-vitals": "^2.1.4"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  },
  "eslintConfig": {
    "extends": [
      "react-app",
      "react-app/jest"
    ]
  },
  "browserslist": {
    "production": [
      ">0.2%",
      "not dead",
      "not op_mini all"
    ],
    "development": [
      "last 1 chrome version",
      "last 1 firefox version",
      "last 1 safari version"
    ]
  }
}

\`\`\`


## frontend_v2/public/index.html

\`\`\`
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Inventory Pro â€” streamlined inventory management UI"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <title>Inventory Pro</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
  </body>
</html>

\`\`\`


## frontend_v2/src/App.css

\`\`\`
.App {
  text-align: center;
}

.App-logo {
  height: 40vmin;
  pointer-events: none;
}

@media (prefers-reduced-motion: no-preference) {
  .App-logo {
    animation: App-logo-spin infinite 20s linear;
  }
}

.App-header {
  background-color: #282c34;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
  color: white;
}

.App-link {
  color: #61dafb;
}

@keyframes App-logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

\`\`\`


## frontend_v2/src/App.js

\`\`\`
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
import { AuthProvider } from './context/AuthContext';
import ProtectedRoute from './components/ProtectedRoute';
import Layout from './components/layout/Layout';
import LoginPage from './pages/LoginPage';
import RegisterPage from './pages/RegisterPage';
import DashboardPage from './pages/DashboardPage';
import ProductsPage from './pages/ProductsPage';
import SuppliersPage from './pages/SuppliersPage';
import PurchaseOrdersPage from './pages/PurchaseOrdersPage';
import CreatePurchaseOrderPage from './pages/CreatePurchaseOrderPage';
import SalesOrdersPage from './pages/SalesOrdersPage';
import CreateSalesOrderPage from './pages/CreateSalesOrderPage';
import ReportsPage from './pages/ReportsPage';
import ProfilePage from './pages/ProfilePage';
import RequestPasswordResetPage from './pages/RequestPasswordResetPage'; 
import ConfirmPasswordResetPage from './pages/ConfirmPasswordResetPage'; 
import InvoicePage from './pages/InvoicePage'; // Import the new page


function App() {
  return (
    <AuthProvider>
      <Router>
        <Routes>
          {/* Public Routes */}
          <Route path="/login" element={<LoginPage />} />
          <Route path="/register" element={<RegisterPage />} />
          <Route path="/forgot-password" element={<RequestPasswordResetPage />} />
          <Route path="/reset-password/:token" element={<ConfirmPasswordResetPage />} />
                    <Route path="/sales-orders/:id/invoice" element={<ProtectedRoute><InvoicePage /></ProtectedRoute>} />

          {/* Protected Routes */}
          <Route path="/" element={<ProtectedRoute><Layout /></ProtectedRoute>}>
            <Route index element={<DashboardPage />} />
            <Route path="products" element={<ProductsPage />} />
            <Route path="suppliers" element={<SuppliersPage />} />
            <Route path="purchase-orders" element={<PurchaseOrdersPage />} />
            <Route path="purchase-orders/create" element={<CreatePurchaseOrderPage />} />
            <Route path="sales-orders" element={<SalesOrdersPage />} />
            <Route path="sales-orders/create" element={<CreateSalesOrderPage />} />
            <Route path="reports" element={<ReportsPage />} />
            <Route path="profile" element={<ProfilePage />} />
          </Route>
        </Routes>
      </Router>
    </AuthProvider>
  );
}

export default App;
\`\`\`


## frontend_v2/src/App.test.js

\`\`\`
import { render, screen } from '@testing-library/react';
import App from './App';

test('renders learn react link', () => {
  render(<App />);
  const linkElement = screen.getByText(/learn react/i);
  expect(linkElement).toBeInTheDocument();
});

\`\`\`


## frontend_v2/src/components/AuthenticatedImage.js

\`\`\`
import React, { useState, useEffect } from 'react';

/**
 * A component to display an image from a protected API endpoint.
 * It fetches the image data as a blob using an authenticated API call
 * and then renders it, handling loading, error, and memory cleanup.
 * @param {object} props
 * @param {() => Promise<any>} props.fetchImage - The async function that fetches the image.
 * @param {string} props.alt - The alt text for the image.
 * @param {object} props.style - The style object for the image tag.
 */
function AuthenticatedImage({ fetchImage, alt, style }) {
  const [imageSrc, setImageSrc] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(false);

  useEffect(() => {
    // A flag to prevent state updates if the component unmounts during the fetch
    let isMounted = true;
    // We store the object URL here so the cleanup function can access it
    let objectUrl = null;

    const loadImage = async () => {
      try {
        const response = await fetchImage();
        objectUrl = URL.createObjectURL(response.data);
        if (isMounted) {
          setImageSrc(objectUrl);
        }
      } catch (err) {
        console.error("Failed to load authenticated image:", err);
        if (isMounted) {
          setError(true);
        }
      } finally {
        if (isMounted) {
          setLoading(false);
        }
      }
    };

    loadImage();

    // This is the cleanup function that runs when the component is removed
    return () => {
      isMounted = false;
      // If the object URL was created, we revoke it to free up browser memory
      if (objectUrl) {
        URL.revokeObjectURL(objectUrl);
      }
    };
  }, [fetchImage]); // The effect re-runs if the fetchImage function changes

  if (loading) {
    return <span>Loading...</span>;
  }

  if (error || !imageSrc) {
    return <span>Error</span>;
  }
  
  return <img src={imageSrc} alt={alt} style={style} />;
}

export default AuthenticatedImage;
\`\`\`


## frontend_v2/src/components/Invoice.css

\`\`\`
/* This class will be applied to the main container of our printable page */
.invoice-container {
    padding: 2rem;
}

/* @media print is a special CSS rule that only applies when printing */
@media print {
    /* Hide everything in the body by default when printing */
    body * {
        visibility: hidden;
    }

    /* Then, make the invoice container and everything inside it visible */
    .invoice-container, .invoice-container * {
        visibility: visible;
    }

    /* Position the invoice at the top of the print page */
    .invoice-container {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }
}
\`\`\`


## frontend_v2/src/components/InvoiceComponent.js

\`\`\`
import React from 'react';
import { Table, Row, Col, Container } from 'react-bootstrap';

const InvoiceComponent = React.forwardRef(({ order }, ref) => {
  if (!order) {
    return null;
  }

  const subtotal = order.items.reduce((acc, item) => acc + (item.quantity * item.unit_price), 0);
  const taxRate = 0.08;
  const tax = subtotal * taxRate;
  const total = subtotal + tax;

  return (
    <div ref={ref} className="p-5">
      <Container>
        <Row className="mb-4 align-items-center">
          <Col>
            <h1 className="mb-0">INVOICE</h1>
            <p className="text-muted">Your Company Name</p>
          </Col>
          <Col className="text-end">
            <p className="mb-0"><strong>Order #:</strong> SO-{order.id}</p>
            <p className="mb-0"><strong>Date:</strong> {new Date(order.order_date).toLocaleDateString()}</p>
          </Col>
        </Row>
        <hr />
        <Row className="mb-4">
          <Col>
            <strong>Bill To:</strong>
            <p className="mb-0">{order.customer_name || 'Valued Customer'}</p>
          </Col>
        </Row>
        <Table striped bordered hover responsive>
          <thead>
            <tr>
              <th>Product</th>
              <th>SKU</th>
              <th>Quantity</th>
              <th>Unit Price</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            {order.items.map((item) => (
              <tr key={item.id}>
                <td>{item.product.name}</td>
                <td>{item.product.sku}</td>
                <td>{item.quantity}</td>
                <td>â‚¹{parseFloat(item.unit_price).toFixed(2)}</td>
                <td>â‚¹{(item.quantity * item.unit_price).toFixed(2)}</td>
              </tr>
            ))}
          </tbody>
        </Table>
        <Row className="mt-4 justify-content-end">
          <Col md={4}>
            <Table borderless size="sm">
              <tbody>
                <tr>
                  <td><strong>Subtotal:</strong></td>
                  <td className="text-end">â‚¹{subtotal.toFixed(2)}</td>
                </tr>
                <tr>
                  <td><strong>Tax ({(taxRate * 100).toFixed(0)}%):</strong></td>
                  <td className="text-end">â‚¹{tax.toFixed(2)}</td>
                </tr>
                <tr className="border-top">
                  <td className="pt-2"><strong>Total:</strong></td>
                  <td className="text-end pt-2"><strong>â‚¹{total.toFixed(2)}</strong></td>
                </tr>
              </tbody>
            </Table>
          </Col>
        </Row>
      </Container>
    </div>
  );
});

export default InvoiceComponent;
\`\`\`


## frontend_v2/src/components/layout/AppNavbar.js

\`\`\`
import React from 'react';
import { Navbar, Nav, Container, NavDropdown } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';

function AppNavbar() {
  const { user, logoutUser } = useAuth();
  return (
    <Navbar bg="light" variant="light" expand="lg" className="app-navbar sticky-top">
      <Container fluid>
        <div className="d-flex align-items-center gap-2">
          <Navbar.Brand as={Link} to="/"><i className="bi bi-box-seam me-2" />Inventory Pro</Navbar.Brand>
        </div>
        <Navbar.Toggle aria-controls="main-nav" />
        <Navbar.Collapse id="main-nav">
          <Nav className="me-auto">
            <Nav.Link as={Link} to="/">Dashboard</Nav.Link>
            <Nav.Link as={Link} to="/products">Products</Nav.Link>
            <Nav.Link as={Link} to="/suppliers">Suppliers</Nav.Link>
            <Nav.Link as={Link} to="/purchase-orders">Purchase Orders</Nav.Link>
            <Nav.Link as={Link} to="/sales-orders">Sales Orders</Nav.Link>
            <Nav.Link as={Link} to="/reports">Reports</Nav.Link>
          </Nav>
          <Nav>
            {user && (
              <NavDropdown title={user.username} align="end" id="user-menu">
                <NavDropdown.Item as={Link} to="/profile">Profile</NavDropdown.Item>
                <NavDropdown.Divider />
                <NavDropdown.Item onClick={logoutUser}>Logout</NavDropdown.Item>
              </NavDropdown>
            )}
          </Nav>
        </Navbar.Collapse>
      </Container>
    </Navbar>
  );
}
export default AppNavbar;

\`\`\`


## frontend_v2/src/components/layout/Breadcrumbs.js

\`\`\`
// src/components/layout/Breadcrumbs.js
import React from 'react';
import { Breadcrumb } from 'react-bootstrap';
import { Link, useLocation } from 'react-router-dom';

function Breadcrumbs() {
  const location = useLocation();
  const parts = location.pathname.split('/').filter(Boolean);
  const crumbs = parts.map((part, idx) => {
    const to = '/' + parts.slice(0, idx + 1).join('/');
    const isLast = idx === parts.length - 1;
    const label = part.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
    return isLast ? (
      <Breadcrumb.Item active key={to}>{label}</Breadcrumb.Item>
    ) : (
      <Breadcrumb.Item linkAs={Link} linkProps={{ to }} key={to}>{label}</Breadcrumb.Item>
    );
  });

  return (
    <div className="bg-white border-bottom">
      <div className="container py-2">
        <Breadcrumb className="mb-0">
          <Breadcrumb.Item linkAs={Link} linkProps={{ to: '/' }}>Home</Breadcrumb.Item>
          {crumbs}
        </Breadcrumb>
      </div>
    </div>
  );
}

export default Breadcrumbs;

\`\`\`


## frontend_v2/src/components/layout/Layout.js

\`\`\`
// src/components/layout/Layout.js
import React from 'react';
import { Outlet } from 'react-router-dom';
import AppNavbar from './AppNavbar';

function Layout() {
  return (
    <div>
      <AppNavbar />
      <main className="container page py-4">
        <Outlet />
      </main>
    </div>
  );
}
export default Layout;

\`\`\`


## frontend_v2/src/components/layout/Sidebar.js

\`\`\`
// src/components/layout/Sidebar.js
import React from 'react';
import { Nav } from 'react-bootstrap';
import { Link, useLocation } from 'react-router-dom';

function Sidebar() {
  const location = useLocation();
  const isActive = (path) => location.pathname === path;

  return (
    <div className="sidebar-inner">
      <div className="sidebar-brand">Inventory</div>
      <Nav className="flex-column">
        <Nav.Link as={Link} to="/" active={isActive('/')}>Dashboard</Nav.Link>
        <Nav.Link as={Link} to="/products" active={isActive('/products')}>Products</Nav.Link>
        <Nav.Link as={Link} to="/suppliers" active={isActive('/suppliers')}>Suppliers</Nav.Link>
        <Nav.Link as={Link} to="/purchase-orders" active={isActive('/purchase-orders')}>Purchase Orders</Nav.Link>
        <Nav.Link as={Link} to="/sales-orders" active={isActive('/sales-orders')}>Sales Orders</Nav.Link>
        <Nav.Link as={Link} to="/reports" active={isActive('/reports')}>Reports</Nav.Link>
        <div className="mt-3 small text-muted px-3">Account</div>
        <Nav.Link as={Link} to="/profile" active={isActive('/profile')}>Profile</Nav.Link>
      </Nav>
    </div>
  );
}

export default Sidebar;
\`\`\`


## frontend_v2/src/components/ProductFormModal.js

\`\`\`
// src/components/ProductFormModal.js
import React, { useState, useEffect } from 'react';
import { Modal, Button, Form } from 'react-bootstrap';

function ProductFormModal({ show, handleClose, product, onSave }) {
  const [formData, setFormData] = useState({});

  useEffect(() => {
    if (product) {
      setFormData(product);
    } else {
      setFormData({ name: '', sku: '', category: '', unit_price: '', stock_quantity: '', min_stock_level: '' });
    }
  }, [product, show]);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData({ ...formData, [name]: value });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    onSave(formData);
  };

  return (
    <Modal show={show} onHide={handleClose}>
      <Modal.Header closeButton><Modal.Title>{product ? 'Edit Product' : 'Create Product'}</Modal.Title></Modal.Header>
      <Form onSubmit={handleSubmit}>
        <Modal.Body>
          <Form.Group className="mb-3"><Form.Label>Name</Form.Label><Form.Control type="text" name="name" value={formData.name || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>SKU</Form.Label><Form.Control type="text" name="sku" value={formData.sku || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Category</Form.Label><Form.Control type="text" name="category" value={formData.category || ''} onChange={handleChange} /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Unit Price</Form.Label><Form.Control type="number" name="unit_price" value={formData.unit_price || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Stock Quantity</Form.Label><Form.Control type="number" name="stock_quantity" value={formData.stock_quantity || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Minimum Stock Level</Form.Label><Form.Control type="number" name="min_stock_level" value={formData.min_stock_level || ''} onChange={handleChange} required /></Form.Group>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="secondary" onClick={handleClose}>Close</Button>
          <Button variant="primary" type="submit">Save Changes</Button>
        </Modal.Footer>
      </Form>
    </Modal>
  );
}

export default ProductFormModal;
\`\`\`


## frontend_v2/src/components/ProtectedRoute.js

\`\`\`
// src/components/ProtectedRoute.js
import React from 'react';
import { Navigate } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';

function ProtectedRoute({ children }) {
  const { user } = useAuth();
  if (!user) {
    return <Navigate to="/login" />;
  }
  return children;
}

export default ProtectedRoute;
\`\`\`


## frontend_v2/src/components/RoleRequired.js

\`\`\`
// src/components/RoleRequired.js
import { useAuth } from '../context/AuthContext';

function RoleRequired({ allowedRoles, children }) {
  const { user } = useAuth();

  if (user && allowedRoles.includes(user.role)) {
    return <>{children}</>;
  }

  return null;
}

export default RoleRequired;
\`\`\`


## frontend_v2/src/components/SupplierFormModal.js

\`\`\`
// src/components/SupplierFormModal.js
import React, { useState, useEffect } from 'react';
import { Modal, Button, Form } from 'react-bootstrap';

function SupplierFormModal({ show, handleClose, supplier, onSave }) {
  const [formData, setFormData] = useState({});

  useEffect(() => {
    if (supplier) {
      setFormData(supplier);
    } else {
      setFormData({ name: '', email: '', phone: '', contact_info: '' });
    }
  }, [supplier, show]);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData({ ...formData, [name]: value });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    onSave(formData);
  };

  return (
    <Modal show={show} onHide={handleClose}>
      <Modal.Header closeButton><Modal.Title>{supplier ? 'Edit Supplier' : 'Create Supplier'}</Modal.Title></Modal.Header>
      <Form onSubmit={handleSubmit}>
        <Modal.Body>
          <Form.Group className="mb-3"><Form.Label>Name</Form.Label><Form.Control type="text" name="name" value={formData.name || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Email</Form.Label><Form.Control type="email" name="email" value={formData.email || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Phone</Form.Label><Form.Control type="text" name="phone" value={formData.phone || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Contact Info (Address)</Form.Label><Form.Control as="textarea" rows={3} name="contact_info" value={formData.contact_info || ''} onChange={handleChange} /></Form.Group>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="secondary" onClick={handleClose}>Close</Button>
          <Button variant="primary" type="submit">Save Changes</Button>
        </Modal.Footer>
      </Form>
    </Modal>
  );
}

export default SupplierFormModal;

\`\`\`


## frontend_v2/src/components/ui/EmptyState.js

\`\`\`
// src/components/ui/EmptyState.js
import React from 'react';

function EmptyState({ title, description, action }) {
  return (
    <div className="text-center p-5 bg-white border rounded">
      <div className="display-6 mb-2">ðŸ“„</div>
      <h5 className="mb-2">{title}</h5>
      <p className="text-muted mb-3">{description}</p>
      {action}
    </div>
  );
}

export default EmptyState;
\`\`\`


## frontend_v2/src/components/ui/PageHeader.js

\`\`\`
// src/components/ui/PageHeader.js
import React from 'react';

function PageHeader({ title, subtitle, actions }) {
  return (
    <div className="page-header d-flex flex-wrap align-items-center justify-content-between mb-3">
      <div className="pe-3">
        <h1 className="mb-0">{title}</h1>
        {subtitle && <div className="text-muted small mt-1">{subtitle}</div>}
      </div>
      {actions && <div className="d-flex gap-2 mt-2 mt-sm-0">{actions}</div>}
    </div>
  );
}

export default PageHeader;
\`\`\`


## frontend_v2/src/components/ui/PaginationBar.js

\`\`\`
// src/components/ui/PaginationBar.js
import React from 'react';
import { Pagination, Form } from 'react-bootstrap';

function PaginationBar({ page, pageSize, total, onPageChange, onPageSizeChange }) {
  const totalPages = Math.max(1, Math.ceil(total / pageSize));
  const canPrev = page > 1;
  const canNext = page < totalPages;

  const goto = (p) => {
    const np = Math.min(Math.max(1, p), totalPages);
    onPageChange(np);
  };

  const start = total === 0 ? 0 : (page - 1) * pageSize + 1;
  const end = Math.min(page * pageSize, total);

  return (
    <div className="d-flex align-items-center justify-content-between my-3">
      <div className="d-flex align-items-center gap-2">
        <span className="text-muted">Rows per page</span>
        <Form.Select
          size="sm"
          style={{ width: 80 }}
          value={pageSize}
          onChange={(e) => onPageSizeChange(parseInt(e.target.value, 10))}
        >
          {[10, 25, 50, 100].map((s) => (
            <option key={s} value={s}>
              {s}
            </option>
          ))}
        </Form.Select>
        <span className="text-muted">
          {start}â€“{end} of {total}
        </span>
      </div>
      <Pagination className="mb-0">
        <Pagination.First onClick={() => goto(1)} disabled={!canPrev} />
        <Pagination.Prev onClick={() => goto(page - 1)} disabled={!canPrev} />
        <Pagination.Item active>{page}</Pagination.Item>
        <Pagination.Next onClick={() => goto(page + 1)} disabled={!canNext} />
        <Pagination.Last onClick={() => goto(totalPages)} disabled={!canNext} />
      </Pagination>
    </div>
  );
}

export default PaginationBar;

\`\`\`


## frontend_v2/src/components/ui/TableToolbar.js

\`\`\`
// src/components/ui/TableToolbar.js
import React from 'react';
import { Button, Form } from 'react-bootstrap';

function TableToolbar({ search, onSearchChange, actions }) {
  return (
    <div className="d-flex flex-wrap align-items-center gap-2 mb-3">
      <Form.Control
        style={{ maxWidth: 300 }}
        type="search"
        placeholder="Search..."
        value={search}
        onChange={(e) => onSearchChange(e.target.value)}
      />
      <div className="ms-auto d-flex gap-2">
        {actions}
      </div>
    </div>
  );
}

export default TableToolbar;

\`\`\`


## frontend_v2/src/components/ui/ToastProvider.js

\`\`\`
// src/components/ui/ToastProvider.js
import React, { createContext, useCallback, useContext, useMemo, useState } from 'react';
import { Toast, ToastContainer } from 'react-bootstrap';

const ToastContext = createContext({ showToast: () => {} });

export function ToastProvider({ children }) {
  const [toasts, setToasts] = useState([]);

  const showToast = useCallback(({ title = '', message = '', variant = 'primary', delay = 3500 }) => {
    const id = Math.random().toString(36).slice(2);
    setToasts((prev) => [...prev, { id, title, message, variant, delay }]);
  }, []);

  const removeToast = useCallback((id) => {
    setToasts((prev) => prev.filter((t) => t.id !== id));
  }, []);

  const value = useMemo(() => ({ showToast }), [showToast]);

  return (
    <ToastContext.Provider value={value}>
      {children}
      <ToastContainer position="top-end" className="p-3">
        {toasts.map((t) => (
          <Toast key={t.id} bg={t.variant} onClose={() => removeToast(t.id)} delay={t.delay} autohide>
            {t.title ? (
              <Toast.Header closeButton={false}>
                <strong className="me-auto">{t.title}</strong>
              </Toast.Header>
            ) : null}
            <Toast.Body className={t.variant === 'warning' || t.variant === 'light' ? '' : 'text-white'}>
              {t.message}
            </Toast.Body>
          </Toast>
        ))}
      </ToastContainer>
    </ToastContext.Provider>
  );
}

export function useToast() {
  return useContext(ToastContext);
}

\`\`\`


## frontend_v2/src/context/AuthContext.js

\`\`\`
// src/context/AuthContext.js
import React, { createContext, useState, useContext } from 'react';
import { jwtDecode } from 'jwt-decode';
// Note: We no longer need to import 'api' here

const AuthContext = createContext(null);

export const AuthProvider = ({ children }) => {
  const [tokens, setTokens] = useState(() => 
    localStorage.getItem('authTokens') 
      ? JSON.parse(localStorage.getItem('authTokens')) 
      : null
  );
  
  const [user, setUser] = useState(() => 
    localStorage.getItem('authTokens') 
      ? jwtDecode(JSON.parse(localStorage.getItem('authTokens')).access) 
      : null
  );

  const loginUser = (newTokens) => {
    setTokens(newTokens);
    setUser(jwtDecode(newTokens.access));
    localStorage.setItem('authTokens', JSON.stringify(newTokens));
  };

  const logoutUser = () => {
    setTokens(null);
    setUser(null);
    localStorage.removeItem('authTokens');
  };
  
  // The useEffect that set the api header is no longer needed.
  
  const contextData = {
    user,
    tokens,
    loginUser,
    logoutUser,
  };
  
  return (
    <AuthContext.Provider value={contextData}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  return useContext(AuthContext);
};
\`\`\`


## frontend_v2/src/index.css

\`\`\`
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

\`\`\`


## frontend_v2/src/index.js

\`\`\`
// src/index.js
import 'bootstrap/dist/css/bootstrap.min.css';
import './styles/theme.css';
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import { ToastProvider } from './components/ui/ToastProvider';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
    <ToastProvider>
      <App />
    </ToastProvider>
  </React.StrictMode>
);
\`\`\`


## frontend_v2/src/pages/ConfirmPasswordResetPage.js

\`\`\`
import React, { useState } from 'react';
import { Container, Form, Button, Card, Alert } from 'react-bootstrap';
import { useParams, useNavigate, Link } from 'react-router-dom';
import { confirmPasswordReset } from '../services/api'; // Correct path

function ConfirmPasswordResetPage() {
  const [password, setPassword] = useState('');
  const [password2, setPassword2] = useState('');
  const [message, setMessage] = useState('');
  const [error, setError] = useState('');
  const { token } = useParams();
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (password !== password2) {
      setError('Passwords do not match.');
      return;
    }
    setError('');
    setMessage('');
    try {
      await confirmPasswordReset(token, password);
      setMessage('Your password has been successfully reset! Redirecting to login...');
      setTimeout(() => navigate('/login'), 3000);
    } catch (err) {
      setError('Invalid or expired token. Please request a new password reset.');
    }
  };

  return (
    <Container className="mt-5 d-flex justify-content-center">
      <Card style={{ width: '400px' }}>
        <Card.Body>
          <h2 className="text-center mb-4">Set New Password</h2>
          {message && <Alert variant="success">{message}</Alert>}
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3">
              <Form.Label>New Password</Form.Label>
              <Form.Control type="password" value={password} onChange={(e) => setPassword(e.target.value)} required />
            </Form.Group>
            <Form.Group className="mb-3">
              <Form.Label>Confirm New Password</Form.Label>
              <Form.Control type="password" value={password2} onChange={(e) => setPassword2(e.target.value)} required />
            </Form.Group>
            <div className="d-grid">
              <Button variant="primary" type="submit">
                Reset Password
              </Button>
            </div>
          </Form>
        </Card.Body>
        <Card.Footer className="text-center">
          <Link to="/login">Back to Login</Link>
        </Card.Footer>
      </Card>
    </Container>
  );
}

export default ConfirmPasswordResetPage;
\`\`\`


## frontend_v2/src/pages/CreatePurchaseOrderPage.js

\`\`\`
// src/pages/CreatePurchaseOrderPage.js
import React, { useState, useEffect } from 'react';
import { Container, Form, Button, Table, Row, Col, Card, Spinner, Alert } from 'react-bootstrap';
import { useNavigate } from 'react-router-dom';
import { getSuppliers, getProducts, createPurchaseOrder } from '../services/api';

function CreatePurchaseOrderPage() {
  const [suppliers, setSuppliers] = useState([]);
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [selectedSupplier, setSelectedSupplier] = useState('');
  const [orderItems, setOrderItems] = useState([]);
  const [currentItem, setCurrentItem] = useState({ product: '', quantity: 1, unit_price: '' });
  const navigate = useNavigate();

  useEffect(() => {
    const fetchData = async () => {
      try {
        const [suppliersRes, productsRes] = await Promise.all([getSuppliers(), getProducts()]);
        setSuppliers(suppliersRes.data);
        setProducts(productsRes.data);
      } catch (err) { setError('Failed to load necessary data.'); } 
      finally { setLoading(false); }
    };
    fetchData();
  }, []);

  const handleProductSelect = (productId) => {
    const product = products.find(p => p.id === parseInt(productId));
    if (product) setCurrentItem({ product: productId, quantity: 1, unit_price: product.unit_price });
  };

  const handleAddItem = () => {
    if (!currentItem.product || currentItem.quantity <= 0) return;
    const product = products.find(p => p.id === parseInt(currentItem.product));
    setOrderItems([...orderItems, { ...currentItem, productName: product.name, sku: product.sku }]);
    setCurrentItem({ product: '', quantity: 1, unit_price: '' });
  };
  
  const handleRemoveItem = (index) => setOrderItems(orderItems.filter((_, i) => i !== index));

  const handleSubmit = async () => {
    if (!selectedSupplier || orderItems.length === 0) {
      alert('Please select a supplier and add at least one item.');
      return;
    }
    const orderData = {
      supplier: selectedSupplier,
      status: 'Pending',
      items: orderItems.map(item => ({ product: item.product, quantity: item.quantity, unit_price: item.unit_price }))
    };
    try {
      await createPurchaseOrder(orderData);
      navigate('/purchase-orders');
    } catch (err) { setError('Failed to create purchase order.'); }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error}</Alert></Container>;

  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-bag-plus" /> Create Purchase Order</h1>
        </div>
      </div>
      <Card className="p-4">
        <Form.Group as={Row} className="mb-3">
          <Form.Label column sm={2}>Supplier</Form.Label>
          <Col sm={10}><Form.Select value={selectedSupplier} onChange={(e) => setSelectedSupplier(e.target.value)} required><option value="">Select a Supplier</option>{suppliers.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}</Form.Select></Col>
        </Form.Group>
        <hr />
        <h4 className="mt-4">Add Items</h4>
        <Row className="align-items-end g-3">
            <Col md={5}><Form.Label>Product</Form.Label><Form.Select value={currentItem.product} onChange={(e) => handleProductSelect(e.target.value)}><option value="">Select a Product</option>{products.map(p => <option key={p.id} value={p.id}>{p.name} ({p.sku})</option>)}</Form.Select></Col>
            <Col md={2}><Form.Label>Quantity</Form.Label><Form.Control type="number" value={currentItem.quantity} onChange={(e) => setCurrentItem({...currentItem, quantity: e.target.value})} min="1"/></Col>
            <Col md={3}><Form.Label>Unit Price</Form.Label><Form.Control type="number" value={currentItem.unit_price} onChange={(e) => setCurrentItem({...currentItem, unit_price: e.target.value})} placeholder="Unit Price" /></Col>
            <Col md={2}><Button onClick={handleAddItem} className="w-100">Add Item</Button></Col>
        </Row>
        <h4 className="mt-5">Order Items</h4>
        <Table striped bordered hover>
          <thead><tr><th>Product</th><th>SKU</th><th>Quantity</th><th>Unit Price</th><th>Action</th></tr></thead>
          <tbody>
            {orderItems.map((item, index) => (
              <tr key={index}><td>{item.productName}</td><td>{item.sku}</td><td>{item.quantity}</td><td>${item.unit_price}</td><td><Button variant="danger" size="sm" onClick={() => handleRemoveItem(index)}>Remove</Button></td></tr>
            ))}
          </tbody>
        </Table>
        <div className="mt-4 text-end"><Button variant="success" size="lg" onClick={handleSubmit}>Submit Order</Button></div>
      </Card>
    </Container>
  );
}

export default CreatePurchaseOrderPage;
\`\`\`


## frontend_v2/src/pages/CreateSalesOrderPage.js

\`\`\`
// src/pages/CreateSalesOrderPage.js
import React, { useState, useEffect } from 'react';
import { Container, Form, Button, Table, Row, Col, Card, Spinner, Alert } from 'react-bootstrap';
import { useNavigate } from 'react-router-dom';
import { getProducts, createSalesOrder } from '../services/api';

function CreateSalesOrderPage() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [customerName, setCustomerName] = useState('');
  const [orderItems, setOrderItems] = useState([]);
  const [currentItem, setCurrentItem] = useState({ product: '', quantity: 1, unit_price: '' });
  const navigate = useNavigate();

  useEffect(() => {
    const fetchProducts = async () => {
      try { const productsRes = await getProducts(); setProducts(productsRes.data); } 
      catch (err) { setError('Failed to load products.'); } 
      finally { setLoading(false); }
    };
    fetchProducts();
  }, []);

  const handleProductSelect = (productId) => {
    const product = products.find(p => p.id === parseInt(productId));
    if (product) {
        if (product.stock_quantity > 0) {
            setCurrentItem({ product: productId, quantity: 1, unit_price: product.unit_price });
        } else {
            alert(`${product.name} is out of stock.`);
            setCurrentItem({ product: '', quantity: 1, unit_price: '' });
        }
    }
  };

  const handleAddItem = () => {
    if (!currentItem.product || currentItem.quantity <= 0) return;
    const product = products.find(p => p.id === parseInt(currentItem.product));
    if (currentItem.quantity > product.stock_quantity) {
        alert(`Not enough stock for ${product.name}. Available: ${product.stock_quantity}`);
        return;
    }
    setOrderItems([...orderItems, { ...currentItem, productName: product.name, sku: product.sku }]);
    setCurrentItem({ product: '', quantity: 1, unit_price: '' });
  };
  
  const handleRemoveItem = (index) => setOrderItems(orderItems.filter((_, i) => i !== index));

  const handleSubmit = async () => {
    if (orderItems.length === 0) {
      alert('Please add at least one item.'); return;
    }
    const orderData = {
      customer_name: customerName,
      status: 'Fulfilled',
      items: orderItems.map(item => ({ product: item.product, quantity: item.quantity, unit_price: item.unit_price }))
    };
    try {
      await createSalesOrder(orderData);
      navigate('/sales-orders');
    } catch (err) { setError(err.response?.data?.detail || 'Failed to create sales order.'); }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  
  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-receipt-cutoff" /> Create Sales Order</h1>
        </div>
      </div>
      {error && <Alert variant="danger" onClose={() => setError('')} dismissible>{error}</Alert>}
      <Card className="p-4">
        <Form.Group as={Row} className="mb-3">
          <Form.Label column sm={2}>Customer Name</Form.Label>
          <Col sm={10}><Form.Control type="text" placeholder="Enter customer name" value={customerName} onChange={(e) => setCustomerName(e.target.value)} /></Col>
        </Form.Group>
        <hr />
        <h4 className="mt-4">Add Items</h4>
        <Row className="align-items-end g-3">
            <Col md={5}><Form.Label>Product</Form.Label><Form.Select value={currentItem.product} onChange={(e) => handleProductSelect(e.target.value)}><option value="">Select a Product</option>{products.map(p => <option key={p.id} value={p.id}>{p.name} (In Stock: {p.stock_quantity})</option>)}</Form.Select></Col>
            <Col md={2}><Form.Label>Quantity</Form.Label><Form.Control type="number" value={currentItem.quantity} onChange={(e) => setCurrentItem({...currentItem, quantity: e.target.value})} min="1"/></Col>
            <Col md={3}><Form.Label>Unit Price</Form.Label><Form.Control type="number" value={currentItem.unit_price} onChange={(e) => setCurrentItem({...currentItem, unit_price: e.target.value})} placeholder="Unit Price" /></Col>
            <Col md={2}><Button onClick={handleAddItem} className="w-100">Add Item</Button></Col>
        </Row>
        <h4 className="mt-5">Order Items</h4>
        <Table striped bordered hover>
          <thead><tr><th>Product</th><th>SKU</th><th>Quantity</th><th>Unit Price</th><th>Action</th></tr></thead>
          <tbody>
            {orderItems.map((item, index) => (
              <tr key={index}><td>{item.productName}</td><td>{item.sku}</td><td>{item.quantity}</td><td>${item.unit_price}</td><td><Button variant="danger" size="sm" onClick={() => handleRemoveItem(index)}>Remove</Button></td></tr>
            ))}
          </tbody>
        </Table>
        <div className="mt-4 text-end"><Button variant="success" size="lg" onClick={handleSubmit}>Submit Order</Button></div>
      </Card>
    </Container>
  );
}

export default CreateSalesOrderPage;
\`\`\`


## frontend_v2/src/pages/DashboardPage.js

\`\`\`
// src/pages/DashboardPage.js
import React, { useState, useEffect } from 'react';
import { Container, Row, Col, Card, Spinner, Alert, Table, Badge } from 'react-bootstrap';
import { useAuth } from '../context/AuthContext';
import { getDashboardStats } from '../services/api';

function DashboardPage() {
  const { user } = useAuth();
  const [stats, setStats] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');

  useEffect(() => {
    const fetchStats = async () => {
      try {
        const response = await getDashboardStats();
        setStats(response.data);
      } catch (err) {
        setError('Failed to load dashboard data.');
      } finally {
        setLoading(false);
      }
    };
    fetchStats();
  }, []);

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error}</Alert></Container>;

  return (
    <Container>
      <div className="page-header d-flex justify-content-between align-items-end mt-3">
        <div>
          <h1 className="mb-0">Dashboard</h1>
          <div className="text-muted">Welcome back, <strong>{user.username}</strong>!</div>
        </div>
      </div>
      <Row>
        <Col md={4}><Card className="text-center mb-3"><Card.Body><Card.Title>Total Products</Card.Title><Card.Text className="fs-2">{stats?.total_products}</Card.Text></Card.Body></Card></Col>
        <Col md={4}><Card className="text-center mb-3"><Card.Body><Card.Title>Low Stock Items</Card.Title><Card.Text className="fs-2 text-danger">{stats?.low_stock_items.length}</Card.Text></Card.Body></Card></Col>
      </Row>

      <Row>
        <Col md={6}>
          <h4 className="mt-5">Low Stock Alerts</h4>
          <Card>
            <Table responsive striped hover className="mb-0">
              <thead><tr><th>Product</th><th>In Stock</th><th>Min Level</th></tr></thead>
              <tbody>
                {stats?.low_stock_items.length > 0 ? (
                  stats.low_stock_items.map(item => (
                    <tr key={item.id}><td>{item.name}</td><td><Badge bg="danger">{item.stock_quantity}</Badge></td><td>{item.min_stock_level}</td></tr>
                  ))
                ) : ( <tr><td colSpan="3" className="text-center">No items are low on stock.</td></tr> )}
              </tbody>
            </Table>
          </Card>
        </Col>
        <Col md={6}>
          <h4 className="mt-5">Recent Transactions</h4>
          <Card>
            <Table responsive striped hover className="mb-0">
              <thead><tr><th>Product</th><th>Type</th><th>Qty Change</th></tr></thead>
              <tbody>
                {stats?.recent_transactions.length > 0 ? (
                  stats.recent_transactions.map(tx => (
                    <tr key={tx.id}>
                      <td>{tx.product.name}</td>
                      <td><Badge bg={tx.transaction_type === 'Sale' ? 'danger' : 'success'}>{tx.transaction_type}</Badge></td>
                      <td className={tx.quantity_change > 0 ? 'text-success' : 'text-danger'}>
                        {tx.quantity_change > 0 ? `+${tx.quantity_change}` : tx.quantity_change}
                      </td>
                    </tr>
                  ))
                ) : ( <tr><td colSpan="3" className="text-center">No recent transactions.</td></tr> )}
              </tbody>
            </Table>
          </Card>
        </Col>
      </Row>
    </Container>
  );
}

export default DashboardPage;
\`\`\`


## frontend_v2/src/pages/InvoicePage.js

\`\`\`
import React, { useState, useEffect } from 'react';
import { useParams, Link } from 'react-router-dom';
import { Container, Table, Row, Col, Spinner, Alert } from 'react-bootstrap';
import { getSalesOrders } from '../services/api';
import '../components/Invoice.css'; // Import our new CSS file

function InvoicePage() {
  const [order, setOrder] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const { id } = useParams(); // Get the order ID from the URL

  useEffect(() => {
    const fetchOrder = async () => {
      try {
        // We fetch all orders and then find the one we need.
        // In a larger app, you would fetch a single order by its ID.
        const response = await getSalesOrders();
        const currentOrder = response.data.find(o => o.id === parseInt(id));
        if (currentOrder) {
          setOrder(currentOrder);
        } else {
          setError('Invoice not found.');
        }
      } catch (err) {
        setError('Failed to fetch invoice data.');
      } finally {
        setLoading(false);
      }
    };
    fetchOrder();
  }, [id]);

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error} <Link to="/sales-orders">Go back</Link></Alert></Container>;
  if (!order) return null;

  // --- Calculation Logic ---
  const subtotal = order.items.reduce((acc, item) => acc + (item.quantity * item.unit_price), 0);
  const taxRate = 0.08;
  const tax = subtotal * taxRate;
  const total = subtotal + tax;

  return (
    // We apply our special class here
    <div className="invoice-container">
      <Row className="mb-4 align-items-center">
        <Col><h1 className="mb-0">INVOICE</h1><p className="text-muted">Your Company Name</p></Col>
        <Col className="text-end"><p className="mb-0"><strong>Order #:</strong> SO-{order.id}</p><p className="mb-0"><strong>Date:</strong> {new Date(order.order_date).toLocaleDateString()}</p></Col>
      </Row>
      <hr />
      <Row className="mb-4"><Col><strong>Bill To:</strong><p className="mb-0">{order.customer_name || 'Valued Customer'}</p></Col></Row>
      <Table striped bordered hover>
        <thead><tr><th>Product</th><th>SKU</th><th>Quantity</th><th>Unit Price</th><th>Total</th></tr></thead>
        <tbody>
          {order.items.map((item) => (
            <tr key={item.id}>
              <td>{item.product.name}</td><td>{item.product.sku}</td><td>{item.quantity}</td>
              <td>â‚¹{parseFloat(item.unit_price).toFixed(2)}</td>
              <td>â‚¹{(item.quantity * item.unit_price).toFixed(2)}</td>
            </tr>
          ))}
        </tbody>
      </Table>
      <Row className="mt-4 justify-content-end">
        <Col md={4}>
          <Table borderless size="sm">
            <tbody>
              <tr><td><strong>Subtotal:</strong></td><td className="text-end">â‚¹{subtotal.toFixed(2)}</td></tr>
              <tr><td><strong>Tax ({(taxRate * 100).toFixed(0)}%):</strong></td><td className="text-end">â‚¹{tax.toFixed(2)}</td></tr>
              <tr className="border-top"><td className="pt-2"><strong>Total:</strong></td><td className="text-end pt-2"><strong>â‚¹{total.toFixed(2)}</strong></td></tr>
            </tbody>
          </Table>
        </Col>
      </Row>
    </div>
  );
}

export default InvoicePage;
\`\`\`


## frontend_v2/src/pages/LoginPage.js

\`\`\`
import React, { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { loginUser as apiLogin } from '../services/api'; // Correct path
import { useAuth } from '../context/AuthContext'; // Correct path
import { jwtDecode } from 'jwt-decode';
import { Container, Form, Button, Row, Col, Card, Alert } from 'react-bootstrap';

function LoginPage() {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');
  const { loginUser } = useAuth();
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    try {
      const response = await apiLogin(username, password);
      const { access } = response.data;
      
      loginUser(response.data);
      const decodedUser = jwtDecode(access);

      if (decodedUser.role === 'Admin') {
        window.location.href = 'http://127.0.0.1:8000/admin/';
      } else {
        navigate('/');
      }
    } catch (err) {
      setError('Failed to log in. Please check your credentials.');
      console.error(err);
    }
  };

  return (
    <div className="auth-page">
      <Card className="auth-card">
        <Card.Body>
          <div className="text-center mb-3">
            <i className="bi bi-box-seam fs-1 text-primary" />
            <h2 className="mt-2 mb-0">Welcome back</h2>
            <div className="text-muted">Sign in to Inventory Pro</div>
          </div>
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3">
              <Form.Label>Username</Form.Label>
              <Form.Control type="text" placeholder="Enter username" value={username} onChange={(e) => setUsername(e.target.value)} required />
            </Form.Group>
            <Form.Group className="mb-3">
              <Form.Label>Password</Form.Label>
              <Form.Control type="password" placeholder="Password" value={password} onChange={(e) => setPassword(e.target.value)} required />
            </Form.Group>
            <div className="d-grid"><Button variant="primary" type="submit">Log In</Button></div>
          </Form>
        </Card.Body>
        <Card.Footer className="text-center">
          <div>
            Don't have an account? <Link to="/register">Register Here</Link>
          </div>
          <div className="mt-2">
            <Link to="/forgot-password">Forgot Password?</Link>
          </div>
        </Card.Footer>
      </Card>
    </div>
  );
}

export default LoginPage;
\`\`\`


## frontend_v2/src/pages/ProductsPage.js

\`\`\`
// src/pages/ProductsPage.js
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, ButtonGroup } from 'react-bootstrap';
import TableToolbar from '../components/ui/TableToolbar';
import { useToast } from '../components/ui/ToastProvider';
import { getProducts, createProduct, updateProduct, deleteProduct } from '../services/api';
import ProductFormModal from '../components/ProductFormModal';
import RoleRequired from '../components/RoleRequired';



function ProductsPage() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [showModal, setShowModal] = useState(false);
  const [selectedProduct, setSelectedProduct] = useState(null);
  const [search, setSearch] = useState('');
  const { showToast } = useToast();

  const fetchProducts = async () => {
    try { setLoading(true); const response = await getProducts(); setProducts(response.data); setError(''); } 
    catch (err) { setError('Failed to fetch products.'); console.error(err); } 
    finally { setLoading(false); }
  };

  useEffect(() => { fetchProducts(); }, []);

  const handleShowCreateModal = () => { setSelectedProduct(null); setShowModal(true); };
  const handleShowEditModal = (product) => { setSelectedProduct(product); setShowModal(true); };
  const handleCloseModal = () => { setShowModal(false); setSelectedProduct(null); };

  const handleSave = async (formData) => {
    try {
      if (selectedProduct) { await updateProduct(selectedProduct.id, formData); showToast({ variant: 'success', message: 'Product updated' }); } 
      else { await createProduct(formData); showToast({ variant: 'success', message: 'Product created' }); }
      fetchProducts(); handleCloseModal();
    } catch (err) { setError(selectedProduct ? 'Failed to update product.' : 'Failed to create product.'); showToast({ variant: 'danger', message: 'Action failed' }); }
  };

  const handleDelete = async (id) => {
    if (window.confirm('Are you sure?')) {
      try { await deleteProduct(id); fetchProducts(); } 
      catch (err) { setError('Failed to delete product.'); }
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

//     <Container>
//       <div className="d-flex justify-content-between align-items-center my-4">
//         <h1>Products</h1>
//         <RoleRequired allowedRoles={['Admin', 'Manager']}>
//             <Button variant="primary" onClick={handleShowCreateModal}>Create Product</Button>
//         </RoleRequired>
//       </div>
//       {error && <Alert variant="danger">{error}</Alert>}
//       <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />
//     </Container>

return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-box-seam" /> Products</h1>
          <RoleRequired allowedRoles={['Admin', 'Manager']}>
<Button variant="primary" onClick={handleShowCreateModal}><i className="bi bi-plus-lg me-1" /> Create Product</Button>
          </RoleRequired>
        </div>
      </div>
      {error && <Alert variant="danger" className="mb-3">{error}</Alert>}
      <TableToolbar search={search} onSearchChange={setSearch} actions={null} />
      <Table striped bordered hover responsive>
        <thead>
          <tr>
            <th>SKU</th>
            <th>Name</th>
            <th>Stock</th>
            <RoleRequired allowedRoles={['Admin', 'Manager']}>
                <th>Actions</th>
            </RoleRequired>
          </tr>
        </thead>
        <tbody>
          {products.filter(p => 
            [p.sku, p.name].join(' ').toLowerCase().includes(search.toLowerCase())
          ).map((product) => (
            <tr key={product.id}>
              <td>{product.sku}</td>
              <td>{product.name}</td>
              <td>{product.stock_quantity}</td>
              <RoleRequired allowedRoles={['Admin', 'Manager']}>
                <td>
                    <ButtonGroup>
<Button variant="outline-secondary" size="sm" onClick={() => handleShowEditModal(product)}><i className="bi bi-pencil me-1" /> Edit</Button>
<Button variant="outline-danger" size="sm" onClick={() => handleDelete(product.id)}><i className="bi bi-trash me-1" /> Delete</Button>
                    </ButtonGroup>
                </td>
              </RoleRequired>
            </tr>
          ))}
        </tbody>
      </Table>
      <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />
    </Container>
  );
}

export default ProductsPage;
\`\`\`


## frontend_v2/src/pages/ProfilePage.js

\`\`\`
// src/features/auth/ProfilePage.js
import React, { useState, useEffect } from 'react';
import { Container, Row, Col, Card, Form, Button, Alert, Spinner } from 'react-bootstrap';
import { getUserProfile, updateUserProfile, changePassword } from '../services/api';
import { useAuth } from '../context/AuthContext';

function ProfilePage() {
  const [profile, setProfile] = useState({ username: '', email: '', first_name: '', last_name: '' });
  const [passwordData, setPasswordData] = useState({ old_password: '', new_password: '', new_password2: '' });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  const { logoutUser } = useAuth();

  useEffect(() => {
    const fetchProfile = async () => {
      try {
        const response = await getUserProfile();
        setProfile(response.data);
      } catch (err) {
        setError('Failed to fetch profile data.');
      } finally {
        setLoading(false);
      }
    };
    fetchProfile();
  }, []);

  const handleProfileChange = (e) => setProfile({ ...profile, [e.target.name]: e.target.value });
  const handlePasswordChange = (e) => setPasswordData({ ...passwordData, [e.target.name]: e.target.value });

  const handleProfileSubmit = async (e) => {
    e.preventDefault();
    setError(''); setSuccess('');
    try {
      await updateUserProfile({ first_name: profile.first_name, last_name: profile.last_name, email: profile.email });
      setSuccess('Profile updated successfully!');
    } catch (err) {
      setError('Failed to update profile.');
    }
  };

  const handlePasswordSubmit = async (e) => {
    e.preventDefault();
    setError(''); setSuccess('');
    if (passwordData.new_password !== passwordData.new_password2) {
      setError('New passwords do not match.');
      return;
    }
    try {
      await changePassword(passwordData);
      setSuccess('Password changed successfully! You will be logged out shortly.');
      setTimeout(() => logoutUser(), 3000);
    } catch (err) {
      const apiError = err.response?.data?.old_password || err.response?.data?.new_password || 'Failed to change password.';
      setError(apiError);
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-person-gear" /> Manage Profile</h1>
        </div>
      </div>
      {error && <Alert variant="danger" onClose={() => setError('')} dismissible>{error}</Alert>}
      {success && <Alert variant="success" onClose={() => setSuccess('')} dismissible>{success}</Alert>}
      <Row>
        <Col md={6} className="mb-4">
          <Card>
            <Card.Body>
              <Card.Title>Your Details</Card.Title>
              <Form onSubmit={handleProfileSubmit}>
                <Form.Group className="mb-3"><Form.Label>Username</Form.Label><Form.Control type="text" value={profile.username} disabled /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Email</Form.Label><Form.Control type="email" name="email" value={profile.email} onChange={handleProfileChange} /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>First Name</Form.Label><Form.Control type="text" name="first_name" value={profile.first_name} onChange={handleProfileChange} /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Last Name</Form.Label><Form.Control type="text" name="last_name" value={profile.last_name} onChange={handleProfileChange} /></Form.Group>
                <Button variant="primary" type="submit">Save Changes</Button>
              </Form>
            </Card.Body>
          </Card>
        </Col>
        <Col md={6}>
          <Card>
            <Card.Body>
              <Card.Title>Change Password</Card.Title>
              <Form onSubmit={handlePasswordSubmit}>
                <Form.Group className="mb-3"><Form.Label>Old Password</Form.Label><Form.Control type="password" name="old_password" value={passwordData.old_password} onChange={handlePasswordChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>New Password</Form.Label><Form.Control type="password" name="new_password" value={passwordData.new_password} onChange={handlePasswordChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Confirm New Password</Form.Label><Form.Control type="password" name="new_password2" value={passwordData.new_password2} onChange={handlePasswordChange} required /></Form.Group>
                <Button variant="warning" type="submit">Change Password</Button>
              </Form>
            </Card.Body>
          </Card>
        </Col>
      </Row>
    </Container>
  );
}

export default ProfilePage;
\`\`\`


## frontend_v2/src/pages/PurchaseOrdersPage.js

\`\`\`
// src/pages/PurchaseOrdersPage.js
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, Card, Badge } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { getPurchaseOrders, receivePurchaseOrder } from '../services/api';
import RoleRequired from '../components/RoleRequired';
import TableToolbar from '../components/ui/TableToolbar';
import PaginationBar from '../components/ui/PaginationBar';
import EmptyState from '../components/ui/EmptyState';
import { useToast } from '../components/ui/ToastProvider';

function PurchaseOrdersPage() {
  const [purchaseOrders, setPurchaseOrders] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [search, setSearch] = useState('');
  const [page, setPage] = useState(1);
  const [pageSize, setPageSize] = useState(10);
  const { showToast } = useToast();

  const fetchPurchaseOrders = async () => {
    try {
      setLoading(true);
      setError('');
      const response = await getPurchaseOrders();
      setPurchaseOrders(response.data);
    } catch (err) {
      setError('Failed to fetch purchase orders.');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => { fetchPurchaseOrders(); }, []);

  const handleReceiveOrder = async (orderId) => {
    if (window.confirm('Are you sure you want to receive this order? This will add all items to stock.')) {
        try {
            await receivePurchaseOrder(orderId);
            showToast({ variant: 'success', message: 'Purchase order received' });
            fetchPurchaseOrders(); // Refresh the list
        } catch (err) {
            setError('Failed to receive order.');
            showToast({ variant: 'danger', message: 'Failed to receive order' });
        }
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-bag-check" /> Purchase Orders</h1>
          <RoleRequired allowedRoles={['Admin', 'Manager']}>
<Button as={Link} to="/purchase-orders/create" variant="primary"><i className="bi bi-plus-lg me-1" /> Create Purchase Order</Button>
          </RoleRequired>
        </div>
      </div>
      {error && <Alert variant="danger" onClose={() => setError('')} dismissible className="mb-3">{error}</Alert>}

      <TableToolbar search={search} onSearchChange={(q)=>{setSearch(q); setPage(1);}} actions={null} />

      {purchaseOrders.length === 0 ? (
        <EmptyState title="No purchase orders" description="Create a purchase order to get started." action={
          <RoleRequired allowedRoles={['Admin', 'Manager']}>
            <Button as={Link} to="/purchase-orders/create" variant="primary">Create Purchase Order</Button>
          </RoleRequired>
        } />
      ) : (
        <>
          {purchaseOrders
            .filter(o => (`PO-${o.id} ${o.supplier?.name ?? ''} ${o.status}`.toLowerCase().includes(search.toLowerCase())))
            .slice((page-1)*pageSize, (page-1)*pageSize + pageSize)
            .map((order) => (
            <Card className="mb-3" key={order.id}>
              <Card.Header as="h5" className="d-flex justify-content-between align-items-center">
                <span>PO-{order.id} | Supplier: {order.supplier.name}</span>
                <Badge bg={order.status === 'Received' ? 'success' : 'warning'}>{order.status}</Badge>
              </Card.Header>
              <Card.Body>
                <Card.Text><strong>Order Date:</strong> {new Date(order.order_date).toLocaleDateString()}</Card.Text>
                <h6>Items:</h6>
                <div className="table-scroll">
                  <Table striped hover size="sm" className="table-sticky">
                    <thead><tr><th>Product</th><th>Quantity</th><th>Unit Price</th></tr></thead>
                    <tbody>
                      {order.items.map((item) => (
                        <tr key={item.id}>
                          <td>{item.product.name} ({item.product.sku})</td>
                          <td>{item.quantity}</td>
                          <td>${item.unit_price}</td>
                        </tr>
                      ))}
                    </tbody>
                  </Table>
                </div>
              </Card.Body>
              <Card.Footer className="text-end">
                <RoleRequired allowedRoles={['Admin', 'Manager']}>
                  <Button 
                      variant="success" 
                      disabled={order.status === 'Received'}
                      onClick={() => handleReceiveOrder(order.id)}
                  >
                      {order.status === 'Received' ? 'âœ“ Received' : 'Mark as Received'}
                  </Button>
                </RoleRequired>
              </Card.Footer>
            </Card>
          ))}
          <PaginationBar
            page={page}
            pageSize={pageSize}
            total={purchaseOrders.filter(o => (`PO-${o.id} ${o.supplier?.name ?? ''} ${o.status}`.toLowerCase().includes(search.toLowerCase()))).length}
            onPageChange={setPage}
            onPageSizeChange={(s)=>{setPageSize(s); setPage(1);}}
          />
        </>
      )}
    </Container>
  );
}

export default PurchaseOrdersPage;
\`\`\`


## frontend_v2/src/pages/RegisterPage.js

\`\`\`
// src/pages/RegisterPage.js
import React, { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { registerUser } from '../services/api';
import { Container, Form, Button, Row, Col, Card, Alert } from 'react-bootstrap';

function RegisterPage() {
  const [formData, setFormData] = useState({
    username: '',
    email: '',
    first_name: '',
    last_name: '',
    password: '',
    password2: '',
    role: 'Staff', // Default role
  });
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  const navigate = useNavigate();

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    setSuccess('');

    try {
      await registerUser(formData);
      setSuccess('Registration successful! Redirecting to login...');
      setTimeout(() => {
        navigate('/login');
      }, 2000);
    } catch (err) {
      const errorData = err.response?.data;
      if (errorData) {
        const messages = Object.keys(errorData).map(key => `${key}: ${errorData[key]}`).join(' ');
        setError(messages || 'Failed to register.');
      } else {
        setError('An unexpected error occurred.');
      }
    }
  };

  return (
    <div className="auth-page">
      <Card className="auth-card">
        <Card.Body>
          <div className="text-center mb-3">
            <i className="bi bi-person-plus fs-1 text-primary" />
            <h2 className="mt-2 mb-0">Create an account</h2>
            <div className="text-muted">Join Inventory Pro</div>
          </div>
          {error && <Alert variant="danger">{error}</Alert>}
          {success && <Alert variant="success">{success}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3"><Form.Label>Username</Form.Label><Form.Control type="text" name="username" onChange={handleChange} required /></Form.Group>
            <Form.Group className="mb-3"><Form.Label>Email</Form.Label><Form.Control type="email" name="email" onChange={handleChange} required /></Form.Group>
            <Form.Group className="mb-3"><Form.Label>First Name</Form.Label><Form.Control type="text" name="first_name" onChange={handleChange} required /></Form.Group>
            <Form.Group className="mb-3"><Form.Label>Last Name</Form.Label><Form.Control type="text" name="last_name" onChange={handleChange} required /></Form.Group>
            <Form.Group className="mb-3"><Form.Label>Password</Form.Label><Form.Control type="password" name="password" onChange={handleChange} required /></Form.Group>
            <Form.Group className="mb-3"><Form.Label>Confirm Password</Form.Label><Form.Control type="password" name="password2" onChange={handleChange} required /></Form.Group>
            <Form.Group className="mb-3"><Form.Label>Role</Form.Label><Form.Select name="role" value={formData.role} onChange={handleChange}><option value="Staff">Staff</option><option value="Manager">Manager</option></Form.Select></Form.Group>
            <div className="d-grid"><Button variant="primary" type="submit">Register</Button></div>
          </Form>
        </Card.Body>
        <Card.Footer className="text-center">Already have an account? <Link to="/login">Log In</Link></Card.Footer>
      </Card>
    </div>
  );
}

export default RegisterPage;
\`\`\`


## frontend_v2/src/pages/ReportsPage.js

\`\`\`
import React, { useState, useEffect, useCallback } from 'react';
import { Container, Table, Spinner, Alert, Card, Form, Row, Col, Button } from 'react-bootstrap';
import { getTransactions } from '../services/api';
import { CSVLink } from 'react-csv';

function ReportsPage() {
  const [transactions, setTransactions] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [filters, setFilters] = useState({
    timestamp__gte: '', 
    timestamp__lte: '', 
    transaction_type: '',
  });

  const csvHeaders = [
    { label: "Date", key: "timestamp" },
    { label: "Product", key: "product.name" },
    { label: "SKU", key: "product.sku" },
    { label: "Type", key: "transaction_type" },
    { label: "Quantity Change", key: "quantity_change" },
    { label: "Reason", key: "reason" },
    { label: "User", key: "user.username" },
  ];

  const fetchTransactions = useCallback(async () => {
    try {
      setLoading(true);
      const nonEmptyFilters = Object.fromEntries(
        Object.entries(filters).filter(([_, v]) => v !== '')
      );
      const response = await getTransactions(nonEmptyFilters);
      setTransactions(response.data);
    } catch (err) {
      setError('Failed to fetch transactions.');
    } finally {
      setLoading(false);
    }
  }, [filters]); // Dependency on filters

  useEffect(() => {
    fetchTransactions();
  }, [fetchTransactions]); // Run when fetchTransactions function changes

  const handleFilterChange = (e) => setFilters({ ...filters, [e.target.name]: e.target.value });
  const handleFilterSubmit = (e) => { e.preventDefault(); fetchTransactions(); };

  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-graph-up" /> Transaction Reports</h1>
        </div>
      </div>
      <Card className="p-3 mb-4">
        <Form onSubmit={handleFilterSubmit}>
          <Row className="align-items-end">
            <Col md={3}><Form.Group><Form.Label>Start Date</Form.Label><Form.Control type="date" name="timestamp__gte" value={filters.timestamp__gte} onChange={handleFilterChange} /></Form.Group></Col>
            <Col md={3}><Form.Group><Form.Label>End Date</Form.Label><Form.Control type="date" name="timestamp__lte" value={filters.timestamp__lte} onChange={handleFilterChange} /></Form.Group></Col>
            <Col md={3}><Form.Group><Form.Label>Transaction Type</Form.Label><Form.Select name="transaction_type" value={filters.transaction_type} onChange={handleFilterChange}><option value="">All</option><option value="Purchase">Purchase</option><option value="Sale">Sale</option><option value="Adjustment">Adjustment</option></Form.Select></Form.Group></Col>
            <Col md={3} className="d-flex gap-2">
              <Button type="submit" className="w-100">Filter</Button>
              <CSVLink
                data={transactions}
                headers={csvHeaders}
                filename={`inventory-report-${new Date().toISOString().slice(0, 10)}.csv`}
                className="btn btn-success w-100"
                target="_blank"
              >
                Export
              </CSVLink>
            </Col>
          </Row>
        </Form>
      </Card>

      {loading ? (<div className="text-center"><Spinner animation="border" /></div>) : 
       error ? (<Alert variant="danger">{error}</Alert>) : 
      (<Table striped bordered hover responsive>
          <thead><tr><th>Date</th><th>Product</th><th>Type</th><th>Qty Change</th><th>Reason</th></tr></thead>
          <tbody>
            {transactions.map((tx) => (
              <tr key={tx.id}>
                <td>{new Date(tx.timestamp).toLocaleString()}</td>
                <td>{tx.product.name}</td>
                <td>{tx.transaction_type}</td>
                <td className={tx.quantity_change > 0 ? 'text-success' : 'text-danger'}>
                  <strong>{tx.quantity_change > 0 ? `+${tx.quantity_change}` : tx.quantity_change}</strong>
                </td>
                <td>{tx.reason}</td>
              </tr>
            ))}
          </tbody>
        </Table>
      )}
    </Container>
  );
}

export default ReportsPage;
\`\`\`


## frontend_v2/src/pages/RequestPasswordResetPage.js

\`\`\`
import React, { useState } from 'react';
import { Container, Form, Button, Card, Alert } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { requestPasswordReset } from '../services/api'; // Correct path

function RequestPasswordResetPage() {
  const [email, setEmail] = useState('');
  const [message, setMessage] = useState('');
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    setMessage('');
    try {
      await requestPasswordReset(email);
      setMessage('If an account with that email exists, a password reset link has been sent.');
    } catch (err) {
      setError('An error occurred. Please try again.');
    }
  };

  return (
    <Container className="mt-5 d-flex justify-content-center">
      <Card style={{ width: '400px' }}>
        <Card.Body>
          <h2 className="text-center mb-4">Reset Password</h2>
          {message && <Alert variant="success">{message}</Alert>}
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3">
              <Form.Label>Email address</Form.Label>
              <Form.Control
                type="email"
                placeholder="Enter your email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                required
              />
            </Form.Group>
            <div className="d-grid">
              <Button variant="primary" type="submit">
                Send Reset Link
              </Button>
            </div>
          </Form>
        </Card.Body>
        <Card.Footer className="text-center">
          <Link to="/login">Back to Login</Link>
        </Card.Footer>
      </Card>
    </Container>
  );
}

export default RequestPasswordResetPage;
\`\`\`


## frontend_v2/src/pages/SalesOrdersPage.js

\`\`\`
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, Card, Badge } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { getSalesOrders } from '../services/api';
import RoleRequired from '../components/RoleRequired';
import TableToolbar from '../components/ui/TableToolbar';
import PaginationBar from '../components/ui/PaginationBar';
import EmptyState from '../components/ui/EmptyState';

function SalesOrdersPage() {
  const [salesOrders, setSalesOrders] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [search, setSearch] = useState('');
  const [page, setPage] = useState(1);
  const [pageSize, setPageSize] = useState(10);

  const handlePrintInvoice = (orderId) => {
    // This function now simply opens the new invoice page in a new tab
    window.open(`/sales-orders/${orderId}/invoice`, '_blank');
  };
  
  useEffect(() => {
    const fetchSalesOrders = async () => {
      try {
        const response = await getSalesOrders();
        setSalesOrders(response.data);
      } catch (err) {
        setError('Failed to fetch sales orders.');
      } finally {
        setLoading(false);
      }
    };
    fetchSalesOrders();
  }, []);

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error}</Alert></Container>;

  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-receipt" /> Sales Orders</h1>
          <RoleRequired allowedRoles={['Admin', 'Manager']}>
<Button as={Link} to="/sales-orders/create" variant="primary"><i className="bi bi-plus-lg me-1" /> Create Sales Order</Button>
          </RoleRequired>
        </div>
      </div>
      <TableToolbar search={search} onSearchChange={(q)=>{setSearch(q); setPage(1);}} actions={null} />

      {salesOrders.length === 0 ? (
        <EmptyState title="No sales orders" description="Create a sales order to get started." action={
          <RoleRequired allowedRoles={['Admin', 'Manager']}>
            <Button as={Link} to="/sales-orders/create" variant="primary">Create Sales Order</Button>
          </RoleRequired>
        } />
      ) : (
        <>
          {salesOrders
            .filter(o => (`SO-${o.id} ${o.customer_name ?? ''} ${o.status}`.toLowerCase().includes(search.toLowerCase())))
            .slice((page-1)*pageSize, (page-1)*pageSize + pageSize)
            .map((order) => (
            <Card className="mb-3" key={order.id}>
              <Card.Header as="h5" className="d-flex justify-content-between align-items-center">
                 <span>SO-{order.id} | Customer: {order.customer_name || 'N/A'}</span>
                 <Badge bg={order.status === 'Fulfilled' ? 'success' : 'warning'}>{order.status}</Badge>
              </Card.Header>
              <Card.Body>
                <Card.Text><strong>Order Date:</strong> {new Date(order.order_date).toLocaleDateString()}</Card.Text>
                <h6>Items:</h6>
                <div className="table-scroll">
                  <Table striped hover size="sm" className="table-sticky">
                    <thead><tr><th>Product</th><th>Quantity</th><th>Unit Price</th></tr></thead>
                    <tbody>
                      {order.items.map((item) => (
                        <tr key={item.id}>
                          <td>{item.product.name} ({item.product.sku})</td>
                          <td>{item.quantity}</td>
                          <td>â‚¹{item.unit_price}</td>
                        </tr>
                      ))}
                    </tbody>
                  </Table>
                </div>
              </Card.Body>
              <Card.Footer className="text-end">
                <Button variant="outline-secondary" onClick={() => handlePrintInvoice(order.id)}>
                    View Printable Invoice
                </Button>
              </Card.Footer>
            </Card>
          ))}
          <PaginationBar
            page={page}
            pageSize={pageSize}
            total={salesOrders.filter(o => (`SO-${o.id} ${o.customer_name ?? ''} ${o.status}`.toLowerCase().includes(search.toLowerCase()))).length}
            onPageChange={setPage}
            onPageSizeChange={(s)=>{setPageSize(s); setPage(1);}}
          />
        </>
      )}
    </Container>
  );
}

export default SalesOrdersPage;
\`\`\`


## frontend_v2/src/pages/SuppliersPage.js

\`\`\`
// src/pages/SuppliersPage.js
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, ButtonGroup } from 'react-bootstrap';
import { getSuppliers, createSupplier, updateSupplier, deleteSupplier } from '../services/api';
import SupplierFormModal from '../components/SupplierFormModal';
import TableToolbar from '../components/ui/TableToolbar';
import PaginationBar from '../components/ui/PaginationBar';
import EmptyState from '../components/ui/EmptyState';
import { useToast } from '../components/ui/ToastProvider';

function SuppliersPage() {
  const [suppliers, setSuppliers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [showModal, setShowModal] = useState(false);
  const [selectedSupplier, setSelectedSupplier] = useState(null);
  const [search, setSearch] = useState('');
  const { showToast } = useToast();
  const [page, setPage] = useState(1);
  const [pageSize, setPageSize] = useState(10);

  const fetchSuppliers = async () => {
    try { setLoading(true); const response = await getSuppliers(); setSuppliers(response.data); setError(''); } 
    catch (err) { setError('Failed to fetch suppliers.'); console.error(err); } 
    finally { setLoading(false); }
  };

  useEffect(() => { fetchSuppliers(); }, []);

  const handleShowCreateModal = () => { setSelectedSupplier(null); setShowModal(true); };
  const handleShowEditModal = (supplier) => { setSelectedSupplier(supplier); setShowModal(true); };
  const handleCloseModal = () => { setShowModal(false); setSelectedSupplier(null); };

  const handleSave = async (formData) => {
    try {
      if (selectedSupplier) { await updateSupplier(selectedSupplier.id, formData); showToast({ variant: 'success', message: 'Supplier updated' }); } 
      else { await createSupplier(formData); showToast({ variant: 'success', message: 'Supplier created' }); }
      fetchSuppliers(); handleCloseModal();
    } catch (err) { setError(selectedSupplier ? 'Failed to update supplier.' : 'Failed to create supplier.'); showToast({ variant: 'danger', message: 'Action failed' }); }
  };

  const handleDelete = async (id) => {
    if (window.confirm('Are you sure?')) {
      try { await deleteSupplier(id); fetchSuppliers(); } 
      catch (err) { setError('Failed to delete supplier.'); }
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

  return (
    <Container>
      <div className="my-3">
        <div className="page-header d-flex justify-content-between align-items-center">
<h1 className="mb-0"><i className="bi bi-people" /> Suppliers</h1>
<Button variant="primary" onClick={handleShowCreateModal}><i className="bi bi-plus-lg me-1" /> Create Supplier</Button>
        </div>
      </div>
      {error && <Alert variant="danger" className="mb-3">{error}</Alert>}
      <TableToolbar search={search} onSearchChange={(q)=>{setSearch(q); setPage(1);}} actions={null} />
      {suppliers.length === 0 ? (
        <EmptyState title="No suppliers" description="Create your first supplier to get started." action={<Button variant="primary" onClick={handleShowCreateModal}>Create Supplier</Button>} />
      ) : (
        <>
          <div className="table-scroll">
            <Table striped hover size="sm" className="table-sticky" responsive>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Phone</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {suppliers
                  .filter(s => [s.name, s.email, s.phone].join(' ').toLowerCase().includes(search.toLowerCase()))
                  .slice((page-1)*pageSize, (page-1)*pageSize + pageSize)
                  .map((supplier) => (
                  <tr key={supplier.id}>
                    <td>{supplier.name}</td>
                    <td>{supplier.email}</td>
                    <td>{supplier.phone}</td>
                    <td>
                      <ButtonGroup>
<Button variant="outline-secondary" size="sm" onClick={() => handleShowEditModal(supplier)}><i className="bi bi-pencil me-1" /> Edit</Button>
<Button variant="outline-danger" size="sm" onClick={() => handleDelete(supplier.id)}><i className="bi bi-trash me-1" /> Delete</Button>
                      </ButtonGroup>
                    </td>
                  </tr>
                ))}
              </tbody>
            </Table>
          </div>
          <PaginationBar
            page={page}
            pageSize={pageSize}
            total={suppliers.filter(s => [s.name, s.email, s.phone].join(' ').toLowerCase().includes(search.toLowerCase())).length}
            onPageChange={setPage}
            onPageSizeChange={(s)=>{setPageSize(s); setPage(1);}}
          />
        </>
      )}
      <SupplierFormModal show={showModal} handleClose={handleCloseModal} supplier={selectedSupplier} onSave={handleSave} />
    </Container>
  );
}

export default SuppliersPage;
\`\`\`


## frontend_v2/src/reportWebVitals.js

\`\`\`
const reportWebVitals = onPerfEntry => {
  if (onPerfEntry && onPerfEntry instanceof Function) {
    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(onPerfEntry);
      getFID(onPerfEntry);
      getFCP(onPerfEntry);
      getLCP(onPerfEntry);
      getTTFB(onPerfEntry);
    });
  }
};

export default reportWebVitals;

\`\`\`


## frontend_v2/src/services/api.js

\`\`\`
// import axios from 'axios';

// const api = axios.create({ baseURL: 'http://127.0.0.1:8000/api' });

// // --- Auth ---
// export const loginUser = (username, password) => api.post('/token/', { username, password });
// export const registerUser = (userData) => api.post('/register/', userData);

// // --- Products ---
// export const getProducts = () => api.get('/products/');
// export const createProduct = (product) => api.post('/products/', product);
// export const updateProduct = (id, product) => api.put(`/products/${id}/`, product);
// export const deleteProduct = (id) => api.delete(`/products/${id}/`);

// // --- Suppliers ---
// export const getSuppliers = () => api.get('/suppliers/');
// export const createSupplier = (supplier) => api.post('/suppliers/', supplier);
// export const updateSupplier = (id, supplier) => api.put(`/suppliers/${id}/`, supplier);
// export const deleteSupplier = (id) => api.delete(`/suppliers/${id}/`);

// // --- Purchase Orders ---
// export const getPurchaseOrders = () => api.get('/purchase-orders/');
// export const createPurchaseOrder = (orderData) => api.post('/purchase-orders/', orderData);
// export const receivePurchaseOrder = (id) => api.post(`/purchase-orders/${id}/receive/`);

// // --- Sales Orders ---
// export const getSalesOrders = () => api.get('/sales-orders/');
// export const createSalesOrder = (orderData) => api.post('/sales-orders/', orderData);

// // --- Transactions & Dashboard ---
// export const getTransactions = (params) => api.get('/transactions/', { params });
// export const getDashboardStats = () => api.get('/dashboard-stats/');


// export default api;

// src/api/index.js
import axios from 'axios';

// Create a new Axios instance
const api = axios.create({
  baseURL: 'http://127.0.0.1:8000/api',
});

// Use an interceptor to automatically add the auth token to every request
api.interceptors.request.use(
  (config) => {
    const authTokens = localStorage.getItem('authTokens');
    if (authTokens) {
      const token = JSON.parse(authTokens).access;
      config.headers['Authorization'] = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// --- Auth ---
export const loginUser = (username, password) => api.post('/token/', { username, password });
export const registerUser = (userData) => api.post('/register/', userData);

// --- Profile Management ---
export const getUserProfile = () => api.get('/users/me/');
export const updateUserProfile = (userData) => api.patch('/users/me/', userData);
export const changePassword = (passwordData) => api.put('/change-password/', passwordData);

// --- Products ---
export const getProducts = () => api.get('/products/');
export const createProduct = (product) => api.post('/products/', product);
export const updateProduct = (id, product) => api.put(`/products/${id}/`, product);
export const deleteProduct = (id) => api.delete(`/products/${id}/`);

// --- Suppliers ---
export const getSuppliers = () => api.get('/suppliers/');
export const createSupplier = (supplier) => api.post('/suppliers/', supplier);
export const updateSupplier = (id, supplier) => api.put(`/suppliers/${id}/`, supplier);
export const deleteSupplier = (id) => api.delete(`/suppliers/${id}/`);

// --- Purchase Orders ---
export const getPurchaseOrders = () => api.get('/purchase-orders/');
export const createPurchaseOrder = (orderData) => api.post('/purchase-orders/', orderData);
export const receivePurchaseOrder = (id) => api.post(`/purchase-orders/${id}/receive/`);

// --- Sales Orders ---
export const getSalesOrders = () => api.get('/sales-orders/');
export const createSalesOrder = (orderData) => api.post('/sales-orders/', orderData);

// --- Dashboard & Reports ---
export const getDashboardStats = () => api.get('/dashboard-stats/');
export const getTransactions = (params) => api.get('/transactions/', { params });




export const requestPasswordReset = (email) => api.post('/password_reset/', { email });
export const confirmPasswordReset = (token, password) => api.post('/password_reset/confirm/', { token, password });



export default api;
\`\`\`


## frontend_v2/src/setupTests.js

\`\`\`
// jest-dom adds custom jest matchers for asserting on DOM nodes.
// allows you to do things like:
// expect(element).toHaveTextContent(/react/i)
// learn more: https://github.com/testing-library/jest-dom
import '@testing-library/jest-dom';

\`\`\`


## frontend_v2/src/styles/theme.css

\`\`\`
/* src/styles/theme.css */
:root {
  --sidebar-bg: #f8f9fa;
  --sidebar-border: #e9ecef;
  --content-bg: #f5f6f8;
}

html, body, #root { height: 100%; }
body { background: linear-gradient(180deg, #f7f9fc 0%, #f5f6f8 40%, #f3f4f7 100%); }

/* Navbar glass effect */
.app-navbar { background: rgba(255,255,255,0.85) !important; backdrop-filter: saturate(180%) blur(12px); border-bottom: 1px solid var(--sidebar-border); box-shadow: 0 2px 10px rgba(16,24,40,.04); }

/* Page fade-in */
.page { animation: fadeIn .2s ease-in; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

/* Auth pages */
.auth-page { min-height: calc(100vh - 56px); display: grid; place-items: center; }
.auth-card { width: 100%; max-width: 420px; box-shadow: 0 10px 30px rgba(0,0,0,0.06); }

.app-shell {
  min-height: 100vh;
  display: flex;
}

.app-sidebar {
  position: fixed;
  inset: 56px auto 0 0; /* below navbar (approx height) */
  width: 240px;
  background: var(--sidebar-bg);
  border-right: 1px solid var(--sidebar-border);
  transform: translateX(-100%);
  transition: transform 0.2s ease-in-out;
  z-index: 1030; /* below navbar (1040) */
}
.app-sidebar.open { transform: translateX(0); }

@media (min-width: 768px) {
  .app-sidebar {
    transform: none;
    inset: 0 auto 0 0;
  }
}

.sidebar-inner { padding: 1rem 0.5rem; height: 100%; overflow-y: auto; }
.sidebar-brand { font-weight: 600; padding: 0.5rem 1rem; }
.sidebar-inner .nav-link { padding: 0.5rem 1rem; border-radius: 0.375rem; margin: 0.125rem 0.5rem; }
.sidebar-inner .nav-link.active { background: #e9ecef; }

.app-content { flex: 1; margin-left: 0; width: 100%; }
@media (min-width: 768px) {
  .app-content { margin-left: 240px; }
}

/* Improve tables and cards spacing */
.table { background: #fff; }
.card { box-shadow: 0 1px 2px rgba(0,0,0,0.06); border: 1px solid #eef0f3; }
.card:hover { box-shadow: 0 6px 20px rgba(16,24,40,.06); transition: box-shadow .2s ease, transform .2s ease; transform: translateY(-1px); }

/* Subtle pill badges */
.badge { border-radius: 999px; padding: .35rem .6rem; }

/* Page headers */
.container > h1 { font-size: 1.75rem; font-weight: 600; }

/* Enhanced page header */
.page-header h1 { font-size: 1.5rem; font-weight: 700; display: flex; align-items: center; gap: .5rem; }
.page-header h1 .bi { opacity: .9; }
.page-header { border-bottom: 1px solid var(--sidebar-border); padding-bottom: .75rem; }

\`\`\`


## frontend/package.json

\`\`\`
{
  "name": "frontend",
  "version": "0.1.0",
  "private": true,
  "dependencies": {
    "@testing-library/dom": "^10.4.1",
    "@testing-library/jest-dom": "^6.7.0",
    "@testing-library/react": "^16.3.0",
    "@testing-library/user-event": "^13.5.0",
    "axios": "^1.11.0",
    "bootstrap": "^5.3.7",
    "jwt-decode": "^4.0.0",
    "react": "^19.1.1",
    "react-bootstrap": "^2.10.10",
    "react-csv": "^2.2.2",
    "react-dom": "^19.1.1",
    "react-router-dom": "^7.8.0",
    "react-scripts": "5.0.1",
    "react-to-print": "^3.1.1",
    "web-vitals": "^2.1.4"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject"
  },
  "eslintConfig": {
    "extends": [
      "react-app",
      "react-app/jest"
    ]
  },
  "browserslist": {
    "production": [
      ">0.2%",
      "not dead",
      "not op_mini all"
    ],
    "development": [
      "last 1 chrome version",
      "last 1 firefox version",
      "last 1 safari version"
    ]
  }
}

\`\`\`


## frontend/public/index.html

\`\`\`
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <title>React App</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
  </body>
</html>

\`\`\`


## frontend/src/App.css

\`\`\`
.App {
  text-align: center;
}

.App-logo {
  height: 40vmin;
  pointer-events: none;
}

@media (prefers-reduced-motion: no-preference) {
  .App-logo {
    animation: App-logo-spin infinite 20s linear;
  }
}

.App-header {
  background-color: #282c34;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
  color: white;
}

.App-link {
  color: #61dafb;
}

@keyframes App-logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

\`\`\`


## frontend/src/App.js

\`\`\`
import { BrowserRouter as Router, Routes, Route } from 'react-router-dom';
import { AuthProvider } from './context/AuthContext';
import ProtectedRoute from './components/ProtectedRoute';
import Layout from './components/layout/Layout';
import LoginPage from './pages/LoginPage';
import RegisterPage from './pages/RegisterPage';
import DashboardPage from './pages/DashboardPage';
import ProductsPage from './pages/ProductsPage';
import SuppliersPage from './pages/SuppliersPage';
import PurchaseOrdersPage from './pages/PurchaseOrdersPage';
import CreatePurchaseOrderPage from './pages/CreatePurchaseOrderPage';
import SalesOrdersPage from './pages/SalesOrdersPage';
import CreateSalesOrderPage from './pages/CreateSalesOrderPage';
import ReportsPage from './pages/ReportsPage';
import ProfilePage from './pages/ProfilePage';
import RequestPasswordResetPage from './pages/RequestPasswordResetPage'; 
import ConfirmPasswordResetPage from './pages/ConfirmPasswordResetPage'; 
import InvoicePage from './pages/InvoicePage'; // Import the new page


function App() {
  return (
    <AuthProvider>
      <Router>
        <Routes>
          {/* Public Routes */}
          <Route path="/login" element={<LoginPage />} />
          <Route path="/register" element={<RegisterPage />} />
          <Route path="/forgot-password" element={<RequestPasswordResetPage />} />
          <Route path="/reset-password/:token" element={<ConfirmPasswordResetPage />} />
                    <Route path="/sales-orders/:id/invoice" element={<ProtectedRoute><InvoicePage /></ProtectedRoute>} />

          {/* Protected Routes */}
          <Route path="/" element={<ProtectedRoute><Layout /></ProtectedRoute>}>
            <Route index element={<DashboardPage />} />
            <Route path="products" element={<ProductsPage />} />
            <Route path="suppliers" element={<SuppliersPage />} />
            <Route path="purchase-orders" element={<PurchaseOrdersPage />} />
            <Route path="purchase-orders/create" element={<CreatePurchaseOrderPage />} />
            <Route path="sales-orders" element={<SalesOrdersPage />} />
            <Route path="sales-orders/create" element={<CreateSalesOrderPage />} />
            <Route path="reports" element={<ReportsPage />} />
            <Route path="profile" element={<ProfilePage />} />
          </Route>
        </Routes>
      </Router>
    </AuthProvider>
  );
}

export default App;
\`\`\`


## frontend/src/App.test.js

\`\`\`
import { render, screen } from '@testing-library/react';
import App from './App';

test('renders learn react link', () => {
  render(<App />);
  const linkElement = screen.getByText(/learn react/i);
  expect(linkElement).toBeInTheDocument();
});

\`\`\`


## frontend/src/components/AuthenticatedImage.js

\`\`\`
import React, { useState, useEffect } from 'react';

/**
 * A component to display an image from a protected API endpoint.
 * It fetches the image data as a blob using an authenticated API call
 * and then renders it, handling loading, error, and memory cleanup.
 * @param {object} props
 * @param {() => Promise<any>} props.fetchImage - The async function that fetches the image.
 * @param {string} props.alt - The alt text for the image.
 * @param {object} props.style - The style object for the image tag.
 */
function AuthenticatedImage({ fetchImage, alt, style }) {
  const [imageSrc, setImageSrc] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(false);

  useEffect(() => {
    // A flag to prevent state updates if the component unmounts during the fetch
    let isMounted = true;
    // We store the object URL here so the cleanup function can access it
    let objectUrl = null;

    const loadImage = async () => {
      try {
        const response = await fetchImage();
        objectUrl = URL.createObjectURL(response.data);
        if (isMounted) {
          setImageSrc(objectUrl);
        }
      } catch (err) {
        console.error("Failed to load authenticated image:", err);
        if (isMounted) {
          setError(true);
        }
      } finally {
        if (isMounted) {
          setLoading(false);
        }
      }
    };

    loadImage();

    // This is the cleanup function that runs when the component is removed
    return () => {
      isMounted = false;
      // If the object URL was created, we revoke it to free up browser memory
      if (objectUrl) {
        URL.revokeObjectURL(objectUrl);
      }
    };
  }, [fetchImage]); // The effect re-runs if the fetchImage function changes

  if (loading) {
    return <span>Loading...</span>;
  }

  if (error || !imageSrc) {
    return <span>Error</span>;
  }
  
  return <img src={imageSrc} alt={alt} style={style} />;
}

export default AuthenticatedImage;
\`\`\`


## frontend/src/components/Invoice.css

\`\`\`
/* This class will be applied to the main container of our printable page */
.invoice-container {
    padding: 2rem;
}

/* @media print is a special CSS rule that only applies when printing */
@media print {
    /* Hide everything in the body by default when printing */
    body * {
        visibility: hidden;
    }

    /* Then, make the invoice container and everything inside it visible */
    .invoice-container, .invoice-container * {
        visibility: visible;
    }

    /* Position the invoice at the top of the print page */
    .invoice-container {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
    }
}
\`\`\`


## frontend/src/components/InvoiceComponent.js

\`\`\`
import React from 'react';
import { Table, Row, Col, Container } from 'react-bootstrap';

const InvoiceComponent = React.forwardRef(({ order }, ref) => {
  if (!order) {
    return null;
  }

  const subtotal = order.items.reduce((acc, item) => acc + (item.quantity * item.unit_price), 0);
  const taxRate = 0.08;
  const tax = subtotal * taxRate;
  const total = subtotal + tax;

  return (
    <div ref={ref} className="p-5">
      <Container>
        <Row className="mb-4 align-items-center">
          <Col>
            <h1 className="mb-0">INVOICE</h1>
            <p className="text-muted">Your Company Name</p>
          </Col>
          <Col className="text-end">
            <p className="mb-0"><strong>Order #:</strong> SO-{order.id}</p>
            <p className="mb-0"><strong>Date:</strong> {new Date(order.order_date).toLocaleDateString()}</p>
          </Col>
        </Row>
        <hr />
        <Row className="mb-4">
          <Col>
            <strong>Bill To:</strong>
            <p className="mb-0">{order.customer_name || 'Valued Customer'}</p>
          </Col>
        </Row>
        <Table striped bordered hover responsive>
          <thead>
            <tr>
              <th>Product</th>
              <th>SKU</th>
              <th>Quantity</th>
              <th>Unit Price</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            {order.items.map((item) => (
              <tr key={item.id}>
                <td>{item.product.name}</td>
                <td>{item.product.sku}</td>
                <td>{item.quantity}</td>
                <td>â‚¹{parseFloat(item.unit_price).toFixed(2)}</td>
                <td>â‚¹{(item.quantity * item.unit_price).toFixed(2)}</td>
              </tr>
            ))}
          </tbody>
        </Table>
        <Row className="mt-4 justify-content-end">
          <Col md={4}>
            <Table borderless size="sm">
              <tbody>
                <tr>
                  <td><strong>Subtotal:</strong></td>
                  <td className="text-end">â‚¹{subtotal.toFixed(2)}</td>
                </tr>
                <tr>
                  <td><strong>Tax ({(taxRate * 100).toFixed(0)}%):</strong></td>
                  <td className="text-end">â‚¹{tax.toFixed(2)}</td>
                </tr>
                <tr className="border-top">
                  <td className="pt-2"><strong>Total:</strong></td>
                  <td className="text-end pt-2"><strong>â‚¹{total.toFixed(2)}</strong></td>
                </tr>
              </tbody>
            </Table>
          </Col>
        </Row>
      </Container>
    </div>
  );
});

export default InvoiceComponent;
\`\`\`


## frontend/src/components/layout/AppNavbar.js

\`\`\`
import React from 'react';
import { Navbar, Nav, Container, NavDropdown } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';

function AppNavbar() {
  const { user, logoutUser } = useAuth();
  return (
    <Navbar bg="dark" variant="dark" expand="lg">
      <Container>
        <Navbar.Brand as={Link} to="/">Inventory System</Navbar.Brand>
        <Nav className="me-auto">
          <Nav.Link as={Link} to="/">Dashboard</Nav.Link>
          <Nav.Link as={Link} to="/products">Products</Nav.Link>
          <Nav.Link as={Link} to="/suppliers">Suppliers</Nav.Link>
          <Nav.Link as={Link} to="/purchase-orders">Purchase Orders</Nav.Link>
          <Nav.Link as={Link} to="/sales-orders">Sales Orders</Nav.Link>
          <Nav.Link as={Link} to="/reports">Reports</Nav.Link>
        </Nav>
        <Nav>
          {user && (
            <NavDropdown title={user.username} id="basic-nav-dropdown">
              <NavDropdown.Item as={Link} to="/profile">Profile</NavDropdown.Item>
              <NavDropdown.Divider />
              <NavDropdown.Item onClick={logoutUser}>Logout</NavDropdown.Item>
            </NavDropdown>
          )}
        </Nav>
      </Container>
    </Navbar>
  );
}
export default AppNavbar;
\`\`\`


## frontend/src/components/layout/Layout.js

\`\`\`
// src/components/layout/Layout.js
import React from 'react';
import { Outlet } from 'react-router-dom';
import AppNavbar from './AppNavbar';

function Layout() {
  return (
    <div>
      <AppNavbar />
      <main className="py-4">
        <Outlet />
      </main>
    </div>
  );
}
export default Layout;
\`\`\`


## frontend/src/components/ProductFormModal.js

\`\`\`
// src/components/ProductFormModal.js
import React, { useState, useEffect } from 'react';
import { Modal, Button, Form } from 'react-bootstrap';

function ProductFormModal({ show, handleClose, product, onSave }) {
  const [formData, setFormData] = useState({});

  useEffect(() => {
    if (product) {
      setFormData(product);
    } else {
      setFormData({ name: '', sku: '', category: '', unit_price: '', stock_quantity: '', min_stock_level: '' });
    }
  }, [product, show]);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData({ ...formData, [name]: value });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    onSave(formData);
  };

  return (
    <Modal show={show} onHide={handleClose}>
      <Modal.Header closeButton><Modal.Title>{product ? 'Edit Product' : 'Create Product'}</Modal.Title></Modal.Header>
      <Form onSubmit={handleSubmit}>
        <Modal.Body>
          <Form.Group className="mb-3"><Form.Label>Name</Form.Label><Form.Control type="text" name="name" value={formData.name || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>SKU</Form.Label><Form.Control type="text" name="sku" value={formData.sku || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Category</Form.Label><Form.Control type="text" name="category" value={formData.category || ''} onChange={handleChange} /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Unit Price</Form.Label><Form.Control type="number" name="unit_price" value={formData.unit_price || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Stock Quantity</Form.Label><Form.Control type="number" name="stock_quantity" value={formData.stock_quantity || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Minimum Stock Level</Form.Label><Form.Control type="number" name="min_stock_level" value={formData.min_stock_level || ''} onChange={handleChange} required /></Form.Group>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="secondary" onClick={handleClose}>Close</Button>
          <Button variant="primary" type="submit">Save Changes</Button>
        </Modal.Footer>
      </Form>
    </Modal>
  );
}

export default ProductFormModal;
\`\`\`


## frontend/src/components/ProtectedRoute.js

\`\`\`
// src/components/ProtectedRoute.js
import React from 'react';
import { Navigate } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';

function ProtectedRoute({ children }) {
  const { user } = useAuth();
  if (!user) {
    return <Navigate to="/login" />;
  }
  return children;
}

export default ProtectedRoute;
\`\`\`


## frontend/src/components/RoleRequired.js

\`\`\`
// src/components/RoleRequired.js
import { useAuth } from '../context/AuthContext';

function RoleRequired({ allowedRoles, children }) {
  const { user } = useAuth();

  if (user && allowedRoles.includes(user.role)) {
    return <>{children}</>;
  }

  return null;
}

export default RoleRequired;
\`\`\`


## frontend/src/components/SupplierFormModal.js

\`\`\`
// src/components/SupplierFormModal.js
import React, { useState, useEffect } from 'react';
import { Modal, Button, Form } from 'react-bootstrap';

function SupplierFormModal({ show, handleClose, supplier, onSave }) {
  const [formData, setFormData] = useState({});

  useEffect(() => {
    if (supplier) {
      setFormData(supplier);
    } else {
      setFormData({ name: '', email: '', phone: '', contact_info: '' });
    }
  }, [supplier, show]);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData({ ...formData, [name]: value });
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    onSave(formData);
  };

  return (
    <Modal show={show} onHide={handleClose}>
      <Modal.Header closeButton><Modal.Title>{supplier ? 'Edit Supplier' : 'Create Supplier'}</Modal.Title></Modal.Header>
      <Form onSubmit={handleSubmit}>
        <Modal.Body>
          <Form.Group className="mb-3"><Form.Label>Name</Form.Label><Form.Control type="text" name="name" value={formData.name || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Email</Form.Label><Form.Control type="email" name="email" value={formData.email || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Phone</Form.Label><Form.Control type="text" name="phone" value={formData.phone || ''} onChange={handleChange} required /></Form.Group>
          <Form.Group className="mb-3"><Form.Label>Contact Info (Address)</Form.Label><Form.Control as="textarea" rows={3} name="contact_info" value={formData.contact_info || ''} onChange={handleChange} /></Form.Group>
        </Modal.Body>
        <Modal.Footer>
          <Button variant="secondary" onClick={handleClose}>Close</Button>
          <Button variant="primary" type="submit">Save Changes</Button>
        </Modal.Footer>
      </Form>
    </Modal>
  );
}

export default SupplierFormModal;

\`\`\`


## frontend/src/context/AuthContext.js

\`\`\`
// src/context/AuthContext.js
import React, { createContext, useState, useContext, useEffect } from 'react';
import { jwtDecode } from 'jwt-decode';
// Note: We no longer need to import 'api' here

const AuthContext = createContext(null);

export const AuthProvider = ({ children }) => {
  const [tokens, setTokens] = useState(() => 
    localStorage.getItem('authTokens') 
      ? JSON.parse(localStorage.getItem('authTokens')) 
      : null
  );
  
  const [user, setUser] = useState(() => 
    localStorage.getItem('authTokens') 
      ? jwtDecode(JSON.parse(localStorage.getItem('authTokens')).access) 
      : null
  );

  const loginUser = (newTokens) => {
    setTokens(newTokens);
    setUser(jwtDecode(newTokens.access));
    localStorage.setItem('authTokens', JSON.stringify(newTokens));
  };

  const logoutUser = () => {
    setTokens(null);
    setUser(null);
    localStorage.removeItem('authTokens');
  };
  
  // The useEffect that set the api header is no longer needed.
  
  const contextData = {
    user,
    tokens,
    loginUser,
    logoutUser,
  };
  
  return (
    <AuthContext.Provider value={contextData}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  return useContext(AuthContext);
};
\`\`\`


## frontend/src/index.css

\`\`\`
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

\`\`\`


## frontend/src/index.js

\`\`\`
// src/index.js
import 'bootstrap/dist/css/bootstrap.min.css';
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
\`\`\`


## frontend/src/pages/ConfirmPasswordResetPage.js

\`\`\`
import React, { useState } from 'react';
import { Container, Form, Button, Card, Alert } from 'react-bootstrap';
import { useParams, useNavigate, Link } from 'react-router-dom';
import { confirmPasswordReset } from '../services/api'; // Correct path

function ConfirmPasswordResetPage() {
  const [password, setPassword] = useState('');
  const [password2, setPassword2] = useState('');
  const [message, setMessage] = useState('');
  const [error, setError] = useState('');
  const { token } = useParams();
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    if (password !== password2) {
      setError('Passwords do not match.');
      return;
    }
    setError('');
    setMessage('');
    try {
      await confirmPasswordReset(token, password);
      setMessage('Your password has been successfully reset! Redirecting to login...');
      setTimeout(() => navigate('/login'), 3000);
    } catch (err) {
      setError('Invalid or expired token. Please request a new password reset.');
    }
  };

  return (
    <Container className="mt-5 d-flex justify-content-center">
      <Card style={{ width: '400px' }}>
        <Card.Body>
          <h2 className="text-center mb-4">Set New Password</h2>
          {message && <Alert variant="success">{message}</Alert>}
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3">
              <Form.Label>New Password</Form.Label>
              <Form.Control type="password" value={password} onChange={(e) => setPassword(e.target.value)} required />
            </Form.Group>
            <Form.Group className="mb-3">
              <Form.Label>Confirm New Password</Form.Label>
              <Form.Control type="password" value={password2} onChange={(e) => setPassword2(e.target.value)} required />
            </Form.Group>
            <div className="d-grid">
              <Button variant="primary" type="submit">
                Reset Password
              </Button>
            </div>
          </Form>
        </Card.Body>
        <Card.Footer className="text-center">
          <Link to="/login">Back to Login</Link>
        </Card.Footer>
      </Card>
    </Container>
  );
}

export default ConfirmPasswordResetPage;
\`\`\`


## frontend/src/pages/CreatePurchaseOrderPage.js

\`\`\`
// src/pages/CreatePurchaseOrderPage.js
import React, { useState, useEffect } from 'react';
import { Container, Form, Button, Table, Row, Col, Card, Spinner, Alert } from 'react-bootstrap';
import { useNavigate } from 'react-router-dom';
import { getSuppliers, getProducts, createPurchaseOrder } from '../services/api';

function CreatePurchaseOrderPage() {
  const [suppliers, setSuppliers] = useState([]);
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [selectedSupplier, setSelectedSupplier] = useState('');
  const [orderItems, setOrderItems] = useState([]);
  const [currentItem, setCurrentItem] = useState({ product: '', quantity: 1, unit_price: '' });
  const navigate = useNavigate();

  useEffect(() => {
    const fetchData = async () => {
      try {
        const [suppliersRes, productsRes] = await Promise.all([getSuppliers(), getProducts()]);
        setSuppliers(suppliersRes.data);
        setProducts(productsRes.data);
      } catch (err) { setError('Failed to load necessary data.'); } 
      finally { setLoading(false); }
    };
    fetchData();
  }, []);

  const handleProductSelect = (productId) => {
    const product = products.find(p => p.id === parseInt(productId));
    if (product) setCurrentItem({ product: productId, quantity: 1, unit_price: product.unit_price });
  };

  const handleAddItem = () => {
    if (!currentItem.product || currentItem.quantity <= 0) return;
    const product = products.find(p => p.id === parseInt(currentItem.product));
    setOrderItems([...orderItems, { ...currentItem, productName: product.name, sku: product.sku }]);
    setCurrentItem({ product: '', quantity: 1, unit_price: '' });
  };
  
  const handleRemoveItem = (index) => setOrderItems(orderItems.filter((_, i) => i !== index));

  const handleSubmit = async () => {
    if (!selectedSupplier || orderItems.length === 0) {
      alert('Please select a supplier and add at least one item.');
      return;
    }
    const orderData = {
      supplier: selectedSupplier,
      status: 'Pending',
      items: orderItems.map(item => ({ product: item.product, quantity: item.quantity, unit_price: item.unit_price }))
    };
    try {
      await createPurchaseOrder(orderData);
      navigate('/purchase-orders');
    } catch (err) { setError('Failed to create purchase order.'); }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error}</Alert></Container>;

  return (
    <Container>
      <h1 className="my-4">Create Purchase Order</h1>
      <Card className="p-4">
        <Form.Group as={Row} className="mb-3">
          <Form.Label column sm={2}>Supplier</Form.Label>
          <Col sm={10}><Form.Select value={selectedSupplier} onChange={(e) => setSelectedSupplier(e.target.value)} required><option value="">Select a Supplier</option>{suppliers.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}</Form.Select></Col>
        </Form.Group>
        <hr />
        <h4 className="mt-4">Add Items</h4>
        <Row className="align-items-end g-3">
            <Col md={5}><Form.Label>Product</Form.Label><Form.Select value={currentItem.product} onChange={(e) => handleProductSelect(e.target.value)}><option value="">Select a Product</option>{products.map(p => <option key={p.id} value={p.id}>{p.name} ({p.sku})</option>)}</Form.Select></Col>
            <Col md={2}><Form.Label>Quantity</Form.Label><Form.Control type="number" value={currentItem.quantity} onChange={(e) => setCurrentItem({...currentItem, quantity: e.target.value})} min="1"/></Col>
            <Col md={3}><Form.Label>Unit Price</Form.Label><Form.Control type="number" value={currentItem.unit_price} onChange={(e) => setCurrentItem({...currentItem, unit_price: e.target.value})} placeholder="Unit Price" /></Col>
            <Col md={2}><Button onClick={handleAddItem} className="w-100">Add Item</Button></Col>
        </Row>
        <h4 className="mt-5">Order Items</h4>
        <Table striped bordered hover>
          <thead><tr><th>Product</th><th>SKU</th><th>Quantity</th><th>Unit Price</th><th>Action</th></tr></thead>
          <tbody>
            {orderItems.map((item, index) => (
              <tr key={index}><td>{item.productName}</td><td>{item.sku}</td><td>{item.quantity}</td><td>${item.unit_price}</td><td><Button variant="danger" size="sm" onClick={() => handleRemoveItem(index)}>Remove</Button></td></tr>
            ))}
          </tbody>
        </Table>
        <div className="mt-4 text-end"><Button variant="success" size="lg" onClick={handleSubmit}>Submit Order</Button></div>
      </Card>
    </Container>
  );
}

export default CreatePurchaseOrderPage;
\`\`\`


## frontend/src/pages/CreateSalesOrderPage.js

\`\`\`
// src/pages/CreateSalesOrderPage.js
import React, { useState, useEffect } from 'react';
import { Container, Form, Button, Table, Row, Col, Card, Spinner, Alert } from 'react-bootstrap';
import { useNavigate } from 'react-router-dom';
import { getProducts, createSalesOrder } from '../services/api';

function CreateSalesOrderPage() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [customerName, setCustomerName] = useState('');
  const [orderItems, setOrderItems] = useState([]);
  const [currentItem, setCurrentItem] = useState({ product: '', quantity: 1, unit_price: '' });
  const navigate = useNavigate();

  useEffect(() => {
    const fetchProducts = async () => {
      try { const productsRes = await getProducts(); setProducts(productsRes.data); } 
      catch (err) { setError('Failed to load products.'); } 
      finally { setLoading(false); }
    };
    fetchProducts();
  }, []);

  const handleProductSelect = (productId) => {
    const product = products.find(p => p.id === parseInt(productId));
    if (product) {
        if (product.stock_quantity > 0) {
            setCurrentItem({ product: productId, quantity: 1, unit_price: product.unit_price });
        } else {
            alert(`${product.name} is out of stock.`);
            setCurrentItem({ product: '', quantity: 1, unit_price: '' });
        }
    }
  };

  const handleAddItem = () => {
    if (!currentItem.product || currentItem.quantity <= 0) return;
    const product = products.find(p => p.id === parseInt(currentItem.product));
    if (currentItem.quantity > product.stock_quantity) {
        alert(`Not enough stock for ${product.name}. Available: ${product.stock_quantity}`);
        return;
    }
    setOrderItems([...orderItems, { ...currentItem, productName: product.name, sku: product.sku }]);
    setCurrentItem({ product: '', quantity: 1, unit_price: '' });
  };
  
  const handleRemoveItem = (index) => setOrderItems(orderItems.filter((_, i) => i !== index));

  const handleSubmit = async () => {
    if (orderItems.length === 0) {
      alert('Please add at least one item.'); return;
    }
    const orderData = {
      customer_name: customerName,
      status: 'Fulfilled',
      items: orderItems.map(item => ({ product: item.product, quantity: item.quantity, unit_price: item.unit_price }))
    };
    try {
      await createSalesOrder(orderData);
      navigate('/sales-orders');
    } catch (err) { setError(err.response?.data?.detail || 'Failed to create sales order.'); }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  
  return (
    <Container>
      <h1 className="my-4">Create Sales Order</h1>
      {error && <Alert variant="danger" onClose={() => setError('')} dismissible>{error}</Alert>}
      <Card className="p-4">
        <Form.Group as={Row} className="mb-3">
          <Form.Label column sm={2}>Customer Name</Form.Label>
          <Col sm={10}><Form.Control type="text" placeholder="Enter customer name" value={customerName} onChange={(e) => setCustomerName(e.target.value)} /></Col>
        </Form.Group>
        <hr />
        <h4 className="mt-4">Add Items</h4>
        <Row className="align-items-end g-3">
            <Col md={5}><Form.Label>Product</Form.Label><Form.Select value={currentItem.product} onChange={(e) => handleProductSelect(e.target.value)}><option value="">Select a Product</option>{products.map(p => <option key={p.id} value={p.id}>{p.name} (In Stock: {p.stock_quantity})</option>)}</Form.Select></Col>
            <Col md={2}><Form.Label>Quantity</Form.Label><Form.Control type="number" value={currentItem.quantity} onChange={(e) => setCurrentItem({...currentItem, quantity: e.target.value})} min="1"/></Col>
            <Col md={3}><Form.Label>Unit Price</Form.Label><Form.Control type="number" value={currentItem.unit_price} onChange={(e) => setCurrentItem({...currentItem, unit_price: e.target.value})} placeholder="Unit Price" /></Col>
            <Col md={2}><Button onClick={handleAddItem} className="w-100">Add Item</Button></Col>
        </Row>
        <h4 className="mt-5">Order Items</h4>
        <Table striped bordered hover>
          <thead><tr><th>Product</th><th>SKU</th><th>Quantity</th><th>Unit Price</th><th>Action</th></tr></thead>
          <tbody>
            {orderItems.map((item, index) => (
              <tr key={index}><td>{item.productName}</td><td>{item.sku}</td><td>{item.quantity}</td><td>${item.unit_price}</td><td><Button variant="danger" size="sm" onClick={() => handleRemoveItem(index)}>Remove</Button></td></tr>
            ))}
          </tbody>
        </Table>
        <div className="mt-4 text-end"><Button variant="success" size="lg" onClick={handleSubmit}>Submit Order</Button></div>
      </Card>
    </Container>
  );
}

export default CreateSalesOrderPage;
\`\`\`


## frontend/src/pages/DashboardPage.js

\`\`\`
// src/pages/DashboardPage.js
import React, { useState, useEffect } from 'react';
import { Container, Row, Col, Card, Spinner, Alert, Table, Badge } from 'react-bootstrap';
import { useAuth } from '../context/AuthContext';
import { getDashboardStats } from '../services/api';

function DashboardPage() {
  const { user } = useAuth();
  const [stats, setStats] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');

  useEffect(() => {
    const fetchStats = async () => {
      try {
        const response = await getDashboardStats();
        setStats(response.data);
      } catch (err) {
        setError('Failed to load dashboard data.');
      } finally {
        setLoading(false);
      }
    };
    fetchStats();
  }, []);

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error}</Alert></Container>;

  return (
    <Container>
      <h1 className="my-4">Dashboard</h1>
      <p>Welcome back, <strong>{user.username}</strong>!</p>
      
      <Row>
        <Col md={4}><Card className="text-center mb-3"><Card.Body><Card.Title>Total Products</Card.Title><Card.Text className="fs-2">{stats?.total_products}</Card.Text></Card.Body></Card></Col>
        <Col md={4}><Card className="text-center mb-3"><Card.Body><Card.Title>Low Stock Items</Card.Title><Card.Text className="fs-2 text-danger">{stats?.low_stock_items.length}</Card.Text></Card.Body></Card></Col>
      </Row>

      <Row>
        <Col md={6}>
          <h4 className="mt-5">Low Stock Alerts</h4>
          <Card>
            <Table responsive striped hover className="mb-0">
              <thead><tr><th>Product</th><th>In Stock</th><th>Min Level</th></tr></thead>
              <tbody>
                {stats?.low_stock_items.length > 0 ? (
                  stats.low_stock_items.map(item => (
                    <tr key={item.id}><td>{item.name}</td><td><Badge bg="danger">{item.stock_quantity}</Badge></td><td>{item.min_stock_level}</td></tr>
                  ))
                ) : ( <tr><td colSpan="3" className="text-center">No items are low on stock.</td></tr> )}
              </tbody>
            </Table>
          </Card>
        </Col>
        <Col md={6}>
          <h4 className="mt-5">Recent Transactions</h4>
          <Card>
            <Table responsive striped hover className="mb-0">
              <thead><tr><th>Product</th><th>Type</th><th>Qty Change</th></tr></thead>
              <tbody>
                {stats?.recent_transactions.length > 0 ? (
                  stats.recent_transactions.map(tx => (
                    <tr key={tx.id}>
                      <td>{tx.product.name}</td>
                      <td><Badge bg={tx.transaction_type === 'Sale' ? 'danger' : 'success'}>{tx.transaction_type}</Badge></td>
                      <td className={tx.quantity_change > 0 ? 'text-success' : 'text-danger'}>
                        {tx.quantity_change > 0 ? `+${tx.quantity_change}` : tx.quantity_change}
                      </td>
                    </tr>
                  ))
                ) : ( <tr><td colSpan="3" className="text-center">No recent transactions.</td></tr> )}
              </tbody>
            </Table>
          </Card>
        </Col>
      </Row>
    </Container>
  );
}

export default DashboardPage;
\`\`\`


## frontend/src/pages/InvoicePage.js

\`\`\`
import React, { useState, useEffect } from 'react';
import { useParams, Link } from 'react-router-dom';
import { Container, Table, Row, Col, Spinner, Alert } from 'react-bootstrap';
import { getSalesOrders } from '../services/api';
import '../components/Invoice.css'; // Import our new CSS file

function InvoicePage() {
  const [order, setOrder] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const { id } = useParams(); // Get the order ID from the URL

  useEffect(() => {
    const fetchOrder = async () => {
      try {
        // We fetch all orders and then find the one we need.
        // In a larger app, you would fetch a single order by its ID.
        const response = await getSalesOrders();
        const currentOrder = response.data.find(o => o.id === parseInt(id));
        if (currentOrder) {
          setOrder(currentOrder);
        } else {
          setError('Invoice not found.');
        }
      } catch (err) {
        setError('Failed to fetch invoice data.');
      } finally {
        setLoading(false);
      }
    };
    fetchOrder();
  }, [id]);

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error} <Link to="/sales-orders">Go back</Link></Alert></Container>;
  if (!order) return null;

  // --- Calculation Logic ---
  const subtotal = order.items.reduce((acc, item) => acc + (item.quantity * item.unit_price), 0);
  const taxRate = 0.08;
  const tax = subtotal * taxRate;
  const total = subtotal + tax;

  return (
    // We apply our special class here
    <div className="invoice-container">
      <Row className="mb-4 align-items-center">
        <Col><h1 className="mb-0">INVOICE</h1><p className="text-muted">Your Company Name</p></Col>
        <Col className="text-end"><p className="mb-0"><strong>Order #:</strong> SO-{order.id}</p><p className="mb-0"><strong>Date:</strong> {new Date(order.order_date).toLocaleDateString()}</p></Col>
      </Row>
      <hr />
      <Row className="mb-4"><Col><strong>Bill To:</strong><p className="mb-0">{order.customer_name || 'Valued Customer'}</p></Col></Row>
      <Table striped bordered hover>
        <thead><tr><th>Product</th><th>SKU</th><th>Quantity</th><th>Unit Price</th><th>Total</th></tr></thead>
        <tbody>
          {order.items.map((item) => (
            <tr key={item.id}>
              <td>{item.product.name}</td><td>{item.product.sku}</td><td>{item.quantity}</td>
              <td>â‚¹{parseFloat(item.unit_price).toFixed(2)}</td>
              <td>â‚¹{(item.quantity * item.unit_price).toFixed(2)}</td>
            </tr>
          ))}
        </tbody>
      </Table>
      <Row className="mt-4 justify-content-end">
        <Col md={4}>
          <Table borderless size="sm">
            <tbody>
              <tr><td><strong>Subtotal:</strong></td><td className="text-end">â‚¹{subtotal.toFixed(2)}</td></tr>
              <tr><td><strong>Tax ({(taxRate * 100).toFixed(0)}%):</strong></td><td className="text-end">â‚¹{tax.toFixed(2)}</td></tr>
              <tr className="border-top"><td className="pt-2"><strong>Total:</strong></td><td className="text-end pt-2"><strong>â‚¹{total.toFixed(2)}</strong></td></tr>
            </tbody>
          </Table>
        </Col>
      </Row>
    </div>
  );
}

export default InvoicePage;
\`\`\`


## frontend/src/pages/LoginPage.js

\`\`\`
import React, { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { loginUser as apiLogin } from '../services/api'; // Correct path
import { useAuth } from '../context/AuthContext'; // Correct path
import { jwtDecode } from 'jwt-decode';
import { Container, Form, Button, Row, Col, Card, Alert } from 'react-bootstrap';

function LoginPage() {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [error, setError] = useState('');
  const { loginUser } = useAuth();
  const navigate = useNavigate();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    try {
      const response = await apiLogin(username, password);
      const { access } = response.data;
      
      loginUser(response.data);
      const decodedUser = jwtDecode(access);

      if (decodedUser.role === 'Admin') {
        window.location.href = 'http://127.0.0.1:8000/admin/';
      } else {
        navigate('/');
      }
    } catch (err) {
      setError('Failed to log in. Please check your credentials.');
      console.error(err);
    }
  };

  return (
    <Container className="mt-5">
      <Row className="justify-content-md-center">
        <Col md={6} lg={4}>
          <Card>
            <Card.Body>
              <h2 className="text-center mb-4">Login</h2>
              {error && <Alert variant="danger">{error}</Alert>}
              <Form onSubmit={handleSubmit}>
                <Form.Group className="mb-3"><Form.Label>Username</Form.Label><Form.Control type="text" placeholder="Enter username" value={username} onChange={(e) => setUsername(e.target.value)} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Password</Form.Label><Form.Control type="password" placeholder="Password" value={password} onChange={(e) => setPassword(e.target.value)} required /></Form.Group>
                <div className="d-grid"><Button variant="primary" type="submit">Log In</Button></div>
              </Form>
            </Card.Body>
            <Card.Footer className="text-center">
              <div>
                Don't have an account? <Link to="/register">Register Here</Link>
              </div>
              <div className="mt-2">
                <Link to="/forgot-password">Forgot Password?</Link>
              </div>
            </Card.Footer>
          </Card>
        </Col>
      </Row>
    </Container>
  );
}

export default LoginPage;
\`\`\`


## frontend/src/pages/ProductsPage.js

\`\`\`
// src/pages/ProductsPage.js
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, ButtonGroup } from 'react-bootstrap';
import { getProducts, createProduct, updateProduct, deleteProduct } from '../services/api';
import ProductFormModal from '../components/ProductFormModal';
import RoleRequired from '../components/RoleRequired';



function ProductsPage() {
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [showModal, setShowModal] = useState(false);
  const [selectedProduct, setSelectedProduct] = useState(null);

  const fetchProducts = async () => {
    try { setLoading(true); const response = await getProducts(); setProducts(response.data); setError(''); } 
    catch (err) { setError('Failed to fetch products.'); console.error(err); } 
    finally { setLoading(false); }
  };

  useEffect(() => { fetchProducts(); }, []);

  const handleShowCreateModal = () => { setSelectedProduct(null); setShowModal(true); };
  const handleShowEditModal = (product) => { setSelectedProduct(product); setShowModal(true); };
  const handleCloseModal = () => { setShowModal(false); setSelectedProduct(null); };

  const handleSave = async (formData) => {
    try {
      if (selectedProduct) { await updateProduct(selectedProduct.id, formData); } 
      else { await createProduct(formData); }
      fetchProducts(); handleCloseModal();
    } catch (err) { setError(selectedProduct ? 'Failed to update product.' : 'Failed to create product.'); }
  };

  const handleDelete = async (id) => {
    if (window.confirm('Are you sure?')) {
      try { await deleteProduct(id); fetchProducts(); } 
      catch (err) { setError('Failed to delete product.'); }
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

//     <Container>
//       <div className="d-flex justify-content-between align-items-center my-4">
//         <h1>Products</h1>
//         <RoleRequired allowedRoles={['Admin', 'Manager']}>
//             <Button variant="primary" onClick={handleShowCreateModal}>Create Product</Button>
//         </RoleRequired>
//       </div>
//       {error && <Alert variant="danger">{error}</Alert>}
//       <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />
//     </Container>

return (
    <Container>
      <div className="d-flex justify-content-between align-items-center my-4">
        <h1>Products</h1>
        <RoleRequired allowedRoles={['Admin', 'Manager']}>
          <Button variant="primary" onClick={handleShowCreateModal}>Create Product</Button>
        </RoleRequired>
      </div>
      
      <Table striped bordered hover responsive>
        <thead>
          <tr>
            <th>SKU</th>
            <th>Name</th>
            <th>Stock</th>
            <RoleRequired allowedRoles={['Admin', 'Manager']}>
                <th>Actions</th>
            </RoleRequired>
          </tr>
        </thead>
        <tbody>
          {products.map((product) => (
            <tr key={product.id}>
              <td>{product.sku}</td>
              <td>{product.name}</td>
              <td>{product.stock_quantity}</td>
              <RoleRequired allowedRoles={['Admin', 'Manager']}>
                <td>
                    <ButtonGroup>
                    <Button variant="outline-secondary" size="sm" onClick={() => handleShowEditModal(product)}>Edit</Button>
                    <Button variant="outline-danger" size="sm" onClick={() => handleDelete(product.id)}>Delete</Button>
                    </ButtonGroup>
                </td>
              </RoleRequired>
            </tr>
          ))}
        </tbody>
      </Table>
      <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />
    </Container>
  );
}

export default ProductsPage;
\`\`\`


## frontend/src/pages/ProfilePage.js

\`\`\`
// src/features/auth/ProfilePage.js
import React, { useState, useEffect } from 'react';
import { Container, Row, Col, Card, Form, Button, Alert, Spinner } from 'react-bootstrap';
import { getUserProfile, updateUserProfile, changePassword } from '../services/api';
import { useAuth } from '../context/AuthContext';

function ProfilePage() {
  const [profile, setProfile] = useState({ username: '', email: '', first_name: '', last_name: '' });
  const [passwordData, setPasswordData] = useState({ old_password: '', new_password: '', new_password2: '' });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  const { logoutUser } = useAuth();

  useEffect(() => {
    const fetchProfile = async () => {
      try {
        const response = await getUserProfile();
        setProfile(response.data);
      } catch (err) {
        setError('Failed to fetch profile data.');
      } finally {
        setLoading(false);
      }
    };
    fetchProfile();
  }, []);

  const handleProfileChange = (e) => setProfile({ ...profile, [e.target.name]: e.target.value });
  const handlePasswordChange = (e) => setPasswordData({ ...passwordData, [e.target.name]: e.target.value });

  const handleProfileSubmit = async (e) => {
    e.preventDefault();
    setError(''); setSuccess('');
    try {
      await updateUserProfile({ first_name: profile.first_name, last_name: profile.last_name, email: profile.email });
      setSuccess('Profile updated successfully!');
    } catch (err) {
      setError('Failed to update profile.');
    }
  };

  const handlePasswordSubmit = async (e) => {
    e.preventDefault();
    setError(''); setSuccess('');
    if (passwordData.new_password !== passwordData.new_password2) {
      setError('New passwords do not match.');
      return;
    }
    try {
      await changePassword(passwordData);
      setSuccess('Password changed successfully! You will be logged out shortly.');
      setTimeout(() => logoutUser(), 3000);
    } catch (err) {
      const apiError = err.response?.data?.old_password || err.response?.data?.new_password || 'Failed to change password.';
      setError(apiError);
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

  return (
    <Container>
      <h1 className="my-4">Manage Profile</h1>
      {error && <Alert variant="danger" onClose={() => setError('')} dismissible>{error}</Alert>}
      {success && <Alert variant="success" onClose={() => setSuccess('')} dismissible>{success}</Alert>}
      <Row>
        <Col md={6} className="mb-4">
          <Card>
            <Card.Body>
              <Card.Title>Your Details</Card.Title>
              <Form onSubmit={handleProfileSubmit}>
                <Form.Group className="mb-3"><Form.Label>Username</Form.Label><Form.Control type="text" value={profile.username} disabled /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Email</Form.Label><Form.Control type="email" name="email" value={profile.email} onChange={handleProfileChange} /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>First Name</Form.Label><Form.Control type="text" name="first_name" value={profile.first_name} onChange={handleProfileChange} /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Last Name</Form.Label><Form.Control type="text" name="last_name" value={profile.last_name} onChange={handleProfileChange} /></Form.Group>
                <Button variant="primary" type="submit">Save Changes</Button>
              </Form>
            </Card.Body>
          </Card>
        </Col>
        <Col md={6}>
          <Card>
            <Card.Body>
              <Card.Title>Change Password</Card.Title>
              <Form onSubmit={handlePasswordSubmit}>
                <Form.Group className="mb-3"><Form.Label>Old Password</Form.Label><Form.Control type="password" name="old_password" value={passwordData.old_password} onChange={handlePasswordChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>New Password</Form.Label><Form.Control type="password" name="new_password" value={passwordData.new_password} onChange={handlePasswordChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Confirm New Password</Form.Label><Form.Control type="password" name="new_password2" value={passwordData.new_password2} onChange={handlePasswordChange} required /></Form.Group>
                <Button variant="warning" type="submit">Change Password</Button>
              </Form>
            </Card.Body>
          </Card>
        </Col>
      </Row>
    </Container>
  );
}

export default ProfilePage;
\`\`\`


## frontend/src/pages/PurchaseOrdersPage.js

\`\`\`
// src/pages/PurchaseOrdersPage.js
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, Card, Badge } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { getPurchaseOrders, receivePurchaseOrder } from '../services/api';
import RoleRequired from '../components/RoleRequired';

function PurchaseOrdersPage() {
  const [purchaseOrders, setPurchaseOrders] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');

  const fetchPurchaseOrders = async () => {
    try {
      setLoading(true);
      setError('');
      const response = await getPurchaseOrders();
      setPurchaseOrders(response.data);
    } catch (err) {
      setError('Failed to fetch purchase orders.');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => { fetchPurchaseOrders(); }, []);

  const handleReceiveOrder = async (orderId) => {
    if (window.confirm('Are you sure you want to receive this order? This will add all items to stock.')) {
        try {
            await receivePurchaseOrder(orderId);
            fetchPurchaseOrders(); // Refresh the list
        } catch (err) {
            setError('Failed to receive order.');
        }
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

  return (
    <Container>
      <div className="d-flex justify-content-between align-items-center my-4">
        <h1>Purchase Orders</h1>
        <RoleRequired allowedRoles={['Admin', 'Manager']}>
          <Button as={Link} to="/purchase-orders/create" variant="primary">Create Purchase Order</Button>
        </RoleRequired>
      </div>
      
      {error && <Alert variant="danger" onClose={() => setError('')} dismissible>{error}</Alert>}
      {purchaseOrders.length === 0 && !loading && <Alert variant="info">No purchase orders found.</Alert>}

      {purchaseOrders.map((order) => (
        <Card className="mb-3" key={order.id}>
          <Card.Header as="h5" className="d-flex justify-content-between align-items-center">
            <span>PO-{order.id} | Supplier: {order.supplier.name}</span>
            <Badge bg={order.status === 'Received' ? 'success' : 'warning'}>{order.status}</Badge>
          </Card.Header>
          <Card.Body>
            <Card.Text><strong>Order Date:</strong> {new Date(order.order_date).toLocaleDateString()}</Card.Text>
            <h6>Items:</h6>
            <Table striped bordered size="sm">
              <thead><tr><th>Product</th><th>Quantity</th><th>Unit Price</th></tr></thead>
              <tbody>
                {order.items.map((item) => (
                  <tr key={item.id}>
                    <td>{item.product.name} ({item.product.sku})</td>
                    <td>{item.quantity}</td>
                    <td>${item.unit_price}</td>
                  </tr>
                ))}
              </tbody>
            </Table>
          </Card.Body>
          <Card.Footer className="text-end">
            <RoleRequired allowedRoles={['Admin', 'Manager']}>
              <Button 
                  variant="success" 
                  disabled={order.status === 'Received'}
                  onClick={() => handleReceiveOrder(order.id)}
              >
                  {order.status === 'Received' ? 'âœ“ Received' : 'Mark as Received'}
              </Button>
            </RoleRequired>
          </Card.Footer>
        </Card>
      ))}
    </Container>
  );
}

export default PurchaseOrdersPage;
\`\`\`


## frontend/src/pages/RegisterPage.js

\`\`\`
// src/pages/RegisterPage.js
import React, { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { registerUser } from '../services/api';
import { Container, Form, Button, Row, Col, Card, Alert } from 'react-bootstrap';

function RegisterPage() {
  const [formData, setFormData] = useState({
    username: '',
    email: '',
    first_name: '',
    last_name: '',
    password: '',
    password2: '',
    role: 'Staff', // Default role
  });
  const [error, setError] = useState('');
  const [success, setSuccess] = useState('');
  const navigate = useNavigate();

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    setSuccess('');

    try {
      await registerUser(formData);
      setSuccess('Registration successful! Redirecting to login...');
      setTimeout(() => {
        navigate('/login');
      }, 2000);
    } catch (err) {
      const errorData = err.response?.data;
      if (errorData) {
        const messages = Object.keys(errorData).map(key => `${key}: ${errorData[key]}`).join(' ');
        setError(messages || 'Failed to register.');
      } else {
        setError('An unexpected error occurred.');
      }
    }
  };

  return (
    <Container className="mt-5">
      <Row className="justify-content-md-center">
        <Col md={6}>
          <Card>
            <Card.Body>
              <h2 className="text-center mb-4">Register New User</h2>
              {error && <Alert variant="danger">{error}</Alert>}
              {success && <Alert variant="success">{success}</Alert>}
              <Form onSubmit={handleSubmit}>
                <Form.Group className="mb-3"><Form.Label>Username</Form.Label><Form.Control type="text" name="username" onChange={handleChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Email</Form.Label><Form.Control type="email" name="email" onChange={handleChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>First Name</Form.Label><Form.Control type="text" name="first_name" onChange={handleChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Last Name</Form.Label><Form.Control type="text" name="last_name" onChange={handleChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Password</Form.Label><Form.Control type="password" name="password" onChange={handleChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Confirm Password</Form.Label><Form.Control type="password" name="password2" onChange={handleChange} required /></Form.Group>
                <Form.Group className="mb-3"><Form.Label>Role</Form.Label><Form.Select name="role" value={formData.role} onChange={handleChange}><option value="Staff">Staff</option><option value="Manager">Manager</option></Form.Select></Form.Group>
                <div className="d-grid"><Button variant="primary" type="submit">Register</Button></div>
              </Form>
            </Card.Body>
            <Card.Footer className="text-center">Already have an account? <Link to="/login">Log In</Link></Card.Footer>
          </Card>
        </Col>
      </Row>
    </Container>
  );
}

export default RegisterPage;
\`\`\`


## frontend/src/pages/ReportsPage.js

\`\`\`
import React, { useState, useEffect, useCallback } from 'react';
import { Container, Table, Spinner, Alert, Card, Form, Row, Col, Button } from 'react-bootstrap';
import { getTransactions } from '../services/api';
import { CSVLink } from 'react-csv';

function ReportsPage() {
  const [transactions, setTransactions] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [filters, setFilters] = useState({
    timestamp__gte: '', 
    timestamp__lte: '', 
    transaction_type: '',
  });

  const csvHeaders = [
    { label: "Date", key: "timestamp" },
    { label: "Product", key: "product.name" },
    { label: "SKU", key: "product.sku" },
    { label: "Type", key: "transaction_type" },
    { label: "Quantity Change", key: "quantity_change" },
    { label: "Reason", key: "reason" },
    { label: "User", key: "user.username" },
  ];

  const fetchTransactions = useCallback(async () => {
    try {
      setLoading(true);
      const nonEmptyFilters = Object.fromEntries(
        Object.entries(filters).filter(([_, v]) => v !== '')
      );
      const response = await getTransactions(nonEmptyFilters);
      setTransactions(response.data);
    } catch (err) {
      setError('Failed to fetch transactions.');
    } finally {
      setLoading(false);
    }
  }, [filters]); // Dependency on filters

  useEffect(() => {
    fetchTransactions();
  }, [fetchTransactions]); // Run when fetchTransactions function changes

  const handleFilterChange = (e) => setFilters({ ...filters, [e.target.name]: e.target.value });
  const handleFilterSubmit = (e) => { e.preventDefault(); fetchTransactions(); };

  return (
    <Container>
      <h1 className="my-4">Transaction Reports</h1>
      <Card className="p-3 mb-4">
        <Form onSubmit={handleFilterSubmit}>
          <Row className="align-items-end">
            <Col md={3}><Form.Group><Form.Label>Start Date</Form.Label><Form.Control type="date" name="timestamp__gte" value={filters.timestamp__gte} onChange={handleFilterChange} /></Form.Group></Col>
            <Col md={3}><Form.Group><Form.Label>End Date</Form.Label><Form.Control type="date" name="timestamp__lte" value={filters.timestamp__lte} onChange={handleFilterChange} /></Form.Group></Col>
            <Col md={3}><Form.Group><Form.Label>Transaction Type</Form.Label><Form.Select name="transaction_type" value={filters.transaction_type} onChange={handleFilterChange}><option value="">All</option><option value="Purchase">Purchase</option><option value="Sale">Sale</option><option value="Adjustment">Adjustment</option></Form.Select></Form.Group></Col>
            <Col md={3} className="d-flex gap-2">
              <Button type="submit" className="w-100">Filter</Button>
              <CSVLink
                data={transactions}
                headers={csvHeaders}
                filename={`inventory-report-${new Date().toISOString().slice(0, 10)}.csv`}
                className="btn btn-success w-100"
                target="_blank"
              >
                Export
              </CSVLink>
            </Col>
          </Row>
        </Form>
      </Card>

      {loading ? (<div className="text-center"><Spinner animation="border" /></div>) : 
       error ? (<Alert variant="danger">{error}</Alert>) : 
      (<Table striped bordered hover responsive>
          <thead><tr><th>Date</th><th>Product</th><th>Type</th><th>Qty Change</th><th>Reason</th></tr></thead>
          <tbody>
            {transactions.map((tx) => (
              <tr key={tx.id}>
                <td>{new Date(tx.timestamp).toLocaleString()}</td>
                <td>{tx.product.name}</td>
                <td>{tx.transaction_type}</td>
                <td className={tx.quantity_change > 0 ? 'text-success' : 'text-danger'}>
                  <strong>{tx.quantity_change > 0 ? `+${tx.quantity_change}` : tx.quantity_change}</strong>
                </td>
                <td>{tx.reason}</td>
              </tr>
            ))}
          </tbody>
        </Table>
      )}
    </Container>
  );
}

export default ReportsPage;
\`\`\`


## frontend/src/pages/RequestPasswordResetPage.js

\`\`\`
import React, { useState } from 'react';
import { Container, Form, Button, Card, Alert } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { requestPasswordReset } from '../services/api'; // Correct path

function RequestPasswordResetPage() {
  const [email, setEmail] = useState('');
  const [message, setMessage] = useState('');
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');
    setMessage('');
    try {
      await requestPasswordReset(email);
      setMessage('If an account with that email exists, a password reset link has been sent.');
    } catch (err) {
      setError('An error occurred. Please try again.');
    }
  };

  return (
    <Container className="mt-5 d-flex justify-content-center">
      <Card style={{ width: '400px' }}>
        <Card.Body>
          <h2 className="text-center mb-4">Reset Password</h2>
          {message && <Alert variant="success">{message}</Alert>}
          {error && <Alert variant="danger">{error}</Alert>}
          <Form onSubmit={handleSubmit}>
            <Form.Group className="mb-3">
              <Form.Label>Email address</Form.Label>
              <Form.Control
                type="email"
                placeholder="Enter your email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                required
              />
            </Form.Group>
            <div className="d-grid">
              <Button variant="primary" type="submit">
                Send Reset Link
              </Button>
            </div>
          </Form>
        </Card.Body>
        <Card.Footer className="text-center">
          <Link to="/login">Back to Login</Link>
        </Card.Footer>
      </Card>
    </Container>
  );
}

export default RequestPasswordResetPage;
\`\`\`


## frontend/src/pages/SalesOrdersPage.js

\`\`\`
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, Card, Badge } from 'react-bootstrap';
import { Link } from 'react-router-dom';
import { getSalesOrders } from '../services/api';
import RoleRequired from '../components/RoleRequired';

function SalesOrdersPage() {
  const [salesOrders, setSalesOrders] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');

  const handlePrintInvoice = (orderId) => {
    // This function now simply opens the new invoice page in a new tab
    window.open(`/sales-orders/${orderId}/invoice`, '_blank');
  };
  
  useEffect(() => {
    const fetchSalesOrders = async () => {
      try {
        const response = await getSalesOrders();
        setSalesOrders(response.data);
      } catch (err) {
        setError('Failed to fetch sales orders.');
      } finally {
        setLoading(false);
      }
    };
    fetchSalesOrders();
  }, []);

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;
  if (error) return <Container className="mt-5"><Alert variant="danger">{error}</Alert></Container>;

  return (
    <Container>
      <div className="d-flex justify-content-between align-items-center my-4">
        <h1>Sales Orders</h1>
        <RoleRequired allowedRoles={['Admin', 'Manager']}>
          <Button as={Link} to="/sales-orders/create" variant="primary">Create Sales Order</Button>
        </RoleRequired>
      </div>
      
      {salesOrders.map((order) => (
        <Card className="mb-3" key={order.id}>
          <Card.Header as="h5" className="d-flex justify-content-between align-items-center">
             <span>SO-{order.id} | Customer: {order.customer_name || 'N/A'}</span>
             <Badge bg={order.status === 'Fulfilled' ? 'success' : 'warning'}>{order.status}</Badge>
          </Card.Header>
          <Card.Body>
            <Card.Text><strong>Order Date:</strong> {new Date(order.order_date).toLocaleDateString()}</Card.Text>
            <h6>Items:</h6>
            <Table striped bordered size="sm">
              <thead><tr><th>Product</th><th>Quantity</th><th>Unit Price</th></tr></thead>
              <tbody>
                {order.items.map((item) => (
                  <tr key={item.id}>
                    <td>{item.product.name} ({item.product.sku})</td>
                    <td>{item.quantity}</td>
                    <td>â‚¹{item.unit_price}</td>
                  </tr>
                ))}
              </tbody>
            </Table>
          </Card.Body>
          <Card.Footer className="text-end">
            <Button variant="outline-secondary" onClick={() => handlePrintInvoice(order.id)}>
                View Printable Invoice
            </Button>
          </Card.Footer>
        </Card>
      ))}
    </Container>
  );
}

export default SalesOrdersPage;
\`\`\`


## frontend/src/pages/SuppliersPage.js

\`\`\`
// src/pages/SuppliersPage.js
import React, { useState, useEffect } from 'react';
import { Container, Table, Spinner, Alert, Button, ButtonGroup } from 'react-bootstrap';
import { getSuppliers, createSupplier, updateSupplier, deleteSupplier } from '../services/api';
import SupplierFormModal from '../components/SupplierFormModal';

function SuppliersPage() {
  const [suppliers, setSuppliers] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState('');
  const [showModal, setShowModal] = useState(false);
  const [selectedSupplier, setSelectedSupplier] = useState(null);

  const fetchSuppliers = async () => {
    try { setLoading(true); const response = await getSuppliers(); setSuppliers(response.data); setError(''); } 
    catch (err) { setError('Failed to fetch suppliers.'); console.error(err); } 
    finally { setLoading(false); }
  };

  useEffect(() => { fetchSuppliers(); }, []);

  const handleShowCreateModal = () => { setSelectedSupplier(null); setShowModal(true); };
  const handleShowEditModal = (supplier) => { setSelectedSupplier(supplier); setShowModal(true); };
  const handleCloseModal = () => { setShowModal(false); setSelectedSupplier(null); };

  const handleSave = async (formData) => {
    try {
      if (selectedSupplier) { await updateSupplier(selectedSupplier.id, formData); } 
      else { await createSupplier(formData); }
      fetchSuppliers(); handleCloseModal();
    } catch (err) { setError(selectedSupplier ? 'Failed to update supplier.' : 'Failed to create supplier.'); }
  };

  const handleDelete = async (id) => {
    if (window.confirm('Are you sure?')) {
      try { await deleteSupplier(id); fetchSuppliers(); } 
      catch (err) { setError('Failed to delete supplier.'); }
    }
  };

  if (loading) return <Container className="text-center mt-5"><Spinner animation="border" /></Container>;

  return (
    <Container>
      <div className="d-flex justify-content-between align-items-center my-4">
        <h1>Suppliers</h1>
        <Button variant="primary" onClick={handleShowCreateModal}>Create Supplier</Button>
      </div>
      {error && <Alert variant="danger">{error}</Alert>}
      <Table striped bordered hover responsive>
        <thead>
          <tr>
            <th>Name</th><th>Email</th><th>Phone</th><th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {suppliers.map((supplier) => (
            <tr key={supplier.id}>
              <td>{supplier.name}</td><td>{supplier.email}</td><td>{supplier.phone}</td>
              <td>
                <ButtonGroup>
                  <Button variant="outline-secondary" size="sm" onClick={() => handleShowEditModal(supplier)}>Edit</Button>
                  <Button variant="outline-danger" size="sm" onClick={() => handleDelete(supplier.id)}>Delete</Button>
                </ButtonGroup>
              </td>
            </tr>
          ))}
        </tbody>
      </Table>
      <SupplierFormModal show={showModal} handleClose={handleCloseModal} supplier={selectedSupplier} onSave={handleSave} />
    </Container>
  );
}

export default SuppliersPage;
\`\`\`


## frontend/src/reportWebVitals.js

\`\`\`
const reportWebVitals = onPerfEntry => {
  if (onPerfEntry && onPerfEntry instanceof Function) {
    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
      getCLS(onPerfEntry);
      getFID(onPerfEntry);
      getFCP(onPerfEntry);
      getLCP(onPerfEntry);
      getTTFB(onPerfEntry);
    });
  }
};

export default reportWebVitals;

\`\`\`


## frontend/src/services/api.js

\`\`\`
// import axios from 'axios';

// const api = axios.create({ baseURL: 'http://127.0.0.1:8000/api' });

// // --- Auth ---
// export const loginUser = (username, password) => api.post('/token/', { username, password });
// export const registerUser = (userData) => api.post('/register/', userData);

// // --- Products ---
// export const getProducts = () => api.get('/products/');
// export const createProduct = (product) => api.post('/products/', product);
// export const updateProduct = (id, product) => api.put(`/products/${id}/`, product);
// export const deleteProduct = (id) => api.delete(`/products/${id}/`);

// // --- Suppliers ---
// export const getSuppliers = () => api.get('/suppliers/');
// export const createSupplier = (supplier) => api.post('/suppliers/', supplier);
// export const updateSupplier = (id, supplier) => api.put(`/suppliers/${id}/`, supplier);
// export const deleteSupplier = (id) => api.delete(`/suppliers/${id}/`);

// // --- Purchase Orders ---
// export const getPurchaseOrders = () => api.get('/purchase-orders/');
// export const createPurchaseOrder = (orderData) => api.post('/purchase-orders/', orderData);
// export const receivePurchaseOrder = (id) => api.post(`/purchase-orders/${id}/receive/`);

// // --- Sales Orders ---
// export const getSalesOrders = () => api.get('/sales-orders/');
// export const createSalesOrder = (orderData) => api.post('/sales-orders/', orderData);

// // --- Transactions & Dashboard ---
// export const getTransactions = (params) => api.get('/transactions/', { params });
// export const getDashboardStats = () => api.get('/dashboard-stats/');


// export default api;

// src/api/index.js
import axios from 'axios';

// Create a new Axios instance
const api = axios.create({
  baseURL: 'http://127.0.0.1:8000/api',
});

// Use an interceptor to automatically add the auth token to every request
api.interceptors.request.use(
  (config) => {
    const authTokens = localStorage.getItem('authTokens');
    if (authTokens) {
      const token = JSON.parse(authTokens).access;
      config.headers['Authorization'] = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// --- Auth ---
export const loginUser = (username, password) => api.post('/token/', { username, password });
export const registerUser = (userData) => api.post('/register/', userData);

// --- Profile Management ---
export const getUserProfile = () => api.get('/users/me/');
export const updateUserProfile = (userData) => api.patch('/users/me/', userData);
export const changePassword = (passwordData) => api.put('/change-password/', passwordData);

// --- Products ---
export const getProducts = () => api.get('/products/');
export const createProduct = (product) => api.post('/products/', product);
export const updateProduct = (id, product) => api.put(`/products/${id}/`, product);
export const deleteProduct = (id) => api.delete(`/products/${id}/`);

// --- Suppliers ---
export const getSuppliers = () => api.get('/suppliers/');
export const createSupplier = (supplier) => api.post('/suppliers/', supplier);
export const updateSupplier = (id, supplier) => api.put(`/suppliers/${id}/`, supplier);
export const deleteSupplier = (id) => api.delete(`/suppliers/${id}/`);

// --- Purchase Orders ---
export const getPurchaseOrders = () => api.get('/purchase-orders/');
export const createPurchaseOrder = (orderData) => api.post('/purchase-orders/', orderData);
export const receivePurchaseOrder = (id) => api.post(`/purchase-orders/${id}/receive/`);

// --- Sales Orders ---
export const getSalesOrders = () => api.get('/sales-orders/');
export const createSalesOrder = (orderData) => api.post('/sales-orders/', orderData);

// --- Dashboard & Reports ---
export const getDashboardStats = () => api.get('/dashboard-stats/');
export const getTransactions = (params) => api.get('/transactions/', { params });




export const requestPasswordReset = (email) => api.post('/password_reset/', { email });
export const confirmPasswordReset = (token, password) => api.post('/password_reset/confirm/', { token, password });



export default api;
\`\`\`


## frontend/src/setupTests.js

\`\`\`
// jest-dom adds custom jest matchers for asserting on DOM nodes.
// allows you to do things like:
// expect(element).toHaveTextContent(/react/i)
// learn more: https://github.com/testing-library/jest-dom
import '@testing-library/jest-dom';

\`\`\`


## ics.txt

\`\`\`
Inventory Control System
Objective
To design and implement a full-stack inventory control system using Django and React that allows
businesses to efficiently manage stock levels, track item movements, monitor suppliers, and
generate real-time reports. The system aims to reduce manual errors, optimize stock usage, and
provide visibility into inventory operations across warehouses or store locations.
Core Features
1. User Authentication & Role Management
- Secure user registration and login with JWT authentication
- User roles: Admin, Manager, Staff
- Role-based access control for different system features
- Password recovery and profile management
2. Product and Stock Management
- Add, update, and delete products with attributes (name, SKU, category, unit, price)
- Track available stock, minimum stock level, and reorder point
- Real-time stock updates on addition or removal
- Barcode or QR code generation for product identification
3. Inventory Transactions
- Log inventory in and out records with date, quantity, and reason
- Record transactions like purchases, sales, returns, and adjustments
- Track stock movement history per product
- Batch updates for multiple items at once
4. Supplier and Purchase Order Management
- Add and manage supplier information
- Create and manage purchase orders
- Link received items to purchase orders for automatic stock updates
- Track order status: Pending, Shipped, Received
5. Sales and Order Management
- Create and manage customer sales orders
- Deduct sold quantities from inventory
- Generate printable invoices for completed orders
- Monitor pending and fulfilled orders
6. Dashboard and Reporting
- Dashboard with:
- Inventory summary
- Low stock alerts
- Recent transactions
- Generate reports on:
- Stock levels
- Reorder needs
- Transactions
- Sales
- Export reports in PDF or CSV format
- Filter and search reports by date, product, or category
7. Notifications and Alerts
- Low stock alerts for items below minimum level
- Reorder notifications with supplier suggestions
- Email or in-app alerts for key inventory changes
8. Responsive User Interface
- React frontend with Bootstrap UI
- Optimized for both desktop and mobile views
- User-friendly navigation with search and filter features
Success Criteria
- Complete and secure user authentication and role-based permissions
- Accurate stock tracking with real-time inventory updates
- Reliable transaction and movement logs with traceability
- Functional supplier and sales order workflows
- Clear and usable dashboard with essential inventory insights
- Smooth API interaction between Django backend and React frontend
- Fully deployed and documented system on a cloud platform
Optional Enhancements
- Barcode scanner integration via mobile camera or hardware support
- Warehouse zone or location-based inventory tracking
- Multi-store or multi-warehouse inventory support
- Audit trail with user activity logs
- API integration with external accounting or e-commerce platforms
- Drag-and-drop inventory planograms or visual layouts
- Predictive restocking using usage history and trends
- Offline mode with data sync when online connection resumes

\`\`\`


## inventory/__init__.py

\`\`\`

\`\`\`


## inventory/admin.py

\`\`\`
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin
from .models import (
    User, Product, Supplier, PurchaseOrder, 
    PurchaseOrderItem, SalesOrder, SalesOrderItem, InventoryTransaction
)

# --- Full CRUD for User Management ---
# This remains fully editable for the superuser/admin.
class CustomUserAdmin(UserAdmin):
    list_display = ('username', 'email', 'first_name', 'last_name', 'role', 'is_staff')
    fieldsets = UserAdmin.fieldsets + (
        ('Role Information', {'fields': ('role',)}),
    )
    add_fieldsets = UserAdmin.add_fieldsets + (
        ('Role Information', {'fields': ('role',)}),
    )
admin.site.register(User, CustomUserAdmin)


# --- Read-Only Admin for ALL Inventory Models ---
class ReadOnlyModelAdmin(admin.ModelAdmin):
    """
    Disables all add, change, and delete permissions for any model
    this is applied to, making it strictly read-only for all users.
    """
    def has_add_permission(self, request):
        return False

    def has_change_permission(self, request, obj=None):
        return False

    def has_delete_permission(self, request, obj=None):
        return False


# --- Inline Models for Read-Only Display ---
class PurchaseOrderItemInline(admin.TabularInline):
    model = PurchaseOrderItem
    extra = 0
    can_delete = False
    readonly_fields = [f.name for f in PurchaseOrderItem._meta.fields]
    def has_add_permission(self, request, obj=None): return False
    def has_change_permission(self, request, obj=None): return False

class SalesOrderItemInline(admin.TabularInline):
    model = SalesOrderItem
    extra = 0
    can_delete = False
    readonly_fields = [f.name for f in SalesOrderItem._meta.fields]
    def has_add_permission(self, request, obj=None): return False
    def has_change_permission(self, request, obj=None): return False


# --- Registering Inventory Models with Read-Only Permissions ---
@admin.register(Product)
class ProductAdmin(ReadOnlyModelAdmin):
    list_display = ('name', 'sku', 'category', 'stock_quantity', 'unit_price')
    search_fields = ('name', 'sku')

@admin.register(Supplier)
class SupplierAdmin(ReadOnlyModelAdmin):
    list_display = ('name', 'email', 'phone')
    search_fields = ('name',)

@admin.register(PurchaseOrder)
class PurchaseOrderAdmin(ReadOnlyModelAdmin):
    list_display = ('id', 'supplier', 'status', 'order_date')
    inlines = [PurchaseOrderItemInline]

@admin.register(SalesOrder)
class SalesOrderAdmin(ReadOnlyModelAdmin):
    list_display = ('id', 'customer_name', 'status', 'order_date')
    inlines = [SalesOrderItemInline]

@admin.register(InventoryTransaction)
class InventoryTransactionAdmin(ReadOnlyModelAdmin):
    list_display = ('timestamp', 'product', 'transaction_type', 'quantity_change', 'user')
\`\`\`


## inventory/apps.py

\`\`\`
from django.apps import AppConfig


class InventoryConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'inventory'

\`\`\`


## inventory/migrations/__init__.py

\`\`\`

\`\`\`


## inventory/migrations/0001_initial.py

\`\`\`
# Generated by Django 5.2.5 on 2025-08-15 15:46

import django.contrib.auth.models
import django.contrib.auth.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='Product',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('sku', models.CharField(max_length=100, unique=True)),
                ('category', models.CharField(blank=True, max_length=100)),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=10)),
                ('stock_quantity', models.PositiveIntegerField(default=0)),
                ('min_stock_level', models.PositiveIntegerField(default=10)),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('order_date', models.DateTimeField(auto_now_add=True)),
                ('status', models.CharField(choices=[('Pending', 'Pending'), ('Shipped', 'Shipped'), ('Received', 'Received')], default='Pending', max_length=10)),
            ],
        ),
        migrations.CreateModel(
            name='SalesOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('order_date', models.DateTimeField(auto_now_add=True)),
                ('status', models.CharField(choices=[('Pending', 'Pending'), ('Fulfilled', 'Fulfilled'), ('Cancelled', 'Cancelled')], default='Pending', max_length=10)),
                ('customer_name', models.CharField(blank=True, max_length=255)),
            ],
        ),
        migrations.CreateModel(
            name='Supplier',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('contact_info', models.TextField()),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('phone', models.CharField(max_length=255)),
            ],
        ),
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('username', models.CharField(error_messages={'unique': 'A user with that username already exists.'}, help_text='Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.', max_length=150, unique=True, validators=[django.contrib.auth.validators.UnicodeUsernameValidator()], verbose_name='username')),
                ('first_name', models.CharField(blank=True, max_length=150, verbose_name='first name')),
                ('last_name', models.CharField(blank=True, max_length=150, verbose_name='last name')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='email address')),
                ('is_staff', models.BooleanField(default=False, help_text='Designates whether the user can log into this admin site.', verbose_name='staff status')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this user should be treated as active. Unselect this instead of deleting accounts.', verbose_name='active')),
                ('date_joined', models.DateTimeField(default=django.utils.timezone.now, verbose_name='date joined')),
                ('role', models.CharField(choices=[('Admin', 'Admin'), ('Manager', 'Manager'), ('Staff', 'Staff')], default='Staff', max_length=10)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'verbose_name': 'user',
                'verbose_name_plural': 'users',
                'abstract': False,
            },
            managers=[
                ('objects', django.contrib.auth.models.UserManager()),
            ],
        ),
        migrations.CreateModel(
            name='InventoryTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('transaction_type', models.CharField(choices=[('Purchase', 'Purchase'), ('Sale', 'Sale'), ('Adjustment', 'Adjustment')], max_length=10)),
                ('quantity_change', models.IntegerField()),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('reason', models.CharField(blank=True, max_length=255)),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='inventory.product')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseOrderItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.PositiveIntegerField()),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=10)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='inventory.product')),
                ('purchase_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='inventory.purchaseorder')),
            ],
        ),
        migrations.CreateModel(
            name='SalesOrderItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantity', models.PositiveIntegerField()),
                ('unit_price', models.DecimalField(decimal_places=2, max_digits=10)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='inventory.product')),
                ('sales_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='inventory.salesorder')),
            ],
        ),
        migrations.AddField(
            model_name='purchaseorder',
            name='supplier',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='inventory.supplier'),
        ),
    ]

\`\`\`


## inventory/migrations/0002_alter_inventorytransaction_options_and_more.py

\`\`\`
# Generated by Django 5.2.5 on 2025-08-25 17:17

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('inventory', '0001_initial'),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='inventorytransaction',
            options={'ordering': ['-timestamp'], 'verbose_name': 'Inventory Transaction', 'verbose_name_plural': 'Inventory Transactions'},
        ),
        migrations.AlterModelOptions(
            name='product',
            options={'verbose_name': 'Product', 'verbose_name_plural': 'Products'},
        ),
        migrations.AlterModelOptions(
            name='purchaseorder',
            options={'verbose_name': 'Purchase Order', 'verbose_name_plural': 'Purchase Orders'},
        ),
        migrations.AlterModelOptions(
            name='salesorder',
            options={'verbose_name': 'Sales Order', 'verbose_name_plural': 'Sales Orders'},
        ),
        migrations.AlterModelOptions(
            name='supplier',
            options={'verbose_name': 'Supplier', 'verbose_name_plural': 'Suppliers'},
        ),
        migrations.AlterModelOptions(
            name='user',
            options={'verbose_name': 'User', 'verbose_name_plural': 'Users'},
        ),
        migrations.AlterField(
            model_name='inventorytransaction',
            name='product',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='transactions', to='inventory.product'),
        ),
        migrations.AlterField(
            model_name='inventorytransaction',
            name='quantity_change',
            field=models.IntegerField(help_text='Positive for stock in, negative for stock out.'),
        ),
        migrations.AlterField(
            model_name='inventorytransaction',
            name='reason',
            field=models.CharField(blank=True, help_text='Reason for a manual adjustment.', max_length=255),
        ),
        migrations.AlterField(
            model_name='product',
            name='min_stock_level',
            field=models.PositiveIntegerField(default=10, help_text='The stock level at which a reorder alert is triggered.'),
        ),
        migrations.AlterField(
            model_name='product',
            name='name',
            field=models.CharField(help_text='The name of the product.', max_length=255),
        ),
        migrations.AlterField(
            model_name='product',
            name='sku',
            field=models.CharField(help_text='Unique Stock Keeping Unit (SKU) for the product.', max_length=100, unique=True),
        ),
        migrations.AlterField(
            model_name='product',
            name='stock_quantity',
            field=models.PositiveIntegerField(default=0, help_text='Current number of units in stock.'),
        ),
        migrations.AlterField(
            model_name='product',
            name='unit_price',
            field=models.DecimalField(decimal_places=2, help_text='The selling price for one unit of the product.', max_digits=10),
        ),
        migrations.AlterField(
            model_name='purchaseorder',
            name='supplier',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='purchase_orders', to='inventory.supplier'),
        ),
        migrations.AlterField(
            model_name='purchaseorderitem',
            name='unit_price',
            field=models.DecimalField(decimal_places=2, help_text='The cost per unit from the supplier.', max_digits=10),
        ),
        migrations.AlterField(
            model_name='salesorderitem',
            name='unit_price',
            field=models.DecimalField(decimal_places=2, help_text='The selling price per unit at the time of sale.', max_digits=10),
        ),
        migrations.AlterField(
            model_name='supplier',
            name='contact_info',
            field=models.TextField(blank=True, help_text='Physical address or other contact details.'),
        ),
        migrations.AlterField(
            model_name='supplier',
            name='email',
            field=models.EmailField(help_text='Contact email for the supplier.', max_length=254, unique=True),
        ),
        migrations.AlterField(
            model_name='supplier',
            name='name',
            field=models.CharField(help_text='The name of the supplier company.', max_length=255),
        ),
        migrations.AlterField(
            model_name='supplier',
            name='phone',
            field=models.CharField(help_text='Contact phone number for the supplier.', max_length=255),
        ),
    ]

\`\`\`


## inventory/models.py

\`\`\`
from django.contrib.auth.models import AbstractUser
from django.db import models


# === USER AND SUPPLIER MODELS ===

class User(AbstractUser):
    """
    Custom user model extending Django's built-in user.
    Adds a 'role' to differentiate between user permission levels.
    """
    class Role(models.TextChoices):
        ADMIN = 'Admin', 'Admin'
        MANAGER = 'Manager', 'Manager'
        STAFF = 'Staff', 'Staff'

    role = models.CharField(max_length=10, choices=Role.choices, default=Role.STAFF)

    class Meta:
        verbose_name = 'User'
        verbose_name_plural = 'Users'

class Supplier(models.Model):
    """Represents a supplier or vendor who provides products."""
    name = models.CharField(max_length=255, help_text="The name of the supplier company.")
    contact_info = models.TextField(blank=True, help_text="Physical address or other contact details.")
    email = models.EmailField(unique=True, help_text="Contact email for the supplier.")
    phone = models.CharField(max_length=255, help_text="Contact phone number for the supplier.")

    def __str__(self):
        return self.name

    class Meta:
        verbose_name = 'Supplier'
        verbose_name_plural = 'Suppliers'


# === PRODUCT AND STOCK MODELS ===

class Product(models.Model):
    """Represents an item in the inventory."""
    name = models.CharField(max_length=255, help_text="The name of the product.")
    sku = models.CharField(max_length=100, unique=True, help_text="Unique Stock Keeping Unit (SKU) for the product.")
    category = models.CharField(max_length=100, blank=True)
    unit_price = models.DecimalField(max_digits=10, decimal_places=2, help_text="The selling price for one unit of the product.")
    stock_quantity = models.PositiveIntegerField(default=0, help_text="Current number of units in stock.")
    min_stock_level = models.PositiveIntegerField(default=10, help_text="The stock level at which a reorder alert is triggered.")

    def __str__(self):
        return f"{self.name} ({self.sku})"

    class Meta:
        verbose_name = 'Product'
        verbose_name_plural = 'Products'


# === ORDER MODELS ===

class PurchaseOrder(models.Model):
    """Represents an order placed with a supplier to replenish stock."""
    class Status(models.TextChoices):
        PENDING = 'Pending', 'Pending'
        SHIPPED = 'Shipped', 'Shipped'
        RECEIVED = 'Received', 'Received'

    supplier = models.ForeignKey(Supplier, on_delete=models.PROTECT, related_name='purchase_orders')
    order_date = models.DateTimeField(auto_now_add=True)
    status = models.CharField(max_length=10, choices=Status.choices, default=Status.PENDING)

    def __str__(self):
        return f"PO-{self.id} from {self.supplier.name}"

    class Meta:
        verbose_name = 'Purchase Order'
        verbose_name_plural = 'Purchase Orders'

class PurchaseOrderItem(models.Model):
    """Represents a single line item within a Purchase Order."""
    purchase_order = models.ForeignKey(PurchaseOrder, related_name="items", on_delete=models.CASCADE)
    product = models.ForeignKey(Product, on_delete=models.PROTECT)
    quantity = models.PositiveIntegerField()
    unit_price = models.DecimalField(max_digits=10, decimal_places=2, help_text="The cost per unit from the supplier.")

    def __str__(self):
        return f"{self.quantity} x {self.product.name} in PO-{self.purchase_order.id}"

class SalesOrder(models.Model):
    """Represents a sales order from a customer."""
    class Status(models.TextChoices):
        PENDING = 'Pending', 'Pending'
        FULFILLED = 'Fulfilled', 'Fulfilled'
        CANCELLED = 'Cancelled', 'Cancelled'
    
    order_date = models.DateTimeField(auto_now_add=True)
    status = models.CharField(max_length=10, choices=Status.choices, default=Status.PENDING)
    customer_name = models.CharField(max_length=255, blank=True)

    def __str__(self):
        return f"SO-{self.id} for {self.customer_name or 'N/A'}"
        
    class Meta:
        verbose_name = 'Sales Order'
        verbose_name_plural = 'Sales Orders'

class SalesOrderItem(models.Model):
    """Represents a single line item within a Sales Order."""
    sales_order = models.ForeignKey(SalesOrder, related_name="items", on_delete=models.CASCADE)
    product = models.ForeignKey(Product, on_delete=models.PROTECT)
    quantity = models.PositiveIntegerField()
    unit_price = models.DecimalField(max_digits=10, decimal_places=2, help_text="The selling price per unit at the time of sale.")
    
    def __str__(self):
        return f"{self.quantity} x {self.product.name} in SO-{self.sales_order.id}"


# === LOGGING MODEL ===

class InventoryTransaction(models.Model):
    """Logs every movement of stock (in or out)."""
    class TransactionType(models.TextChoices):
        PURCHASE = 'Purchase', 'Purchase'
        SALE = 'Sale', 'Sale'
        ADJUSTMENT = 'Adjustment', 'Adjustment'

    product = models.ForeignKey(Product, on_delete=models.CASCADE, related_name='transactions')
    transaction_type = models.CharField(max_length=10, choices=TransactionType.choices)
    quantity_change = models.IntegerField(help_text="Positive for stock in, negative for stock out.")
    timestamp = models.DateTimeField(auto_now_add=True)
    user = models.ForeignKey(User, on_delete=models.SET_NULL, null=True, blank=True)
    reason = models.CharField(max_length=255, blank=True, help_text="Reason for a manual adjustment.")

    def __str__(self):
        return f"{self.transaction_type} of {self.product.name}: {self.quantity_change}"
        
    class Meta:
        verbose_name = 'Inventory Transaction'
        verbose_name_plural = 'Inventory Transactions'
        ordering = ['-timestamp']
\`\`\`


## inventory/permissions.py

\`\`\`
# inventory/permissions.py
from rest_framework.permissions import BasePermission, SAFE_METHODS

class IsAdminOrManager(BasePermission):
    """
    Allows access only to users with 'Admin' or 'Manager' roles.
    """
    def has_permission(self, request, view):
        return request.user and request.user.is_authenticated and (request.user.role in ['Admin', 'Manager'])

class IsStaffReadOnly(BasePermission):
    """
    Allows read-only access to any authenticated user (including 'Staff'),
    but write access only to 'Admin' or 'Manager' roles.
    """
    def has_permission(self, request, view):
        # Allow read-only methods (GET, HEAD, OPTIONS) for any authenticated user
        if request.method in SAFE_METHODS:
            return request.user and request.user.is_authenticated
        
        # For write methods (POST, PUT, DELETE), only allow Admins or Managers
        return request.user and request.user.is_authenticated and (request.user.role in ['Admin', 'Manager'])
\`\`\`


## inventory/serializers.py

\`\`\`
"""
Serializers for the inventory app.

This file defines how complex data, such as model instances, are converted to
native Python datatypes that can then be easily rendered into JSON for the API.
"""

from rest_framework import serializers
from django.db import transaction
from rest_framework_simplejwt.serializers import TokenObtainPairSerializer

from .models import (
    User, Supplier, Product, PurchaseOrder, PurchaseOrderItem, 
    SalesOrder, SalesOrderItem, InventoryTransaction
)


# === Authentication and User Management Serializers ===

class MyTokenObtainPairSerializer(TokenObtainPairSerializer):
    """Customizes the JWT token to include user's role and username."""
    @classmethod
    def get_token(cls, user):
        token = super().get_token(user)
        token['username'] = user.username
        token['role'] = user.role
        return token

class RegisterSerializer(serializers.ModelSerializer):
    """Serializer for new user registration."""
    password2 = serializers.CharField(style={'input_type': 'password'}, write_only=True)

    class Meta:
        model = User
        fields = ['username', 'email', 'password', 'password2', 'first_name', 'last_name', 'role']
        extra_kwargs = {'password': {'write_only': True}}

    def save(self):
        user = User(
            username=self.validated_data['username'],
            email=self.validated_data['email'],
            first_name=self.validated_data['first_name'],
            last_name=self.validated_data['last_name'],
            role=self.validated_data.get('role', User.Role.STAFF)
        )
        password = self.validated_data['password']
        password2 = self.validated_data['password2']
        if password != password2:
            raise serializers.ValidationError({'password': 'Passwords must match.'})
        user.set_password(password)
        user.save()
        return user

class UserSerializer(serializers.ModelSerializer):
    """Serializer for reading user data."""
    class Meta:
        model = User
        fields = ['id', 'username', 'email', 'role', 'first_name', 'last_name']

class UserProfileSerializer(serializers.ModelSerializer):
    """Serializer for updating a user's own profile."""
    class Meta:
        model = User
        fields = ['username', 'email', 'first_name', 'last_name']
        read_only_fields = ['username']

class ChangePasswordSerializer(serializers.Serializer):
    """Serializer for handling a password change."""
    old_password = serializers.CharField(required=True, write_only=True)
    new_password = serializers.CharField(required=True, write_only=True)
    new_password2 = serializers.CharField(required=True, write_only=True)

    def validate(self, data):
        if data['new_password'] != data['new_password2']:
            raise serializers.ValidationError({"new_password": "New passwords must match."})
        return data

    def validate_old_password(self, value):
        user = self.context['request'].user
        if not user.check_password(value):
            raise serializers.ValidationError("Your old password was entered incorrectly.")
        return value

    def save(self, **kwargs):
        user = self.context['request'].user
        user.set_password(self.validated_data['new_password'])
        user.save()
        return user


# === Core Model Serializers (Read/Write) ===

class SupplierSerializer(serializers.ModelSerializer):
    """Serializer for reading and writing Supplier data."""
    class Meta:
        model = Supplier
        fields = ['id', 'name', 'contact_info', 'email', 'phone']

class ProductSerializer(serializers.ModelSerializer):
    """Serializer for reading and writing Product data."""
    class Meta:
        model = Product
        fields = ['id', 'name', 'sku', 'category', 'unit_price', 'stock_quantity', 'min_stock_level']


# === Purchase Order Serializers ===

class PurchaseOrderItemSerializer(serializers.ModelSerializer):
    """Read-only serializer for items within a Purchase Order."""
    product = ProductSerializer(read_only=True)
    class Meta:
        model = PurchaseOrderItem
        fields = ['id', 'product', 'quantity', 'unit_price']

class PurchaseOrderSerializer(serializers.ModelSerializer):
    """Read-only serializer for a complete Purchase Order."""
    items = PurchaseOrderItemSerializer(many=True, read_only=True)
    supplier = SupplierSerializer(read_only=True)
    class Meta:
        model = PurchaseOrder
        fields = ['id', 'supplier', 'order_date', 'status', 'items']

class PurchaseOrderItemWriteSerializer(serializers.ModelSerializer):
    """Write-only serializer for creating items within a Purchase Order."""
    class Meta:
        model = PurchaseOrderItem
        fields = ['product', 'quantity', 'unit_price']

class PurchaseOrderWriteSerializer(serializers.ModelSerializer):
    """Write-only serializer for creating a complete Purchase Order."""
    items = PurchaseOrderItemWriteSerializer(many=True)
    class Meta:
        model = PurchaseOrder
        fields = ['supplier', 'status', 'items']
    def create(self, validated_data):
        items_data = validated_data.pop('items')
        with transaction.atomic():
            purchase_order = PurchaseOrder.objects.create(**validated_data)
            for item_data in items_data:
                PurchaseOrderItem.objects.create(purchase_order=purchase_order, **item_data)
        return purchase_order


# === Sales Order Serializers ===

class SalesOrderItemSerializer(serializers.ModelSerializer):
    """Read-only serializer for items within a Sales Order."""
    product = ProductSerializer(read_only=True)
    class Meta:
        model = SalesOrderItem
        fields = ['id', 'product', 'quantity', 'unit_price']

class SalesOrderSerializer(serializers.ModelSerializer):
    """Read-only serializer for a complete Sales Order."""
    items = SalesOrderItemSerializer(many=True, read_only=True)
    class Meta:
        model = SalesOrder
        fields = ['id', 'customer_name', 'order_date', 'status', 'items']

class SalesOrderItemWriteSerializer(serializers.ModelSerializer):
    """Write-only serializer for creating items within a Sales Order."""
    class Meta:
        model = SalesOrderItem
        fields = ['product', 'quantity', 'unit_price']

class SalesOrderWriteSerializer(serializers.ModelSerializer):
    """
    Write-only serializer for creating a Sales Order.
    Includes logic to deduct stock and log the transaction.
    """
    items = SalesOrderItemWriteSerializer(many=True)
    class Meta:
        model = SalesOrder
        fields = ['customer_name', 'status', 'items']
    def create(self, validated_data):
        items_data = validated_data.pop('items')
        user = self.context['request'].user
        with transaction.atomic():
            sales_order = SalesOrder.objects.create(**validated_data)
            for item_data in items_data:
                product = item_data['product']
                quantity = item_data['quantity']
                if product.stock_quantity < quantity:
                    raise serializers.ValidationError(f"Not enough stock for {product.name}.")
                SalesOrderItem.objects.create(sales_order=sales_order, **item_data)
                product.stock_quantity -= quantity
                product.save()
                InventoryTransaction.objects.create(
                    product=product,
                    transaction_type=InventoryTransaction.TransactionType.SALE,
                    quantity_change=-quantity,
                    user=user
                )
        return sales_order


# === Logging Serializer ===
        
class InventoryTransactionSerializer(serializers.ModelSerializer):
    """Serializer for reading transaction logs."""
    product = ProductSerializer(read_only=True)
    user = UserSerializer(read_only=True)
    class Meta:
        model = InventoryTransaction
        fields = ['id', 'product', 'transaction_type', 'quantity_change', 'timestamp', 'user', 'reason']
\`\`\`


## inventory/tests.py

\`\`\`
from django.test import TestCase
from rest_framework.test import APIClient
from rest_framework import status
from .models import User, Product, Supplier, PurchaseOrder, PurchaseOrderItem, SalesOrder, SalesOrderItem, InventoryTransaction

class ComprehensiveAPITests(TestCase):

    def setUp(self):
        """Set up the necessary objects for all tests."""
        # Create users with different roles
        self.admin_user = User.objects.create_superuser(username='testadmin', password='password123', role='Admin', email='admin@test.com')
        self.manager_user = User.objects.create_user(username='testmanager', password='password123', role='Manager', email='manager@test.com')
        self.staff_user = User.objects.create_user(username='teststaff', password='password123', role='Staff', email='staff@test.com')

        # Create API clients
        self.client = APIClient() # Unauthenticated client
        self.manager_client = APIClient()
        self.staff_client = APIClient()

        # Authenticate clients
        self.manager_client.force_authenticate(user=self.manager_user)
        self.staff_client.force_authenticate(user=self.staff_user)
        
        # Create initial data
        self.supplier = Supplier.objects.create(name="Test Supplier", email="supplier@test.com", phone="12345")
        self.product = Product.objects.create(name="Test Keyboard", sku="KEY-001", stock_quantity=100, unit_price=50.00)

    # === Authentication and Roles Tests ===
    def test_unauthenticated_access_denied(self):
        """Ensure unauthenticated users get 401 Unauthorized for protected endpoints."""
        response = self.client.get('/api/products/')
        self.assertEqual(response.status_code, status.HTTP_401_UNAUTHORIZED)

    def test_user_registration(self):
        """Test the user registration endpoint."""
        data = {"username": "newuser", "password": "newpassword123", "password2": "newpassword123", "email": "new@test.com", "role": "Staff", "first_name": "New", "last_name": "User"}
        response = self.client.post('/api/register/', data, format='json')
        self.assertEqual(response.status_code, status.HTTP_201_CREATED)
        self.assertEqual(User.objects.count(), 4)

    # === Product and Supplier RBAC Tests ===
    def test_staff_can_list_products(self):
        """Staff should have read-only access to products."""
        response = self.staff_client.get('/api/products/')
        self.assertEqual(response.status_code, status.HTTP_200_OK)

    def test_staff_cannot_create_product(self):
        """Staff should be forbidden from creating products."""
        data = {"name": "Staff Mouse", "sku": "MOUSE-STAFF", "stock_quantity": 10, "unit_price": 10.00}
        response = self.staff_client.post('/api/products/', data, format='json')
        self.assertEqual(response.status_code, status.HTTP_403_FORBIDDEN)
        
    def test_manager_can_create_product(self):
        """Managers should be able to create products."""
        data = {"name": "Manager Mouse", "sku": "MOUSE-MANAGER", "stock_quantity": 20, "unit_price": 20.00}
        response = self.manager_client.post('/api/products/', data, format='json')
        self.assertEqual(response.status_code, status.HTTP_201_CREATED)
        self.assertTrue(Product.objects.filter(sku="MOUSE-MANAGER").exists())

    # === Purchase Order Workflow Test ===
    def test_receive_purchase_order_updates_stock(self):
        """Test that receiving a PO increases stock and creates a transaction log."""
        initial_stock = self.product.stock_quantity
        order_quantity = 50
        
        po = PurchaseOrder.objects.create(supplier=self.supplier, status='Pending')
        PurchaseOrderItem.objects.create(purchase_order=po, product=self.product, quantity=order_quantity, unit_price=40.00)
        
        response = self.manager_client.post(f'/api/purchase-orders/{po.id}/receive/')
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        
        # Refresh product from DB
        self.product.refresh_from_db()
        
        # Check stock quantity
        self.assertEqual(self.product.stock_quantity, initial_stock + order_quantity)
        
        # Check transaction log
        self.assertTrue(InventoryTransaction.objects.filter(product=self.product, transaction_type='Purchase', quantity_change=order_quantity).exists())
        
        # Check PO status
        po.refresh_from_db()
        self.assertEqual(po.status, 'Received')

    # === Sales Order Workflow Tests ===
    def test_sales_order_deducts_stock(self):
        """Test that creating a sales order decreases stock and creates a transaction log."""
        initial_stock = self.product.stock_quantity
        sale_quantity = 10
        
        so_data = {
            "customer_name": "Test Customer",
            "items": [{"product": self.product.id, "quantity": sale_quantity, "unit_price": self.product.unit_price}]
        }
        
        response = self.staff_client.post('/api/sales-orders/', so_data, format='json')
        self.assertEqual(response.status_code, status.HTTP_201_CREATED)
        
        self.product.refresh_from_db()
        self.assertEqual(self.product.stock_quantity, initial_stock - sale_quantity)
        self.assertTrue(InventoryTransaction.objects.filter(product=self.product, transaction_type='Sale', quantity_change=-sale_quantity).exists())

    def test_cannot_sell_out_of_stock_product(self):
        """Test that an order for more items than in stock fails."""
        sale_quantity = self.product.stock_quantity + 1
        
        so_data = {
            "customer_name": "Greedy Customer",
            "items": [{"product": self.product.id, "quantity": sale_quantity, "unit_price": self.product.unit_price}]
        }
        
        response = self.staff_client.post('/api/sales-orders/', so_data, format='json')
        self.assertEqual(response.status_code, status.HTTP_400_BAD_REQUEST)

    # === Reporting Test ===
    def test_transaction_report_filtering(self):
        """Test that the transaction report can be filtered by type."""
        # Create a sale transaction
        SalesOrder.objects.create(customer_name="Filter Test Customer")
        # (This assumes the create logic inside the serializer works, which is tested above)
        
        # Filter for only 'Sale' transactions
        response = self.staff_client.get('/api/transactions/?transaction_type=Sale')
        self.assertEqual(response.status_code, status.HTTP_200_OK)
        # Check that all returned transactions are of type 'Sale'
        for transaction in response.data:
            self.assertEqual(transaction['transaction_type'], 'Sale')
\`\`\`


## inventory/urls.py

\`\`\`

"""
URL configuration for the inventory app.

This file defines the API endpoints that are specific to the 'inventory'
application. It uses a DRF DefaultRouter to automatically generate the standard
CRUD routes for each ViewSet.
"""

from django.urls import path, include
from rest_framework.routers import DefaultRouter

from .views import (
    DashboardStatsView,
    InventoryTransactionViewSet,
    ProductViewSet,
    PurchaseOrderViewSet,
    SalesOrderViewSet,
    SupplierViewSet,
    UserProfileView,
    ChangePasswordView,
    UserViewSet,
    UserProfileView, 
    ChangePasswordView
)



router = DefaultRouter()
router.register(r'users', UserViewSet, basename='user')
router.register(r'suppliers', SupplierViewSet, basename='supplier')
router.register(r'products', ProductViewSet, basename='product')
router.register(r'purchase-orders', PurchaseOrderViewSet, basename='purchaseorder')
router.register(r'sales-orders', SalesOrderViewSet, basename='salesorder')
router.register(r'transactions', InventoryTransactionViewSet, basename='inventorytransaction')


urlpatterns = [
    path('dashboard-stats/', DashboardStatsView.as_view(), name='dashboard-stats'),
    path('users/me/', UserProfileView.as_view(), name='user-profile'),
    path('change-password/', ChangePasswordView.as_view(), name='change-password'),
    path('users/me/', UserProfileView.as_view(), name='user-profile'),
    path('change-password/', ChangePasswordView.as_view(), name='change-password'),
    path('', include(router.urls)),
]
\`\`\`


## inventory/views.py

\`\`\`
# import io

# from django.db import models, transaction
# from django.http import Http404, HttpResponse
# from django_filters.rest_framework import DjangoFilterBackend
# from rest_framework import generics, viewsets
# from rest_framework.decorators import action
# from rest_framework.permissions import AllowAny, IsAuthenticated
# from rest_framework.response import Response
# from rest_framework.views import APIView
# from rest_framework_simplejwt.views import TokenObtainPairView

# from .models import (InventoryTransaction, Product, PurchaseOrder, SalesOrder,
#                    Supplier, User)
# from .permissions import IsAdminOrManager, IsStaffReadOnly
# from .serializers import (InventoryTransactionSerializer,
#                           MyTokenObtainPairSerializer, ProductSerializer,
#                           PurchaseOrderSerializer, PurchaseOrderWriteSerializer,
#                           RegisterSerializer, SalesOrderSerializer,
#                           SalesOrderWriteSerializer, SupplierSerializer,
#                           UserSerializer)


# class MyTokenObtainPairView(TokenObtainPairView):
#     """Custom token obtain pair view to include user data in the response."""
#     serializer_class = MyTokenObtainPairSerializer


# class RegisterView(generics.CreateAPIView):
#     """API view for user registration."""
#     queryset = User.objects.all()
#     permission_classes = (AllowAny,)
#     serializer_class = RegisterSerializer


# class DashboardStatsView(APIView):
#     """API view to provide statistics for the main dashboard."""
#     permission_classes = [IsAuthenticated]

#     def get(self, request, *args, **kwargs):
#         """Returns key inventory metrics."""
#         total_products = Product.objects.count()
#         low_stock_items = Product.objects.filter(
#             stock_quantity__lte=models.F('min_stock_level')
#         )
#         recent_transactions = InventoryTransaction.objects.order_by('-timestamp')[:5]

#         data = {
#             'total_products': total_products,
#             'low_stock_items': ProductSerializer(low_stock_items, many=True).data,
#             'recent_transactions': InventoryTransactionSerializer(
#                 recent_transactions, many=True
#             ).data,
#         }
#         return Response(data)




# class UserViewSet(viewsets.ReadOnlyModelViewSet):
#     """Read-only API endpoint for users."""
#     queryset = User.objects.all()
#     serializer_class = UserSerializer
#     permission_classes = [IsAuthenticated]


# class SupplierViewSet(viewsets.ModelViewSet):
#     """API endpoint that allows suppliers to be viewed or edited."""
#     queryset = Supplier.objects.all()
#     serializer_class = SupplierSerializer
#     permission_classes = [IsStaffReadOnly]


# class ProductViewSet(viewsets.ModelViewSet):
#     """API endpoint that allows products to be viewed or edited."""
#     queryset = Product.objects.all()
#     serializer_class = ProductSerializer
#     permission_classes = [IsStaffReadOnly]


# class PurchaseOrderViewSet(viewsets.ModelViewSet):
#     """
#     API endpoint for purchase orders.
#     Uses different serializers for read and write actions.
#     """
#     queryset = PurchaseOrder.objects.all().prefetch_related('items__product', 'supplier')
#     permission_classes = [IsAdminOrManager]

#     def get_serializer_class(self):
#         """Return appropriate serializer class based on the action."""
#         if self.action in ['create', 'update']:
#             return PurchaseOrderWriteSerializer
#         return PurchaseOrderSerializer

#     @action(detail=True, methods=['post'])
#     @transaction.atomic
#     def receive(self, request, pk=None):
#         """Mark a purchase order as 'Received' and update stock levels."""
#         purchase_order = self.get_object()
#         if purchase_order.status == 'Received':
#             return Response(
#                 {'error': 'This order has already been received.'},
#                 status=400
#             )

#         for item in purchase_order.items.all():
#             product = item.product
#             product.stock_quantity += item.quantity
#             product.save()

#             InventoryTransaction.objects.create(
#                 product=product,
#                 transaction_type='Purchase',
#                 quantity_change=item.quantity,
#                 user=request.user,
#                 reason=f'Received from PO-{purchase_order.id}'
#             )

#         purchase_order.status = 'Received'
#         purchase_order.save()
#         return Response(self.get_serializer(purchase_order).data)


# class SalesOrderViewSet(viewsets.ModelViewSet):
#     """
#     API endpoint for sales orders.
#     Uses different serializers for read and write actions.
#     """
#     queryset = SalesOrder.objects.all().prefetch_related('items__product')
#     permission_classes = [IsAuthenticated]

#     def get_serializer_class(self):
#         """Return appropriate serializer class based on the action."""
#         if self.action in ['create', 'update']:
#             return SalesOrderWriteSerializer
#         return SalesOrderSerializer


# class InventoryTransactionViewSet(viewsets.ReadOnlyModelViewSet):
#     """
#     Read-only API endpoint for inventory transactions.
#     Supports filtering by date range and transaction type.
#     """
#     queryset = InventoryTransaction.objects.all().order_by('-timestamp')
#     serializer_class = InventoryTransactionSerializer
#     permission_classes = [IsAuthenticated]
#     filter_backends = [DjangoFilterBackend]
#     filterset_fields = {
#         'timestamp': ['gte', 'lte'],
#         'transaction_type': ['exact']
#     }


"""
Views for the inventory app.

This file contains all the API endpoints for the application, including
user management, core model CRUD operations, and special actions like
receiving orders and generating reports.
"""

# Standard Library Imports


from rest_framework import viewsets, generics
from rest_framework.permissions import IsAuthenticated, AllowAny
from rest_framework.views import APIView
from rest_framework.response import Response
from rest_framework.decorators import action
from django.db import transaction, models
from django.http import HttpResponse, Http404
from django_filters.rest_framework import DjangoFilterBackend
from rest_framework_simplejwt.views import TokenObtainPairView
from rest_framework import status
import io
from django.dispatch import receiver
from django_rest_passwordreset.signals import reset_password_token_created


from .models import User, Supplier, Product, PurchaseOrder, SalesOrder, InventoryTransaction
from .permissions import IsAdminOrManager, IsStaffReadOnly
from .serializers import (
    UserSerializer, SupplierSerializer, ProductSerializer, RegisterSerializer,
    PurchaseOrderSerializer, PurchaseOrderWriteSerializer,
    SalesOrderSerializer, SalesOrderWriteSerializer, InventoryTransactionSerializer,
    MyTokenObtainPairSerializer, UserProfileSerializer, ChangePasswordSerializer
)

# === Authentication & Profile Management Views ===

class MyTokenObtainPairView(TokenObtainPairView):
    """Custom token view to include user role in the JWT response."""
    serializer_class = MyTokenObtainPairSerializer


class RegisterView(generics.CreateAPIView):
    """Public endpoint for new user registration."""
    queryset = User.objects.all()
    permission_classes = (AllowAny,)
    serializer_class = RegisterSerializer


class UserProfileView(generics.RetrieveUpdateAPIView):
    """Endpoint for the authenticated user to view and update their own profile."""
    queryset = User.objects.all()
    serializer_class = UserProfileSerializer
    permission_classes = [IsAuthenticated]

    def get_object(self):
        """Returns the currently authenticated user."""
        return self.request.user


class ChangePasswordView(APIView):
    """
    An endpoint for an authenticated user to change their own password.
    """
    permission_classes = [IsAuthenticated]

    def put(self, request, *args, **kwargs):
        serializer = ChangePasswordSerializer(data=request.data, context={'request': request})
        if serializer.is_valid():
            serializer.save()
            return Response({"message": "Password updated successfully"}, status=status.HTTP_200_OK)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)



# === Specialized API Views ===

class DashboardStatsView(APIView):
    """Endpoint to provide aggregated statistics for the main dashboard."""
    permission_classes = [IsAuthenticated]

    def get(self, request, *args, **kwargs):
        """Returns key inventory metrics in a single response."""
        total_products = Product.objects.count()
        low_stock_items = Product.objects.filter(
            stock_quantity__lte=models.F('min_stock_level')
        )
        recent_transactions = InventoryTransaction.objects.order_by('-timestamp')[:5]

        data = {
            'total_products': total_products,
            'low_stock_items': ProductSerializer(low_stock_items, many=True).data,
            'recent_transactions': InventoryTransactionSerializer(
                recent_transactions, many=True
            ).data,
        }
        return Response(data)



# === Core Model ViewSets ===

class UserViewSet(viewsets.ReadOnlyModelViewSet):
    """Read-only endpoint for viewing user data."""
    queryset = User.objects.all()
    serializer_class = UserSerializer
    permission_classes = [IsAuthenticated]


class SupplierViewSet(viewsets.ModelViewSet):
    """CRUD endpoint for suppliers with role-based permissions."""
    queryset = Supplier.objects.all()
    serializer_class = SupplierSerializer
    permission_classes = [IsStaffReadOnly]


class ProductViewSet(viewsets.ModelViewSet):
    """CRUD endpoint for products with role-based permissions."""
    queryset = Product.objects.all()
    serializer_class = ProductSerializer
    permission_classes = [IsStaffReadOnly]


class PurchaseOrderViewSet(viewsets.ModelViewSet):
    """CRUD endpoint for purchase orders.
    Read access for all authenticated users; write actions limited to Admin/Manager.
    """
    queryset = PurchaseOrder.objects.all().prefetch_related('items__product', 'supplier')
    permission_classes = [IsStaffReadOnly]

    def get_serializer_class(self):
        """Return appropriate serializer class based on the action."""
        if self.action in ['create', 'update']:
            return PurchaseOrderWriteSerializer
        return PurchaseOrderSerializer

    @action(detail=True, methods=['post'])
    @transaction.atomic
    def receive(self, request, pk=None):
        """Custom action to mark a PO as 'Received' and update stock levels."""
        purchase_order = self.get_object()
        if purchase_order.status == PurchaseOrder.Status.RECEIVED:
            return Response(
                {'error': 'This order has already been received.'},
                status=status.HTTP_400_BAD_REQUEST
            )

        for item in purchase_order.items.all():
            product = item.product
            product.stock_quantity += item.quantity
            product.save()

            InventoryTransaction.objects.create(
                product=product,
                transaction_type=InventoryTransaction.TransactionType.PURCHASE,
                quantity_change=item.quantity,
                user=request.user,
                reason=f'Received from PO-{purchase_order.id}'
            )

        purchase_order.status = PurchaseOrder.Status.RECEIVED
        purchase_order.save()
        return Response(self.get_serializer(purchase_order).data)


class SalesOrderViewSet(viewsets.ModelViewSet):
    """CRUD endpoint for sales orders, accessible by all authenticated users."""
    queryset = SalesOrder.objects.all().prefetch_related('items__product')
    permission_classes = [IsAuthenticated]

    def get_serializer_class(self):
        """Return appropriate serializer class based on the action."""
        if self.action in ['create', 'update']:
            return SalesOrderWriteSerializer
        return SalesOrderSerializer

    def get_serializer_context(self):
        """Pass request context to the serializer."""
        return {'request': self.request}


class InventoryTransactionViewSet(viewsets.ReadOnlyModelViewSet):
    """Read-only endpoint for transaction logs with filtering enabled."""
    queryset = InventoryTransaction.objects.all()
    serializer_class = InventoryTransactionSerializer
    permission_classes = [IsAuthenticated]
    filter_backends = [DjangoFilterBackend]
    filterset_fields = {
        'timestamp': ['gte', 'lte'],
        'transaction_type': ['exact']
    }
    

@receiver(reset_password_token_created)
def password_reset_token_created(sender, instance, reset_password_token, *args, **kwargs):
    """
    This function is a "listener" that runs when a password reset token is created.
    We are using it to print information to the console to confirm the process is working.
    """
    print("\n\n==============================================")
    print("--- PASSWORD RESET SIGNAL RECEIVED ---")
    print(f"Token: {reset_password_token.key}")
    print(f"User: {reset_password_token.user.email}")
    print("==============================================\n\n")

\`\`\`


## manage.py

\`\`\`
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'backend.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()

\`\`\`


## requirements.txt

\`\`\`
asgiref==3.9.1
Brotli==1.1.0
cffi==1.17.1
cssselect2==0.8.0
Django==5.2.5
django-cors-headers==4.7.0
django-environ==0.12.0
django-filter==25.1
django-rest-passwordreset==1.5.0
djangorestframework==3.16.1
djangorestframework_simplejwt==5.5.1
Faker==37.5.3
fonttools==4.59.1
mysqlclient==2.2.7
pillow==11.3.0
pycparser==2.22
pydyf==0.11.0
PyJWT==2.10.1
pyphen==0.17.2
sqlparse==0.5.3
tinycss2==1.4.0
tinyhtml5==2.0.0
tzdata==2025.2
weasyprint==66.0
webencodings==0.5.1
zopfli==0.2.3.post1

\`\`\`


## seed_script.py

\`\`\`
import os
import django
import random
from decimal import Decimal
from faker import Faker

# Set up the Django environment
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'backend.settings')
django.setup()

from inventory.models import (
    Supplier, Product, PurchaseOrder, PurchaseOrderItem, 
    SalesOrder, SalesOrderItem, InventoryTransaction
)

def seed_data(num_suppliers=15, num_products=50, num_po=20, num_so=35):
    """
    Seeds the database with a specified number of related objects.
    """
    print("Starting to seed the database...")
    fake = Faker()

    # --- Clean Database ---
    print("Deleting old data...")
    SalesOrderItem.objects.all().delete()
    PurchaseOrderItem.objects.all().delete()
    InventoryTransaction.objects.all().delete()
    SalesOrder.objects.all().delete()
    PurchaseOrder.objects.all().delete()
    Product.objects.all().delete()
    Supplier.objects.all().delete()
    
    # --- Create Suppliers ---
    suppliers = []
    for _ in range(num_suppliers):
        supplier = Supplier.objects.create(
            name=fake.company(),
            contact_info=fake.address(),
            email=fake.unique.email(),
            phone=fake.phone_number()
        )
        suppliers.append(supplier)
    print(f"Successfully created {num_suppliers} suppliers.")

    # --- Create Products ---
    product_categories = ['Electronics', 'Office Supplies', 'Furniture', 'Hardware', 'Software']
    products = []
    for i in range(num_products):
        product = Product.objects.create(
            name=f"{fake.bs().title()} - Model {i}",
            sku=fake.unique.bothify(text='SKU-????-####').upper(),
            category=random.choice(product_categories),
            unit_price=round(random.uniform(20.0, 800.0), 2),
            stock_quantity=random.randint(50, 250),
            min_stock_level=random.randint(10, 25)
        )
        products.append(product)
    print(f"Successfully created {num_products} products.")

    # --- Create Purchase Orders ---
    for _ in range(num_po):
        supplier = random.choice(suppliers)
        po = PurchaseOrder.objects.create(
            supplier=supplier,
            status=random.choice(['Pending', 'Shipped', 'Received'])
        )
        for _ in range(random.randint(1, 5)):
            product = random.choice(products)
            quantity = random.randint(10, 50)
            
            # **THE FIX IS HERE**
            # Convert both numbers to Decimal before multiplying
            product_price = Decimal(str(product.unit_price))
            discount = Decimal(str(round(random.uniform(0.7, 0.9), 2)))
            
            PurchaseOrderItem.objects.create(
                purchase_order=po,
                product=product,
                quantity=quantity,
                unit_price=product_price * discount
            )
            if po.status == 'Received':
                product.stock_quantity += quantity
                product.save()
                InventoryTransaction.objects.create(
                    product=product,
                    transaction_type='Purchase',
                    quantity_change=quantity,
                    reason=f'Stock from PO-{po.id}'
                )
    print(f"Successfully created {num_po} purchase orders.")

    # --- Create Sales Orders ---
    for _ in range(num_so):
        so = SalesOrder.objects.create(
            customer_name=fake.name(),
            status=random.choice(['Pending', 'Fulfilled'])
        )
        for _ in range(random.randint(1, 3)):
            product = random.choice(products)
            if product.stock_quantity > 5:
                quantity_to_sell = random.randint(1, min(5, product.stock_quantity))
                SalesOrderItem.objects.create(
                    sales_order=so,
                    product=product,
                    quantity=quantity_to_sell,
                    unit_price=product.unit_price
                )
                if so.status == 'Fulfilled':
                    product.stock_quantity -= quantity_to_sell
                    product.save()
                    InventoryTransaction.objects.create(
                        product=product,
                        transaction_type='Sale',
                        quantity_change=-quantity_to_sell,
                    )
    print(f"Successfully created {num_so} sales orders and updated stock.")

    print("Data seeding complete!")

if __name__ == '__main__':
    seed_data()
\`\`\`
