{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Table,Spinner,Alert,Button,Card,Badge}from'react-bootstrap';import{Link}from'react-router-dom';import{getSalesOrders}from'../services/api';import RoleRequired from'../components/RoleRequired';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SalesOrdersPage(){const[salesOrders,setSalesOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const handlePrintInvoice=orderId=>{// This function now simply opens the new invoice page in a new tab\nwindow.open(\"/sales-orders/\".concat(orderId,\"/invoice\"),'_blank');};useEffect(()=>{const fetchSalesOrders=async()=>{try{const response=await getSalesOrders();setSalesOrders(response.data);}catch(err){setError('Failed to fetch sales orders.');}finally{setLoading(false);}};fetchSalesOrders();},[]);if(loading)return/*#__PURE__*/_jsx(Container,{className:\"text-center mt-5\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\"})});if(error)return/*#__PURE__*/_jsx(Container,{className:\"mt-5\",children:/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error})});return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center my-4\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Sales Orders\"}),/*#__PURE__*/_jsx(RoleRequired,{allowedRoles:['Admin','Manager'],children:/*#__PURE__*/_jsx(Button,{as:Link,to:\"/sales-orders/create\",variant:\"primary\",children:\"Create Sales Order\"})})]}),salesOrders.map(order=>/*#__PURE__*/_jsxs(Card,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Card.Header,{as:\"h5\",className:\"d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"SO-\",order.id,\" | Customer: \",order.customer_name||'N/A']}),/*#__PURE__*/_jsx(Badge,{bg:order.status==='Fulfilled'?'success':'warning',children:order.status})]}),/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Card.Text,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Order Date:\"}),\" \",new Date(order.order_date).toLocaleDateString()]}),/*#__PURE__*/_jsx(\"h6\",{children:\"Items:\"}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,size:\"sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Product\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Unit Price\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:order.items.map(item=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[item.product.name,\" (\",item.product.sku,\")\"]}),/*#__PURE__*/_jsx(\"td\",{children:item.quantity}),/*#__PURE__*/_jsxs(\"td\",{children:[\"\\u20B9\",item.unit_price]})]},item.id))})]})]}),/*#__PURE__*/_jsx(Card.Footer,{className:\"text-end\",children:/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",onClick:()=>handlePrintInvoice(order.id),children:\"View Printable Invoice\"})})]},order.id))]});}export default SalesOrdersPage;","map":{"version":3,"names":["React","useState","useEffect","Container","Table","Spinner","Alert","Button","Card","Badge","Link","getSalesOrders","RoleRequired","jsx","_jsx","jsxs","_jsxs","SalesOrdersPage","salesOrders","setSalesOrders","loading","setLoading","error","setError","handlePrintInvoice","orderId","window","open","concat","fetchSalesOrders","response","data","err","className","children","animation","variant","allowedRoles","as","to","map","order","Header","id","customer_name","bg","status","Body","Text","Date","order_date","toLocaleDateString","striped","bordered","size","items","item","product","name","sku","quantity","unit_price","Footer","onClick"],"sources":["/Users/abr/DAMN/inventory-system/frontend/src/pages/SalesOrdersPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Container, Table, Spinner, Alert, Button, Card, Badge } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport { getSalesOrders } from '../services/api';\nimport RoleRequired from '../components/RoleRequired';\n\nfunction SalesOrdersPage() {\n  const [salesOrders, setSalesOrders] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n\n  const handlePrintInvoice = (orderId) => {\n    // This function now simply opens the new invoice page in a new tab\n    window.open(`/sales-orders/${orderId}/invoice`, '_blank');\n  };\n  \n  useEffect(() => {\n    const fetchSalesOrders = async () => {\n      try {\n        const response = await getSalesOrders();\n        setSalesOrders(response.data);\n      } catch (err) {\n        setError('Failed to fetch sales orders.');\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchSalesOrders();\n  }, []);\n\n  if (loading) return <Container className=\"text-center mt-5\"><Spinner animation=\"border\" /></Container>;\n  if (error) return <Container className=\"mt-5\"><Alert variant=\"danger\">{error}</Alert></Container>;\n\n  return (\n    <Container>\n      <div className=\"d-flex justify-content-between align-items-center my-4\">\n        <h1>Sales Orders</h1>\n        <RoleRequired allowedRoles={['Admin', 'Manager']}>\n          <Button as={Link} to=\"/sales-orders/create\" variant=\"primary\">Create Sales Order</Button>\n        </RoleRequired>\n      </div>\n      \n      {salesOrders.map((order) => (\n        <Card className=\"mb-3\" key={order.id}>\n          <Card.Header as=\"h5\" className=\"d-flex justify-content-between align-items-center\">\n             <span>SO-{order.id} | Customer: {order.customer_name || 'N/A'}</span>\n             <Badge bg={order.status === 'Fulfilled' ? 'success' : 'warning'}>{order.status}</Badge>\n          </Card.Header>\n          <Card.Body>\n            <Card.Text><strong>Order Date:</strong> {new Date(order.order_date).toLocaleDateString()}</Card.Text>\n            <h6>Items:</h6>\n            <Table striped bordered size=\"sm\">\n              <thead><tr><th>Product</th><th>Quantity</th><th>Unit Price</th></tr></thead>\n              <tbody>\n                {order.items.map((item) => (\n                  <tr key={item.id}>\n                    <td>{item.product.name} ({item.product.sku})</td>\n                    <td>{item.quantity}</td>\n                    <td>â‚¹{item.unit_price}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </Table>\n          </Card.Body>\n          <Card.Footer className=\"text-end\">\n            <Button variant=\"outline-secondary\" onClick={() => handlePrintInvoice(order.id)}>\n                View Printable Invoice\n            </Button>\n          </Card.Footer>\n        </Card>\n      ))}\n    </Container>\n  );\n}\n\nexport default SalesOrdersPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}