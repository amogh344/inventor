{"ast":null,"code":"// src/pages/ProductsPage.js\nimport React,{useState,useEffect}from'react';import{Container,Table,Spinner,Alert,Button,ButtonGroup}from'react-bootstrap';import{getProducts,createProduct,updateProduct,deleteProduct,getQRCode}from'../services/api';import ProductFormModal from'../components/ProductFormModal';import RoleRequired from'../components/RoleRequired';import AuthenticatedImage from'../components/AuthenticatedImage';// Import our new component\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProductsPage(){const[products,setProducts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[showModal,setShowModal]=useState(false);const[selectedProduct,setSelectedProduct]=useState(null);const fetchProducts=async()=>{try{setLoading(true);const response=await getProducts();setProducts(response.data);setError('');}catch(err){setError('Failed to fetch products.');console.error(err);}finally{setLoading(false);}};useEffect(()=>{fetchProducts();},[]);const handleShowCreateModal=()=>{setSelectedProduct(null);setShowModal(true);};const handleShowEditModal=product=>{setSelectedProduct(product);setShowModal(true);};const handleCloseModal=()=>{setShowModal(false);setSelectedProduct(null);};const handleSave=async formData=>{try{if(selectedProduct){await updateProduct(selectedProduct.id,formData);}else{await createProduct(formData);}fetchProducts();handleCloseModal();}catch(err){setError(selectedProduct?'Failed to update product.':'Failed to create product.');}};const handleDelete=async id=>{if(window.confirm('Are you sure?')){try{await deleteProduct(id);fetchProducts();}catch(err){setError('Failed to delete product.');}}};if(loading)return/*#__PURE__*/_jsx(Container,{className:\"text-center mt-5\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\"})});//     <Container>\n//       <div className=\"d-flex justify-content-between align-items-center my-4\">\n//         <h1>Products</h1>\n//         <RoleRequired allowedRoles={['Admin', 'Manager']}>\n//             <Button variant=\"primary\" onClick={handleShowCreateModal}>Create Product</Button>\n//         </RoleRequired>\n//       </div>\n//       {error && <Alert variant=\"danger\">{error}</Alert>}\n//       <Table striped bordered hover responsive>\n//         <thead>\n//           <tr>\n//             <th>SKU</th><th>Name</th><th>Barcode</th><th>Stock</th>\n//             <RoleRequired allowedRoles={['Admin', 'Manager']}>\n//                 <th>Actions</th>\n//             </RoleRequired>\n//           </tr>\n//         </thead>\n//         <tbody>\n//           {products.map((product) => (\n//             <tr key={product.id}>\n//               <td>{product.sku}</td>\n//               <td>{product.name}</td>\n//               <td>\n//                 <AuthenticatedImage \n//                   fetchImage={() => getBarcode(product.sku)}\n//                   alt={`Barcode for ${product.sku}`}\n//                   style={{ height: '40px' }}\n//                 />\n//               </td>\n//               <td>{product.stock_quantity}</td>\n//               <RoleRequired allowedRoles={['Admin', 'Manager']}>\n//                 <td>\n//                     <ButtonGroup>\n//                     <Button variant=\"outline-secondary\" size=\"sm\" onClick={() => handleShowEditModal(product)}>Edit</Button>\n//                     <Button variant=\"outline-danger\" size=\"sm\" onClick={() => handleDelete(product.id)}>Delete</Button>\n//                     </ButtonGroup>\n//                 </td>\n//               </RoleRequired>\n//             </tr>\n//           ))}\n//         </tbody>\n//       </Table>\n//       <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />\n//     </Container>\nreturn/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-center my-4\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Products\"}),/*#__PURE__*/_jsx(RoleRequired,{allowedRoles:['Admin','Manager'],children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleShowCreateModal,children:\"Create Product\"})})]}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,responsive:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"SKU\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"QR Code\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Stock\"}),/*#__PURE__*/_jsx(RoleRequired,{allowedRoles:['Admin','Manager'],children:/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:products.map(product=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:product.sku}),/*#__PURE__*/_jsx(\"td\",{children:product.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(AuthenticatedImage,{fetchImage:()=>getQRCode(product.sku),alt:\"QR Code for \".concat(product.sku),style:{height:'50px',width:'50px'}})}),/*#__PURE__*/_jsx(\"td\",{children:product.stock_quantity}),/*#__PURE__*/_jsx(RoleRequired,{allowedRoles:['Admin','Manager'],children:/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(ButtonGroup,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-secondary\",size:\"sm\",onClick:()=>handleShowEditModal(product),children:\"Edit\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",size:\"sm\",onClick:()=>handleDelete(product.id),children:\"Delete\"})]})})})]},product.id))})]}),/*#__PURE__*/_jsx(ProductFormModal,{show:showModal,handleClose:handleCloseModal,product:selectedProduct,onSave:handleSave})]});}export default ProductsPage;","map":{"version":3,"names":["React","useState","useEffect","Container","Table","Spinner","Alert","Button","ButtonGroup","getProducts","createProduct","updateProduct","deleteProduct","getQRCode","ProductFormModal","RoleRequired","AuthenticatedImage","jsx","_jsx","jsxs","_jsxs","ProductsPage","products","setProducts","loading","setLoading","error","setError","showModal","setShowModal","selectedProduct","setSelectedProduct","fetchProducts","response","data","err","console","handleShowCreateModal","handleShowEditModal","product","handleCloseModal","handleSave","formData","id","handleDelete","window","confirm","className","children","animation","allowedRoles","variant","onClick","striped","bordered","hover","responsive","map","sku","name","fetchImage","alt","concat","style","height","width","stock_quantity","size","show","handleClose","onSave"],"sources":["/Users/abr/inventor/frontend/src/pages/ProductsPage.js"],"sourcesContent":["// src/pages/ProductsPage.js\nimport React, { useState, useEffect } from 'react';\nimport { Container, Table, Spinner, Alert, Button, ButtonGroup } from 'react-bootstrap';\nimport { getProducts, createProduct, updateProduct, deleteProduct, getQRCode} from '../services/api';\nimport ProductFormModal from '../components/ProductFormModal';\nimport RoleRequired from '../components/RoleRequired';\nimport AuthenticatedImage from '../components/AuthenticatedImage'; // Import our new component\n\n\n\nfunction ProductsPage() {\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [showModal, setShowModal] = useState(false);\n  const [selectedProduct, setSelectedProduct] = useState(null);\n\n  const fetchProducts = async () => {\n    try { setLoading(true); const response = await getProducts(); setProducts(response.data); setError(''); } \n    catch (err) { setError('Failed to fetch products.'); console.error(err); } \n    finally { setLoading(false); }\n  };\n\n  useEffect(() => { fetchProducts(); }, []);\n\n  const handleShowCreateModal = () => { setSelectedProduct(null); setShowModal(true); };\n  const handleShowEditModal = (product) => { setSelectedProduct(product); setShowModal(true); };\n  const handleCloseModal = () => { setShowModal(false); setSelectedProduct(null); };\n\n  const handleSave = async (formData) => {\n    try {\n      if (selectedProduct) { await updateProduct(selectedProduct.id, formData); } \n      else { await createProduct(formData); }\n      fetchProducts(); handleCloseModal();\n    } catch (err) { setError(selectedProduct ? 'Failed to update product.' : 'Failed to create product.'); }\n  };\n\n  const handleDelete = async (id) => {\n    if (window.confirm('Are you sure?')) {\n      try { await deleteProduct(id); fetchProducts(); } \n      catch (err) { setError('Failed to delete product.'); }\n    }\n  };\n\n  if (loading) return <Container className=\"text-center mt-5\"><Spinner animation=\"border\" /></Container>;\n\n//     <Container>\n//       <div className=\"d-flex justify-content-between align-items-center my-4\">\n//         <h1>Products</h1>\n//         <RoleRequired allowedRoles={['Admin', 'Manager']}>\n//             <Button variant=\"primary\" onClick={handleShowCreateModal}>Create Product</Button>\n//         </RoleRequired>\n//       </div>\n//       {error && <Alert variant=\"danger\">{error}</Alert>}\n//       <Table striped bordered hover responsive>\n//         <thead>\n//           <tr>\n//             <th>SKU</th><th>Name</th><th>Barcode</th><th>Stock</th>\n//             <RoleRequired allowedRoles={['Admin', 'Manager']}>\n//                 <th>Actions</th>\n//             </RoleRequired>\n//           </tr>\n//         </thead>\n//         <tbody>\n//           {products.map((product) => (\n//             <tr key={product.id}>\n//               <td>{product.sku}</td>\n//               <td>{product.name}</td>\n//               <td>\n//                 <AuthenticatedImage \n//                   fetchImage={() => getBarcode(product.sku)}\n//                   alt={`Barcode for ${product.sku}`}\n//                   style={{ height: '40px' }}\n//                 />\n//               </td>\n//               <td>{product.stock_quantity}</td>\n//               <RoleRequired allowedRoles={['Admin', 'Manager']}>\n//                 <td>\n//                     <ButtonGroup>\n//                     <Button variant=\"outline-secondary\" size=\"sm\" onClick={() => handleShowEditModal(product)}>Edit</Button>\n//                     <Button variant=\"outline-danger\" size=\"sm\" onClick={() => handleDelete(product.id)}>Delete</Button>\n//                     </ButtonGroup>\n//                 </td>\n//               </RoleRequired>\n//             </tr>\n//           ))}\n//         </tbody>\n//       </Table>\n//       <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />\n//     </Container>\n\nreturn (\n    <Container>\n      <div className=\"d-flex justify-content-between align-items-center my-4\">\n        <h1>Products</h1>\n        <RoleRequired allowedRoles={['Admin', 'Manager']}>\n          <Button variant=\"primary\" onClick={handleShowCreateModal}>Create Product</Button>\n        </RoleRequired>\n      </div>\n      \n      <Table striped bordered hover responsive>\n        <thead>\n          <tr>\n            <th>SKU</th>\n            <th>Name</th>\n            <th>QR Code</th>\n            <th>Stock</th>\n            <RoleRequired allowedRoles={['Admin', 'Manager']}>\n                <th>Actions</th>\n            </RoleRequired>\n          </tr>\n        </thead>\n        <tbody>\n          {products.map((product) => (\n            <tr key={product.id}>\n              <td>{product.sku}</td>\n              <td>{product.name}</td>\n              <td>\n                <AuthenticatedImage \n                  fetchImage={() => getQRCode(product.sku)}\n                  alt={`QR Code for ${product.sku}`}\n                  style={{ height: '50px', width: '50px' }}\n                />\n              </td>\n              <td>{product.stock_quantity}</td>\n              <RoleRequired allowedRoles={['Admin', 'Manager']}>\n                <td>\n                    <ButtonGroup>\n                    <Button variant=\"outline-secondary\" size=\"sm\" onClick={() => handleShowEditModal(product)}>Edit</Button>\n                    <Button variant=\"outline-danger\" size=\"sm\" onClick={() => handleDelete(product.id)}>Delete</Button>\n                    </ButtonGroup>\n                </td>\n              </RoleRequired>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n      <ProductFormModal show={showModal} handleClose={handleCloseModal} product={selectedProduct} onSave={handleSave} />\n    </Container>\n  );\n}\n\nexport default ProductsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}